(self.webpackChunkgdevelop_ide=self.webpackChunkgdevelop_ide||[]).push([[712],{80530:function(e,r,t){var n=t(74149).findGDJS,o=t(50057),a=o("path"),i=o("fs");e.exports={findJsExtensionModules:function(e){var r=e.filterExamples,t=e.onFindGDJS;return(t?t():n()).then((function(e){var t=e.gdjsRoot,n=a.join(t,"Runtime","Extensions");return console.info("Searching for JS extensions (file called JsExtension.js) in ".concat(n,"...")),new Promise((function(e,t){i.readdir(n,(function(o,u){if(o)return t(o);var s=u.filter((function(e){return!r||-1===e.indexOf("Example")}));Promise.all(s.map((function(e){return r=a.join(n,e),new Promise((function(e){var t=a.join(r,"JsExtension.js");i.stat(t,(function(r,n){return e(r?null:n.isFile()?t:null)}))}));var r}))).then((function(r){e(r.filter((function(e){return!!e})))}),t)}))}))}))}}},50790:function(e,r,t){var n=t(23570).loadExtension,o=t(50057),a=t(80530).findJsExtensionModules;e.exports=function(e){var r=e.gd,t=e.objectsEditorService,i=e.objectsRenderingService,u=e.filterExamples,s=e.onFindGDJS;return{loadAllExtensions:function(e){return a({filterExamples:u,onFindGDJS:s}).then((function(a){return Promise.all(a.map((function(a){var u=null;try{u=o(a,{rethrowException:!0})}catch(s){return{extensionModulePath:a,result:{message:"Unable to import extension. Please check for any syntax error or error that would prevent it from being run.",error:!0,rawError:s}}}return u?(t&&u.registerEditorConfigurations&&u.registerEditorConfigurations(t),i&&u.registerInstanceRenderers&&u.registerInstanceRenderers(i),{extensionModulePath:a,result:n(e,r,r.JsPlatform.get(),u)}):{extensionModulePath:a,result:{error:!0,message:"Unknown error. Please check for any syntax error or error that would prevent it from being run."}}})))}),(function(e){throw console.error("Unable to find JS extensions modules"),e}))}}}},38099:function(e,r,t){"use strict";t.r(r),t.d(r,{create:function(){return Rn}});var n=t(1413),o=t(28381),a=t(88505),i=t(2066),u=t(9972),s=(t(94492),t(27881),t(37762)),c=t(15861),l=t(93433),p=t(64687),f=t.n(p),d=t(36600),h=t(17037),v=t(33258),m=t(57974),g=t(50057),x=t.n(g),w=t(29439),b=t(79431),y=x()("fs"),P=x()("path");function j(e,r){return k.apply(this,arguments)}function k(){return(k=(0,c.Z)(f().mark((function e(r,t){var n,o,a,i,u,c,l,p,d,h;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y&&P){e.next=2;break}return e.abrupt("return");case 2:n=P.dirname(r.getProjectFile()),o=[],a=(0,s.Z)(t.values()),e.prev=5,a.s();case 7:if((i=a.n()).done){e.next=31;break}if(u=i.value,c=u.hasAnyEmbeddedResourceOutsideProjectFolder,l=u.embeddedResources,c){e.next=11;break}return e.abrupt("continue",29);case 11:p=(0,s.Z)(l.values()),e.prev=12,h=function(){var e=d.value;if(!e.isOutsideProjectFolder)return"continue";var r=P.basename(e.fullPath),t=P.extname(r),a=P.basename(r,t),i=(0,b.Z)(a,(function(e){var r=P.join(n,e)+t;return y.existsSync(r)})),u=P.join(n,i+t);e.resourceName=i+t,o.push(y.promises.copyFile(e.fullPath,u))},p.s();case 15:if((d=p.n()).done){e.next=21;break}if("continue"!==h()){e.next=19;break}return e.abrupt("continue",19);case 19:e.next=15;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(12),p.e(e.t0);case 26:return e.prev=26,p.f(),e.finish(26);case 29:e.next=7;break;case 31:e.next=36;break;case 33:e.prev=33,e.t1=e.catch(5),a.e(e.t1);case 36:return e.prev=36,a.f(),e.finish(36);case 39:return e.abrupt("return",Promise.all(o));case 40:case"end":return e.stop()}}),e,null,[[5,33,36,39],[12,23,26,29]])})))).apply(this,arguments)}function S(e,r){var t,n=P.dirname(e.getProjectFile()),o=new Map,a=(0,s.Z)(r);try{for(a.s();!(t=a.n()).done;){var i,u=(0,w.Z)(t.value,2),c=u[0],l=u[1].embeddedResources,p={},f=(0,s.Z)(l.values());try{for(f.s();!(i=f.n()).done;){var d=i.value,v=d.resourceKind,m=d.resourceName,g=d.relPath,x=d.fullPath;m||(m=P.relative(n,x));var b=(0,h.h)(v);b&&(b.setName(m),b.setFile(m),p[g]=m,e.getResourcesManager().addResource(b))}}catch(y){f.e(y)}finally{f.f()}o.set(c,{mapping:p})}}catch(y){a.e(y)}finally{a.f()}return o}function E(e,r){return F.apply(this,arguments)}function F(){return(F=(0,c.Z)(f().mark((function e(r,t){var n,o,a,i,u,c,l,p,d,h,v,g,x,w,b,j,k,S,E;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y&&P){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,y.promises.readFile(t,"utf8");case 4:if(n=e.sent,e.prev=5,!(o=JSON.parse(n))||!o.__header__||"LDtk"!==o.__header__.app){e.next=16;break}a=P.dirname(t),i=new Map,u=!1,c=(0,s.Z)(o.defs.tilesets);try{for(c.s();!(l=c.n()).done;)(p=l.value).relPath&&(d=p.relPath,h=P.resolve(a,d),v=!(0,m.Te)(r,h),g={resourceKind:"image",relPath:d,fullPath:h,isOutsideProjectFolder:v},i.set(d,g),v&&(u=!0))}catch(f){c.e(f)}finally{c.f()}x=(0,s.Z)(o.levels);try{for(x.s();!(w=x.n()).done;)(b=w.value).bgRelPath&&(j=b.bgRelPath,k=P.resolve(a,j),S=!(0,m.Te)(r,k),E={resourceKind:"image",relPath:j,fullPath:k,isOutsideProjectFolder:S},i.set(b.bgRelPath,E),S&&(u=!0))}catch(f){x.e(f)}finally{x.f()}return e.abrupt("return",{hasAnyEmbeddedResourceOutsideProjectFolder:u,embeddedResources:i});case 16:e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(5),console.error("Unable to read properly the data from file ".concat(t," for use as a tilemap - ignoring any potentially embedded resources.")),e.abrupt("return",null);case 22:case"end":return e.stop()}}),e,null,[[5,18]])})))).apply(this,arguments)}var D={tilemap:E,json:E},C=t(40243),Z=t(32484),O=t(15684),R=t(29343),N=x()("@electron/remote"),A=N?N.dialog:null,T=x()("path"),L=function(e){var r=e.options,t=e.onChooseResources,n=e.createNewResource;return(0,R.jsx)(v.L,{onChoose:function(e){var r=e.url,o=n();o.setFile(r),o.setName(T.basename(r)),o.setOrigin("gdevelop-asset-store",r),t([o])},resourceKind:r.resourceKind})},M=[].concat((0,l.Z)(h.Q.map((function(e){var r=e.kind,t=(e.displayName,e.fileExtensions),n=e.createNewResource,o=function(){var e=(0,c.Z)(f().mark((function e(o){var a,u,c,l,p,d,h,v,g,x,w,b,y,P,k,E,F,C,Z,O,R;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=o.i18n,u=o.getLastUsedPath,c=o.setLastUsedPath,l=o.project,p=o.options,A){e.next=3;break}throw new Error("Electron dialog not supported in this environment.");case 3:return d=["openFile"],p.multiSelection&&d.push("multiSelections"),h=T.dirname(l.getProjectFile()),v=u(l,r)||h,g=N.getCurrentWindow(),e.next=10,A.showOpenDialog(g,{title:a._({id:"Choose a file"}),properties:d,filters:[{name:a._({id:"Supported files"}),extensions:t}],defaultPath:v});case 10:if(x=e.sent,(w=x.filePaths)&&w.length){e.next=14;break}return e.abrupt("return",[]);case 14:if(b=T.parse(w[0]).dir,c(l,r,b),y=w.some((function(e){return!(0,m.Te)(l,e)})),P=new Map,!(k=D[r])){e.next=39;break}E=(0,s.Z)(w),e.prev=21,E.s();case 23:if((F=E.n()).done){e.next=31;break}return C=F.value,e.next=27,k(l,C);case 27:(Z=e.sent)&&(P.set(C,Z),Z.hasAnyEmbeddedResourceOutsideProjectFolder&&(y=!0));case 29:e.next=23;break;case 31:e.next=36;break;case 33:e.prev=33,e.t0=e.catch(21),E.e(e.t0);case 36:return e.prev=36,E.f(),e.finish(36);case 39:if(O=new Map,R=new Map,!y){e.next=49;break}if(!i.ZP.showConfirmDialog(a._({id:"This/these file(s) are outside the project folder. Would you like to make a copy of them in your project folder first (recommended)?"}))){e.next=49;break}return e.next=46,(0,m.ZC)(l,w,O);case 46:return w=e.sent,e.next=49,j(l,P);case 49:return R=S(l,P),e.abrupt("return",w.map((function(e){var r=n();r.setFile(T.relative(h,e)),r.setName(T.relative(h,e));var t=O.has(e)?O.get(e):e;if(t){var o=R.get(t);o&&o.mapping&&r.setMetadata(JSON.stringify({embeddedResourcesMapping:o.mapping}))}return r})));case 51:case"end":return e.stop()}}),e,null,[[21,33,36,39]])})));return function(r){return e.apply(this,arguments)}}();return{name:"local-file-opener-"+r,displayName:{id:"Choose a file"},displayTab:"import",onlyForStorageProvider:"LocalFile",kind:r,selectResourcesHeadless:o,renderComponent:function(e){return(0,R.jsx)(C.x1,{justifyContent:"center",children:(0,R.jsx)(Z.Z,{primary:!0,label:e.options.multiSelection?(0,R.jsx)(d.Trans,{id:"Choose one or more files"}):(0,R.jsx)(d.Trans,{id:"Choose a file"}),onClick:(0,c.Z)(f().mark((function r(){var t;return f().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o({i18n:e.i18n,project:e.project,fileMetadata:e.fileMetadata,getStorageProvider:e.getStorageProvider,getLastUsedPath:e.getLastUsedPath,setLastUsedPath:e.setLastUsedPath,options:e.options});case 2:t=r.sent,e.onChooseResources(t);case 4:case"end":return r.stop()}}),r)})))})})}}}))),(0,l.Z)(h.Q.map((function(e){var r=e.kind,t=e.createNewResource;return{name:"upload-".concat(r),displayName:{id:"File(s) from your device"},displayTab:"import",onlyForStorageProvider:"Cloud",kind:r,renderComponent:function(e){return(0,R.jsx)(O.V,{createNewResource:t,onChooseResources:e.onChooseResources,options:e.options,fileMetadata:e.fileMetadata,getStorageProvider:e.getStorageProvider,automaticallyOpenInput:!!e.automaticallyOpenIfPossible},"url-chooser-".concat(r))}}}))),(0,l.Z)(h.Q.map((function(e){var r=e.kind,t=e.createNewResource;return{name:"resource-store-".concat(r),displayName:{id:"Choose from asset store"},displayTab:"standalone",kind:r,renderComponent:function(e){return(0,R.jsx)(L,{createNewResource:t,onChooseResources:e.onChooseResources,options:e.options},"resource-store-".concat(r))}}})))),U=M,I=t(4942),G=t(32705),B=t(67724),J=t(81303),_=x()("path"),W=x()("fs"),z=x()("electron"),H=z?z.ipcRenderer:null,K=function(){var e=(0,c.Z)(f().mark((function e(r,t){var n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(H){e.next=2;break}throw new Error("Not supported.");case 2:return e.next=4,H.invoke("".concat(r,"-load"),t);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),V=function(){var e=(0,c.Z)(f().mark((function e(r){var t,n,o,a,i,u,s,l;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.project,n=r.resourceNames,o=_.dirname(t.getProjectFile()),a=[],i=[],u=t.getResourcesManager(),n.forEach((function(e){if(u.hasResource(e)){var r=u.getResource(e).getFile();(0,m.PX)(r)?(0,m.Gu)(r)?console.error("Unsupported blob URL for a resource - ignoring it."):a.push({url:r,resourceName:e}):i.push({localFilePath:r,resourceName:e})}})),e.next=8,(0,J.R7)({urlContainers:a,onProgress:function(e,r){}});case 8:return s=e.sent,l=new Map,e.next=12,Promise.all(s.map(function(){var e=(0,c.Z)(f().mark((function e(r){var t,n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.error,t=r.blob,n=r.item,!t){e.next=15;break}return e.prev=2,e.t0=l,e.t1=n.resourceName,e.next=7,(0,J.oT)(t);case 7:e.t2=e.sent,e.t3={dataUrl:e.t2},e.t0.set.call(e.t0,e.t1,e.t3),e.next=15;break;case 12:e.prev=12,e.t4=e.catch(2),console.error('Unable to read data from resource "'.concat(n.resourceName,'" - ignoring it.'),e.t4);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(r){return e.apply(this,arguments)}}()));case 12:return e.next=14,Promise.all(i.map(function(){var e=(0,c.Z)(f().mark((function e(r){var t,n,a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.localFilePath,n=r.resourceName,e.prev=1,e.next=4,W.promises.readFile(_.resolve(o,t));case 4:a=e.sent,l.set(n,{localFilePath:t,dataUrl:"data:text/plain;base64,"+a.toString("base64")}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error('Unable to read local file "'.concat(t,'" - ignoring it.'),e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(r){return e.apply(this,arguments)}}()));case 14:return e.abrupt("return",n.map((function(e){var r=l.get(e);if(!r)return{name:e,dataUrl:""};var t=r.localFilePath;return{name:e,dataUrl:r.dataUrl,localFilePath:t}})));case 15:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),X=function(){var e=(0,c.Z)(f().mark((function e(r){var t,n,o,a,i,u,s,c,l,p,d,h;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.externalEditorName,n=r.defaultName,o=r.metadataKey,a=r.resourceKind,i=r.options,u=i.project,s=i.resourceNames,c=i.resourceManagementProps,e.next=4,V({project:u,resourceNames:s});case 4:return l=e.sent,p={singleFrame:i.extraOptions.singleFrame,externalEditorData:(0,G.Z2)(o,i.extraOptions.existingMetadata),fps:i.extraOptions.fps,isLooping:i.extraOptions.isLooping,name:i.extraOptions.name||s[0]||n,resources:l},(0,B.sY)(t),e.next=9,K(t,p);case 9:if(d=e.sent){e.next=12;break}return e.abrupt("return",null);case 12:return e.next=14,(0,G.Zv)({baseNameForNewResources:d.baseNameForNewResources,project:u,resources:d.resources,resourceKind:a});case 14:return h=e.sent,e.prev=15,e.next=18,c.onFetchNewlyAddedResources();case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(15),console.error("An error happened while fetching the newly added resources:",e.t0);case 23:return(0,G.$N)({modifiedResources:h,metadataKey:o,metadata:i.extraOptions.singleFrame?d.externalEditorData:null}),(0,G.TD)(h.map((function(e){return e.resource.getName()})),d.externalEditorData),e.abrupt("return",{resources:h.map((function(e){var r=e.resource,t=e.originalIndex;return{name:r.getName(),originalIndex:t}})),newName:d.baseNameForNewResources,newMetadata:(0,I.Z)({},o,d.externalEditorData)});case 26:case"end":return e.stop()}}),e,null,[[15,20]])})));return function(r){return e.apply(this,arguments)}}(),Q=[{name:"piskel-app",createDisplayName:{id:"Create with Piskel"},editDisplayName:{id:"Edit with Piskel"},kind:"image",edit:function(){var e=(0,c.Z)(f().mark((function e(r){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X({options:r,externalEditorName:"piskel",defaultName:"New image",metadataKey:"pskl",resourceKind:"image"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},{name:"Jfxr",createDisplayName:{id:"Create with Jfxr"},editDisplayName:{id:"Edit with Jfxr"},kind:"audio",edit:function(){var e=(0,c.Z)(f().mark((function e(r){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X({options:r,externalEditorName:"jfxr",defaultName:"New sound effect",metadataKey:"jfxr",resourceKind:"audio"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},{name:"Yarn",createDisplayName:{id:"Create with Yarn"},editDisplayName:{id:"Edit with Yarn"},kind:"json",edit:function(){var e=(0,c.Z)(f().mark((function e(r){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X({options:r,externalEditorName:"yarn",defaultName:"New dialogue tree",metadataKey:"yarn",resourceKind:"json"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()}],Y=Q,q=t(15671),$=t(43144),ee=t(60136),re=t(29388),te=x()("os"),ne=function(){try{return te.userInfo().uid}catch(e){return""}},oe=x()("fs-extra"),ae=x()("path"),ie=x()("os"),ue=t.g.gd,se=ae.posix||ae,ce=(0,$.Z)((function e(r){var t=this;(0,q.Z)(this,e),this._filesToDownload={},this.getAllUrlFilesIn=function(e){var r=se.normalize(e).replace(/\\/g,"/");return Object.keys(t._filesToDownload).filter((function(e){return 0===e.indexOf(r)})).map((function(e){return{filePath:e,url:t._filesToDownload[e]}}))},this.mkDir=function(e){if(!(0,m.PX)(e)){try{oe.mkdirsSync(e)}catch(r){return console.error("mkDir("+e+") failed: "+r),!1}return!0}},this.dirExists=function(e){return!!(0,m.PX)(e)||oe.existsSync(e)},this.clearDir=function(e){try{oe.emptyDirSync(e)}catch(r){console.error("clearDir("+e+") failed: "+r)}},this.getTempDir=function(){return ae.join(ie.tmpdir(),"GDTMP-".concat(ne()))},this.fileNameFrom=function(e){return!t._downloadUrlsToLocalFiles&&(0,m.PX)(e)?e:ae.basename(e)},this.dirNameFrom=function(e){return ae.dirname(e).replace(/\\/g,"/")},this.makeAbsolute=function(e,r){return(0,m.PX)(e)?e:(t.isAbsolute(r)||(r=ae.resolve(r)),ae.resolve(r,ae.normalize(e)).replace(/\\/g,"/"))},this.makeRelative=function(e,r){return(0,m.PX)(e)?e:ae.relative(r,ae.normalize(e)).replace(/\\/g,"/")},this.isAbsolute=function(e){return!!(0,m.PX)(e)||(0===e.length||(e.length>0&&"/"===e.charAt(0)||e.length>1&&":"===e.charAt(1)))},this.copyFile=function(e,r){if((0,m.PX)(e))return!t._downloadUrlsToLocalFiles||((0,m.PX)(r)?(console.error("Destination can't be a URL in copyFile (from ".concat(e," to ").concat(r,").")),!1):(t._filesToDownload[se.normalize(r)]=e,!0));try{e!==r&&oe.copySync(e,r)}catch(n){return console.error("copyFile("+e+", "+r+") failed: "+n),!1}return!0},this.writeToFile=function(e,r){try{oe.outputFileSync(e,r)}catch(t){return console.error("writeToFile("+e+", ...) failed: "+t),!1}return!0},this.readFile=function(e){try{return oe.readFileSync(e).toString()}catch(r){return console.error("readFile("+e+") failed: "+r),""}},this.readDir=function(e,r){r=r.toUpperCase();var t=new ue.VectorString;try{oe.existsSync(e)&&oe.readdirSync(e).forEach((function(n){0!==r.length&&-1===n.toUpperCase().indexOf(r,n.length-r.length)||t.push_back(e+"/"+n)}))}catch(n){console.error("readDir("+e+","+r+") failed: "+n)}return t},this.fileExists=function(e){var r=se.normalize(e);if(!!t._filesToDownload[r])return!0;try{return oe.statSync(e).isFile()}catch(n){return!1}},this._downloadUrlsToLocalFiles=!!r&&r.downloadUrlsToLocalFiles})),le=ce,pe=t(74149),fe=t(1773),de=t(67835),he=t(86278),ve=t(78081),me=t(75087),ge=null,xe=(0,$.Z)((function e(){(0,q.Z)(this,e)}));xe.render=function(e,r){ge(e,r)},self.QrCreator=xe,function(e){function r(r,t,n,o){var a={},i=e(n,t);i.u(r),i.J(),o=o||0;var u=i.h(),s=i.h()+2*o;return a.text=r,a.level=t,a.version=n,a.O=s,a.a=function(e,r){return r-=o,!(0>(e-=o)||e>=u||0>r||r>=u)&&i.a(e,r)},a}function t(e,r,t,n,o,a,i,u,s,c){function l(r,t,n,o,i,u,s){r?(e.lineTo(t+u,n+s),e.arcTo(t,n,o,i,a)):e.lineTo(t,n)}i?e.moveTo(r+a,t):e.moveTo(r,t),l(u,n,t,n,o,-a,0),l(s,n,o,r,o,0,-a),l(c,r,o,r,t,a,0),l(i,r,t,n,t,0,a)}function n(e,r,t,n,o,a,i,u,s,c){function l(r,t,n,o){e.moveTo(r+n,t),e.lineTo(r,t),e.lineTo(r,t+o),e.arcTo(r,t,r+n,t,a)}i&&l(r,t,a,a),u&&l(n,t,-a,a),s&&l(n,o,-a,-a),c&&l(r,o,a,-a)}function o(e,o){e:{var a=o.text,i=o.v,u=o.N,s=o.K,c=o.P;for(u=Math.max(1,u||1),s=Math.min(40,s||40);u<=s;u+=1)try{var l=r(a,i,u,c);break e}catch(C){}l=void 0}if(!l)return null;for(a=e.getContext("2d"),o.background&&(a.fillStyle=o.background,a.fillRect(o.left,o.top,o.size,o.size)),i=l.O,s=o.size/i,a.beginPath(),c=0;c<i;c+=1)for(u=0;u<i;u+=1){var p=a,f=o.left+u*s,d=o.top+c*s,h=c,v=u,m=l.a,g=f+s,x=d+s,b=h-1,y=h+1,P=v-1,j=v+1,k=Math.floor(Math.min(.5,Math.max(0,o.R))*s),S=m(h,v),E=m(b,P),F=m(b,v);b=m(b,j);var D=m(h,j);j=m(y,j),v=m(y,v),y=m(y,P),h=m(h,P),f=Math.round(f),d=Math.round(d),g=Math.round(g),x=Math.round(x),S?t(p,f,d,g,x,k,!F&&!h,!F&&!D,!v&&!D,!v&&!h):n(p,f,d,g,x,k,F&&h&&E,F&&D&&b,v&&D&&j,v&&h&&y)}return function(e,r){var t=r.fill;if("string"===typeof t)e.fillStyle=t;else{var n=t.type,o=t.colorStops;if(t=t.position.map((function(e){return Math.round(e*r.size)})),"linear-gradient"===n)var a=e.createLinearGradient.apply(e,t);else{if("radial-gradient"!==n)throw Error("Unsupported fill");a=e.createRadialGradient.apply(e,t)}o.forEach((function(e){var r=(0,w.Z)(e,2),t=r[0],n=r[1];a.addColorStop(t,n)})),e.fillStyle=a}}(a,o),a.fill(),e}var a={minVersion:1,maxVersion:40,ecLevel:"L",left:0,top:0,size:200,fill:"#000",background:null,text:"no text",radius:.5,quiet:0};ge=function(e,r){var t={};Object.assign(t,a,e),t.N=t.minVersion,t.K=t.maxVersion,t.v=t.ecLevel,t.left=t.left,t.top=t.top,t.size=t.size,t.fill=t.fill,t.background=t.background,t.text=t.text,t.R=t.radius,t.P=t.quiet,r instanceof HTMLCanvasElement?(r.width===t.size&&r.height===t.size||(r.width=t.size,r.height=t.size),r.getContext("2d").clearRect(0,0,r.width,r.height),o(r,t)):((e=document.createElement("canvas")).width=t.size,e.height=t.size,t=o(e,t),r.appendChild(t))}}(function(){function e(o,i){function u(e,r){for(var t=-1;7>=t;t+=1)if(!(-1>=e+t||p<=e+t))for(var n=-1;7>=n;n+=1)-1>=r+n||p<=r+n||(l[e+t][r+n]=0<=t&&6>=t&&(0==n||6==n)||0<=n&&6>=n&&(0==t||6==t)||2<=t&&4>=t&&2<=n&&4>=n)}function s(e,t){for(var i=p=4*o+17,s=Array(i),h=0;h<i;h+=1){s[h]=Array(i);for(var v=0;v<i;v+=1)s[h][v]=null}for(l=s,u(0,0),u(p-7,0),u(0,p-7),i=n.G(o),s=0;s<i.length;s+=1)for(h=0;h<i.length;h+=1){v=i[s];var m=i[h];if(null==l[v][m])for(var g=-2;2>=g;g+=1)for(var x=-2;2>=x;x+=1)l[v+g][m+x]=-2==g||2==g||-2==x||2==x||0==g&&0==x}for(i=8;i<p-8;i+=1)null==l[i][6]&&(l[i][6]=0==i%2);for(i=8;i<p-8;i+=1)null==l[6][i]&&(l[6][i]=0==i%2);for(i=n.w(c<<3|t),s=0;15>s;s+=1)h=!e&&1==(i>>s&1),l[6>s?s:8>s?s+1:p-15+s][8]=h,l[8][8>s?p-s-1:9>s?15-s:14-s]=h;if(l[p-8][8]=!e,7<=o){for(i=n.A(o),s=0;18>s;s+=1)h=!e&&1==(i>>s&1),l[Math.floor(s/3)][s%3+p-8-3]=h;for(s=0;18>s;s+=1)h=!e&&1==(i>>s&1),l[s%3+p-8-3][Math.floor(s/3)]=h}if(null==f){for(e=a.I(o,c),i=function(){var e=[],r=0,t={B:function(){return e},c:function(r){return 1==(e[Math.floor(r/8)]>>>7-r%8&1)},put:function(e,r){for(var n=0;n<r;n+=1)t.m(1==(e>>>r-n-1&1))},f:function(){return r},m:function(t){var n=Math.floor(r/8);e.length<=n&&e.push(0),t&&(e[n]|=128>>>r%8),r+=1}};return t}(),s=0;s<d.length;s+=1)h=d[s],i.put(4,4),i.put(h.b(),n.f(4,o)),h.write(i);for(s=h=0;s<e.length;s+=1)h+=e[s].j;if(i.f()>8*h)throw Error("code length overflow. ("+i.f()+">"+8*h+")");for(i.f()+4<=8*h&&i.put(0,4);0!=i.f()%8;)i.m(!1);for(;!(i.f()>=8*h)&&(i.put(236,8),!(i.f()>=8*h));)i.put(17,8);var w=0;for(h=s=0,v=Array(e.length),m=Array(e.length),g=0;g<e.length;g+=1){var b=e[g].j,y=e[g].o-b;for(s=Math.max(s,b),h=Math.max(h,y),v[g]=Array(b),x=0;x<v[g].length;x+=1)v[g][x]=255&i.B()[x+w];for(w+=b,x=n.C(y),b=r(v[g],x.b()-1).l(x),m[g]=Array(x.b()-1),x=0;x<m[g].length;x+=1)y=x+b.b()-m[g].length,m[g][x]=0<=y?b.c(y):0}for(x=i=0;x<e.length;x+=1)i+=e[x].o;for(i=Array(i),x=w=0;x<s;x+=1)for(g=0;g<e.length;g+=1)x<v[g].length&&(i[w]=v[g][x],w+=1);for(x=0;x<h;x+=1)for(g=0;g<e.length;g+=1)x<m[g].length&&(i[w]=m[g][x],w+=1);f=i}for(e=f,i=-1,s=p-1,h=7,v=0,t=n.F(t),m=p-1;0<m;m-=2)for(6==m&&--m;;){for(g=0;2>g;g+=1)null==l[s][m-g]&&(x=!1,v<e.length&&(x=1==(e[v]>>>h&1)),t(s,m-g)&&(x=!x),l[s][m-g]=x,-1==--h&&(v+=1,h=7));if(0>(s+=i)||p<=s){s-=i,i=-i;break}}}var c=t[i],l=null,p=0,f=null,d=[],h={u:function(r){r=function(r){var t=e.s(r);return{S:function(){return 4},b:function(){return t.length},write:function(e){for(var r=0;r<t.length;r+=1)e.put(t[r],8)}}}(r),d.push(r),f=null},a:function(e,r){if(0>e||p<=e||0>r||p<=r)throw Error(e+","+r);return l[e][r]},h:function(){return p},J:function(){for(var e=0,r=0,t=0;8>t;t+=1){s(!0,t);var o=n.D(h);(0==t||e>o)&&(e=o,r=t)}s(!1,r)}};return h}function r(e,t){if("undefined"==typeof e.length)throw Error(e.length+"/"+t);var n=function(){for(var r=0;r<e.length&&0==e[r];)r+=1;for(var n=Array(e.length-r+t),o=0;o<e.length-r;o+=1)n[o]=e[o+r];return n}(),a={c:function(e){return n[e]},b:function(){return n.length},multiply:function(e){for(var t=Array(a.b()+e.b()-1),n=0;n<a.b();n+=1)for(var i=0;i<e.b();i+=1)t[n+i]^=o.i(o.g(a.c(n))+o.g(e.c(i)));return r(t,0)},l:function(e){if(0>a.b()-e.b())return a;for(var t=o.g(a.c(0))-o.g(e.c(0)),n=Array(a.b()),i=0;i<a.b();i+=1)n[i]=a.c(i);for(i=0;i<e.b();i+=1)n[i]^=o.i(o.g(e.c(i))+t);return r(n,0).l(e)}};return a}e.s=function(e){for(var r=[],t=0;t<e.length;t++){var n=e.charCodeAt(t);128>n?r.push(n):2048>n?r.push(192|n>>6,128|63&n):55296>n||57344<=n?r.push(224|n>>12,128|n>>6&63,128|63&n):(t++,n=65536+((1023&n)<<10|1023&e.charCodeAt(t)),r.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n))}return r};var t={L:1,M:0,Q:3,H:2},n=function(){function e(e){for(var r=0;0!=e;)r+=1,e>>>=1;return r}var t=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],n={w:function(r){for(var t=r<<10;0<=e(t)-e(1335);)t^=1335<<e(t)-e(1335);return 21522^(r<<10|t)},A:function(r){for(var t=r<<12;0<=e(t)-e(7973);)t^=7973<<e(t)-e(7973);return r<<12|t},G:function(e){return t[e-1]},F:function(e){switch(e){case 0:return function(e,r){return 0==(e+r)%2};case 1:return function(e){return 0==e%2};case 2:return function(e,r){return 0==r%3};case 3:return function(e,r){return 0==(e+r)%3};case 4:return function(e,r){return 0==(Math.floor(e/2)+Math.floor(r/3))%2};case 5:return function(e,r){return 0==e*r%2+e*r%3};case 6:return function(e,r){return 0==(e*r%2+e*r%3)%2};case 7:return function(e,r){return 0==(e*r%3+(e+r)%2)%2};default:throw Error("bad maskPattern:"+e)}},C:function(e){for(var t=r([1],0),n=0;n<e;n+=1)t=t.multiply(r([1,o.i(n)],0));return t},f:function(e,r){if(4!=e||1>r||40<r)throw Error("mode: "+e+"; type: "+r);return 10>r?8:16},D:function(e){for(var r=e.h(),t=0,n=0;n<r;n+=1)for(var o=0;o<r;o+=1){for(var a=0,i=e.a(n,o),u=-1;1>=u;u+=1)if(!(0>n+u||r<=n+u))for(var s=-1;1>=s;s+=1)0>o+s||r<=o+s||(0!=u||0!=s)&&i==e.a(n+u,o+s)&&(a+=1);5<a&&(t+=3+a-5)}for(n=0;n<r-1;n+=1)for(o=0;o<r-1;o+=1)a=0,e.a(n,o)&&(a+=1),e.a(n+1,o)&&(a+=1),e.a(n,o+1)&&(a+=1),e.a(n+1,o+1)&&(a+=1),(0==a||4==a)&&(t+=3);for(n=0;n<r;n+=1)for(o=0;o<r-6;o+=1)e.a(n,o)&&!e.a(n,o+1)&&e.a(n,o+2)&&e.a(n,o+3)&&e.a(n,o+4)&&!e.a(n,o+5)&&e.a(n,o+6)&&(t+=40);for(o=0;o<r;o+=1)for(n=0;n<r-6;n+=1)e.a(n,o)&&!e.a(n+1,o)&&e.a(n+2,o)&&e.a(n+3,o)&&e.a(n+4,o)&&!e.a(n+5,o)&&e.a(n+6,o)&&(t+=40);for(o=a=0;o<r;o+=1)for(n=0;n<r;n+=1)e.a(n,o)&&(a+=1);return t+Math.abs(100*a/r/r-50)/5*10}};return n}(),o=function(){for(var e=Array(256),r=Array(256),t=0;8>t;t+=1)e[t]=1<<t;for(t=8;256>t;t+=1)e[t]=e[t-4]^e[t-5]^e[t-6]^e[t-8];for(t=0;255>t;t+=1)r[e[t]]=t;return{g:function(e){if(1>e)throw Error("glog("+e+")");return r[e]},i:function(r){for(;0>r;)r+=255;for(;256<=r;)r-=255;return e[r]}}}(),a=function(){function e(e,n){switch(n){case t.L:return r[4*(e-1)];case t.M:return r[4*(e-1)+1];case t.Q:return r[4*(e-1)+2];case t.H:return r[4*(e-1)+3]}}var r=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],n={I:function(r,t){var n=e(r,t);if("undefined"==typeof n)throw Error("bad rs block @ typeNumber:"+r+"/errorCorrectLevel:"+t);r=n.length/3,t=[];for(var o=0;o<r;o+=1)for(var a=n[3*o],i=n[3*o+1],u=n[3*o+2],s=0;s<a;s+=1){var c=u,l={};l.o=i,l.j=c,t.push(l)}return t}};return n}();return e}());var we=QrCreator,be=t(24910),ye=function(e){var r=e.url,t=e.size,n=void 0===t?128:t,a=o.useContext(be.Z),i=o.useRef(null);return o.useEffect((function(){var e=i.current;if(e)return we.render({text:r,radius:0,ecLevel:"L",fill:a.palette.secondary,background:null,size:n},e),function(){e.firstChild&&e.removeChild(e.firstChild)}}),[r,n,a]),(0,R.jsx)("div",{ref:i})},Pe=function(e){var r=e.url,t=e.open,n=e.error,o=e.onExport,a=e.onClose,i=e.onRunPreviewLocally;if(!t)return null;var u=r?"http://".concat(r):"";return(0,R.jsxs)(fe.ZP,{title:(0,R.jsx)(d.Trans,{id:"Preview"}),actions:[(0,R.jsx)(de.Z,{label:(0,R.jsx)(d.Trans,{id:"Close"}),primary:!0,onClick:a},"close")],secondaryActions:[o&&(0,R.jsx)(de.Z,{label:(0,R.jsx)(d.Trans,{id:"Export game"}),onClick:o},"export"),(0,R.jsx)(de.Z,{label:(0,R.jsx)(d.Trans,{id:"Run on this computer"}),onClick:i},"run-preview-locally")],open:t,onRequestClose:a,maxWidth:"sm",children:[n&&(0,R.jsx)(C.x1,{children:(0,R.jsx)(he.Z,{children:(0,R.jsx)(d.Trans,{id:"Unable to start the server for the preview! Make sure that you are authorized to run servers on this computer. Otherwise, use classic preview to test your game."})})}),!n&&!r&&(0,R.jsx)(ve.Z,{}),!n&&r&&(0,R.jsxs)("div",{children:[(0,R.jsx)(C.x1,{children:(0,R.jsx)(he.Z,{children:(0,R.jsx)(d.Trans,{id:"Your preview is ready! On your mobile or tablet, open your browser and enter in the address bar:"})})}),(0,R.jsx)(me.Z,{url:r}),u&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(C.x1,{children:(0,R.jsx)(he.Z,{children:(0,R.jsx)(d.Trans,{id:"Or flash this QR code:"})})}),(0,R.jsx)(C.x1,{justifyContent:"center",children:(0,R.jsx)(ye,{url:u,size:100})})]}),(0,R.jsx)(C.x1,{children:(0,R.jsx)(he.Z,{children:(0,R.jsx)(d.Trans,{id:"Please note that your device should be connected on the same network as this computer."})})})]})]})},je=t(25842),ke=t.n(je),Se=t(79987),Ee=x()("electron"),Fe=Ee?Ee.ipcRenderer:null,De="stopped",Ce=null,Ze=[],Oe=[],Re={startServer:function(){if(!Fe)return Promise.reject();if("started"===De)return Promise.resolve();var e=new Promise((function(e,r){var t=!1;De="stopped",Ce=null,Fe&&(Fe.removeAllListeners("debugger-send-message-done"),Fe.removeAllListeners("debugger-error-received"),Fe.removeAllListeners("debugger-connection-closed"),Fe.removeAllListeners("debugger-connection-opened"),Fe.removeAllListeners("debugger-connection-errored"),Fe.removeAllListeners("debugger-start-server-done"),Fe.removeAllListeners("debugger-message-received")),Fe.on("debugger-error-received",(function(e,n){t||(r(n),t=!0),Ze.forEach((function(e){return(0,e.onErrorReceived)(n)}))})),Fe.on("debugger-connection-closed",(function(e,r){var t=r.id,n=Oe.indexOf(t);-1!==n&&Oe.splice(n,1),Ze.forEach((function(e){return(0,e.onConnectionClosed)({id:t,debuggerIds:Oe})}))})),Fe.on("debugger-connection-opened",(function(e,r){var t=r.id;Oe.push(t),Ze.forEach((function(e){return(0,e.onConnectionOpened)({id:t,debuggerIds:Oe})}))})),Fe.on("debugger-connection-errored",(function(e,r){var t=r.id,n=r.errorMessage;Ze.forEach((function(e){return(0,e.onConnectionErrored)({id:t,errorMessage:n})}))})),Fe.on("debugger-start-server-done",(function(r,n){var o=n.address;console.info("Local preview debugger started"),De="started",Ce=o,t||(e(),t=!0),Ze.forEach((function(e){return(0,e.onServerStateChanged)()}))})),Fe.on("debugger-message-received",(function(e,r){var t=r.id,n=r.message;console.info("Processing message received for debugger");try{var o=JSON.parse(n);Ze.forEach((function(e){return(0,e.onHandleParsedMessage)({id:t,parsedMessage:o})}))}catch(a){console.warn("Error while parsing message received from debugger client:",a)}})),Fe.send("debugger-start-server")})),r=new Promise((function(e,r){setTimeout((function(){r(new Error("Debugger server not started or errored after 5s - aborting."))}),5e3)}));return Promise.race([e,r])},sendMessage:function(e,r){Fe&&("stopped"!==De?Fe.send("debugger-send-message",{id:e,message:JSON.stringify(r)}):console.error("Cannot send message when debugger server is stopped."))},getServerState:function(){return De},getExistingDebuggerIds:function(){return Oe},registerCallbacks:function(e){return Ze.push(e),function(){var r=Ze.indexOf(e);-1!==r&&Ze.splice(r,1)}}},Ne=x()("electron"),Ae=x()("path"),Te=Ne?Ne.ipcRenderer:null,Le=t.g.gd,Me=function(e){(0,ee.Z)(t,e);var r=(0,re.Z)(t);function t(){var e;(0,q.Z)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=r.call.apply(r,[this].concat(o))).canDoNetworkPreview=function(){return!0},e.canDoHotReload=function(){return!0},e.state={networkPreviewDialogOpen:!1,networkPreviewHost:null,networkPreviewPort:null,networkPreviewError:null,previewGamePath:null,previewBrowserWindowOptions:null,hotReloadsCount:0,hideMenuBar:!0,alwaysOnTop:!0},e._networkPreviewSubscriptionChecker=null,e._hotReloadSubscriptionChecker=null,e._openPreviewBrowserWindow=function(){var r=e.state,t=r.previewGamePath,n=r.previewBrowserWindowOptions;n&&t&&Te&&Te.invoke("preview-open",{previewBrowserWindowOptions:n,previewGameIndexHtmlPath:"file://".concat(t,"/index.html"),alwaysOnTop:e.state.alwaysOnTop,hideMenuBar:e.state.hideMenuBar})},e.closePreview=function(e){Te&&Te.invoke("preview-close",{windowId:e})},e._openPreviewWindow=function(r,t,n){e.setState({previewBrowserWindowOptions:{width:r.getGameResolutionWidth(),height:r.getGameResolutionHeight(),useContentSize:!0,title:"Preview of ".concat(r.getName()),backgroundColor:"#000000",webPreferences:{webSecurity:!1,nodeIntegration:!0,contextIsolation:!1}},previewGamePath:t,hideMenuBar:!n.getIsMenuBarHiddenInPreview(),alwaysOnTop:n.getIsAlwaysOnTopInPreview()},(function(){if(n.networkPreview){if(!Te)return;Te.removeAllListeners("serve-folder-done"),Te.removeAllListeners("local-network-ips"),Te.on("serve-folder-done",(function(r,t,n){t?e.setState({networkPreviewDialogOpen:!0,networkPreviewPort:null,networkPreviewHost:null,networkPreviewError:t}):e.setState({networkPreviewDialogOpen:!0,networkPreviewPort:n.port}),setTimeout((function(){return e._checkSubscriptionForNetworkPreview()}))})),Te.on("local-network-ip",(function(r,t){e.setState({networkPreviewHost:t})})),Te.send("serve-folder",{root:t}),Te.send("get-local-network-ip")}else e._openPreviewBrowserWindow()}))},e._prepareExporter=function(){return(0,pe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new le({downloadUrlsToLocalFiles:!1}),n=ke()(new Le.AbstractFileSystemJS,t);return{outputDir:Ae.join(n.getTempDir(),"preview"),exporter:new Le.Exporter(n,r),gdjsRoot:r}}))},e.launchPreview=function(r){var t=r.project,n=r.layout,o=r.externalLayout;return e.getPreviewDebuggerServer().startServer().catch((function(e){console.error("Unable to start the Debugger Server for the preview:",e)})).then((function(){return e._prepareExporter()})).then((function(a){var u=a.outputDir,s=a.exporter,c=a.gdjsRoot;!function(e,r){var t=performance.now();e(),r(performance.now()-t)}((function(){var a=new Le.PreviewExportOptions(t,u);a.setIsDevelopmentEnvironment(i.ZP.isDev()),a.setLayoutName(n.getName()),o&&a.setExternalLayoutName(o.getName());var l=Ce;l&&a.useWebsocketDebuggerClientWithServerAddress(l.address,""+l.port);var p=e.props.getIncludeFileHashs();for(var f in p){var d=p[f];a.setIncludeFileHash(f,d)}a.setElectronRemoteRequirePath(Ae.join(c,"../preview_node_modules","@electron/remote","renderer/index.js"));var h=e.getPreviewDebuggerServer().getExistingDebuggerIds(),v=r.hotReload&&!!h.length;a.setProjectDataOnlyExport(v&&r.projectDataOnlyExport),a.setFullLoadingScreen(r.fullLoadingScreen),r.fallbackAuthor&&a.setFallbackAuthor(r.fallbackAuthor.id,r.fallbackAuthor.username),s.exportProjectForPixiPreview(a),a.delete(),s.delete(),v?(h.forEach((function(r){e.getPreviewDebuggerServer().sendMessage(r,{command:"hotReload"})})),e.state.hotReloadsCount%16===0&&e._hotReloadSubscriptionChecker&&e._hotReloadSubscriptionChecker.checkUserHasSubscription(),e.setState((function(e){return{hotReloadsCount:e.hotReloadsCount+1}}))):e._openPreviewWindow(t,u,r)}),(function(e){return console.info("Preview took ".concat(e,"ms"))}))}))},e._checkSubscriptionForNetworkPreview=function(){return!e._networkPreviewSubscriptionChecker||e._networkPreviewSubscriptionChecker.checkUserHasSubscription()},e}return(0,$.Z)(t,[{key:"getPreviewDebuggerServer",value:function(){return Re}},{key:"render",value:function(){var e=this,r=this.state,t=r.networkPreviewDialogOpen,n=r.networkPreviewHost,a=r.networkPreviewPort,i=r.networkPreviewError;return(0,R.jsxs)(o.Fragment,{children:[(0,R.jsx)(Se.Z,{ref:function(r){return e._networkPreviewSubscriptionChecker=r},onChangeSubscription:function(){return e.setState({networkPreviewDialogOpen:!1})},id:"Preview over wifi",title:(0,R.jsx)(d.Trans,{id:"Preview over wifi"}),mode:"try"}),(0,R.jsx)(Se.Z,{ref:function(r){return e._hotReloadSubscriptionChecker=r},id:"Hot reloading",title:(0,R.jsx)(d.Trans,{id:"Live preview (apply changes to the running preview)"}),mode:"try"}),(0,R.jsx)(Pe,{open:t,url:n&&a?"".concat(n,":").concat(a):null,error:i,onClose:function(){return e.setState({networkPreviewDialogOpen:!1})},onExport:this.props.onExport,onRunPreviewLocally:this._openPreviewBrowserWindow})]})}}]),t}(o.Component),Ue=t(73818),Ie=t(82232),Ge=t(19431),Be=x()("electron"),Je=Be?Be.shell:null,_e=t.g.gd,We={name:"local-cordova",packageNameWarningType:"mobile",getInitialExportState:function(e){return{outputDir:e.getLastCompilationDirectory()}},canLaunchBuild:function(e){return!!e.outputDir},isNavigationDisabled:function(){return!1},renderHeader:function(e){var r=e.project,t=e.exportState,n=e.updateExportState;return(0,R.jsxs)(C.sg,{noMargin:!0,children:[(0,R.jsx)(C.x1,{children:(0,R.jsx)(C.sg,{noMargin:!0,children:(0,R.jsx)(Ie.if,{})})}),(0,R.jsx)(C.x1,{children:(0,R.jsx)(Ue.Z,{type:"export",value:t.outputDir,defaultPath:r.getLastCompilationDirectory(),onChange:function(e){n((function(){return{outputDir:e}})),r.setLastCompilationDirectory(e)},fullWidth:!0})})]})},renderLaunchButtonLabel:function(){return(0,R.jsx)(d.Trans,{id:"Package"})},prepareExporter:function(e){return(0,pe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new le({downloadUrlsToLocalFiles:!0}),n=ke()(new _e.AbstractFileSystemJS,t);return{exporter:new _e.Exporter(n,r),localFileSystem:t}}))},launchExport:function(){var e=(0,c.Z)(f().mark((function e(r,t,n){var o,a,i;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,(i=new _e.ExportOptions(r.project,r.exportState.outputDir)).setTarget("cordova"),n&&i.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(i),i.delete(),o.delete(),e.abrupt("return",{urlFiles:a.getAllUrlFilesIn(r.exportState.outputDir)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,c.Z)(f().mark((function e(r,t){var n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.urlFiles,e.next=3,(0,Ge.t)({urlContainers:n,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",null);case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){return Promise.resolve(null)},renderDoneFooter:function(e){var r=e.exportState,t=(e.onClose,function(){Je&&Je.openPath(r.outputDir)});return(0,R.jsx)(Ie.Eg,{renderGameButton:function(){return(0,R.jsx)(Z.Z,{label:(0,R.jsx)(d.Trans,{id:"Open folder"}),primary:!0,onClick:t},"open")}})}},ze=t(31502),He=x()("electron"),Ke=He?He.shell:null,Ve=t.g.gd,Xe={name:"local-electron",packageNameWarningType:"desktop",getInitialExportState:function(e){return{outputDir:e.getLastCompilationDirectory()}},canLaunchBuild:function(e){return!!e.outputDir},isNavigationDisabled:function(){return!1},renderHeader:function(e){var r=e.project,t=e.exportState,n=e.updateExportState;return(0,R.jsxs)(C.sg,{noMargin:!0,children:[(0,R.jsx)(C.x1,{children:(0,R.jsx)(C.sg,{noMargin:!0,children:(0,R.jsx)(ze.if,{})})}),(0,R.jsx)(C.x1,{children:(0,R.jsx)(Ue.Z,{type:"export",value:t.outputDir,defaultPath:r.getLastCompilationDirectory(),onChange:function(e){n((function(){return{outputDir:e}})),r.setLastCompilationDirectory(e)},fullWidth:!0})})]})},renderLaunchButtonLabel:function(){return(0,R.jsx)(d.Trans,{id:"Package"})},prepareExporter:function(e){return(0,pe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new le({downloadUrlsToLocalFiles:!0}),n=ke()(new Ve.AbstractFileSystemJS,t);return{exporter:new Ve.Exporter(n,r),localFileSystem:t}}))},launchExport:function(){var e=(0,c.Z)(f().mark((function e(r,t,n){var o,a,i;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,(i=new Ve.ExportOptions(r.project,r.exportState.outputDir)).setTarget("electron"),n&&i.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(i),i.delete(),o.delete(),e.abrupt("return",{urlFiles:a.getAllUrlFilesIn(r.exportState.outputDir)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,c.Z)(f().mark((function e(r,t){var n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.urlFiles,e.next=3,(0,Ge.t)({urlContainers:n,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",null);case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){return Promise.resolve(null)},renderDoneFooter:function(e){var r=e.exportState,t=(e.onClose,function(){Ke&&Ke.openPath(r.outputDir)});return(0,R.jsx)(ze.Eg,{renderGameButton:function(){return(0,R.jsx)(Z.Z,{label:(0,R.jsx)(d.Trans,{id:"Open folder"}),primary:!0,onClick:t},"open")}})}},Qe=t(23624),Ye=x()("electron"),qe=Ye?Ye.shell:null,$e=t.g.gd,er={name:"local-html5",getInitialExportState:function(e){return{outputDir:e.getLastCompilationDirectory()}},canLaunchBuild:function(e){return!!e.outputDir},isNavigationDisabled:function(){return!1},renderHeader:function(e){var r=e.project,t=e.exportState,n=e.updateExportState;return(0,R.jsxs)(C.sg,{noMargin:!0,children:[(0,R.jsx)(C.x1,{children:(0,R.jsx)(Qe.if,{})}),(0,R.jsx)(C.x1,{children:(0,R.jsx)(Ue.Z,{type:"export",value:t.outputDir,defaultPath:r.getLastCompilationDirectory(),onChange:function(e){n((function(){return{outputDir:e}})),r.setLastCompilationDirectory(e)},fullWidth:!0})})]})},renderLaunchButtonLabel:function(){return(0,R.jsx)(d.Trans,{id:"Export as a HTML5 game"})},prepareExporter:function(e){return(0,pe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new le({downloadUrlsToLocalFiles:!0}),n=ke()(new $e.AbstractFileSystemJS,t);return{exporter:new $e.Exporter(n,r),localFileSystem:t}}))},launchExport:function(){var e=(0,c.Z)(f().mark((function e(r,t,n){var o,a,i;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=new $e.ExportOptions(r.project,r.exportState.outputDir),n&&i.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(i),i.delete(),o.delete(),e.abrupt("return",{urlFiles:a.getAllUrlFilesIn(r.exportState.outputDir)});case 7:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,c.Z)(f().mark((function e(r,t){var n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.urlFiles,e.next=3,(0,Ge.t)({urlContainers:n,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",null);case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){return Promise.resolve(null)},renderDoneFooter:function(e){var r=e.exportState;e.onClose;return(0,R.jsx)(Qe.Eg,{renderGameButton:function(){return(0,R.jsx)(Z.Z,{fullWidth:!0,primary:!0,onClick:function(){qe&&qe.openPath(r.outputDir)},label:(0,R.jsx)(d.Trans,{id:"Open the exported game folder"})})}})}},rr=t(29277),tr=x()("electron"),nr=x()("@electron/remote"),or=nr?nr.dialog:null,ar={container:{position:"relative",display:"flex",alignItems:"baseline"},button:{marginLeft:10},textField:{flex:1}},ir=function(e){var r=e.value,t=e.onChange,o=e.title,a=e.message,i=e.defaultPath,u=e.fullWidth,s=e.filters,l=function(){var e=(0,c.Z)(f().mark((function e(){var r,n,u;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(or&&tr){e.next=2;break}return e.abrupt("return");case 2:return r=nr.getCurrentWindow(),e.next=5,or.showSaveDialog(r,{title:o,filters:s,message:a,defaultPath:i});case 5:n=e.sent,u=n.filePath,t(u||"");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,R.jsxs)("div",{style:(0,n.Z)((0,n.Z)({},ar.container),{},{width:u?"100%":void 0}),children:[(0,R.jsx)(rr.ZP,{margin:"dense",style:ar.textField,type:"text",translatableHintText:{id:"Choose a file"},value:r,onChange:function(e,r){return t(r)}}),(0,R.jsx)(de.Z,{label:(0,R.jsx)(d.Trans,{id:"Choose"}),style:ar.button,onClick:l})]})},ur=t(20049),sr=x()("fs"),cr=(0,ur.Z)("archiver"),lr=function(e){var r=e.path,t=e.outputFilename,n=e.sizeLimit,o=cr();return new Promise((function(e,a){if(!sr||!o)return a(new Error("Archiver unavailable"));var i=sr.createWriteStream(t),u=o("zip",{zlib:{level:9}});i.on("close",(function(){var r=u.pointer();if(console.log("Archive written at ".concat(t,", ").concat(r," total bytes.")),n&&r>n){var o=Math.round(r/1e6);a(new Error("Archive is of size ".concat(o," MB, which is above the limit allowed of ").concat(n/1e6," MB.")))}e(t)})),u.on("error",(function(e){a(e)})),u.pipe(i),u.directory(r,!1),u.finalize()}))},pr=t(30400),fr=x()("path"),dr=x()("electron"),hr=x()("@electron/remote"),vr=hr?hr.app:null,mr=dr?dr.shell:null,gr=t.g.gd,xr={name:"local-facebook-instant-games",getInitialExportState:function(e){return{archiveOutputFilename:vr?fr.join(vr.getPath("documents"),"fb-instant-game.zip"):""}},canLaunchBuild:function(e){return!!e.archiveOutputFilename},isNavigationDisabled:function(){return!1},renderHeader:function(e){e.project;var r=e.exportState,t=e.updateExportState;return(0,R.jsxs)(C.sg,{noMargin:!0,children:[(0,R.jsx)(C.x1,{children:(0,R.jsx)(pr.if,{})}),(0,R.jsx)(C.x1,{children:(0,R.jsx)(ir,{title:"Facebook Instant Games export zip file",message:"Choose where to save the exported file for Facebook Instant Games",filters:[{name:"Compressed file for Facebook Instant Games",extensions:["zip"]}],value:r.archiveOutputFilename,defaultPath:vr?vr.getPath("documents"):"",onChange:function(e){return t((function(){return{archiveOutputFilename:e}}))},fullWidth:!0})})]})},renderLaunchButtonLabel:function(){return(0,R.jsx)(d.Trans,{id:"Package"})},prepareExporter:function(e){return(0,pe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new le({downloadUrlsToLocalFiles:!0}),n=ke()(new gr.AbstractFileSystemJS,t),o=new gr.Exporter(n,r),a=fr.join(n.getTempDir(),"FacebookInstantGamesExport");return n.mkDir(a),n.clearDir(a),{exporter:o,localFileSystem:t,temporaryOutputDir:a}}))},launchExport:function(){var e=(0,c.Z)(f().mark((function e(r,t,n){var o,a,i,u;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=t.temporaryOutputDir,(u=new gr.ExportOptions(r.project,i)).setTarget("facebookInstantGames"),n&&u.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(u),u.delete(),o.delete(),e.abrupt("return",{temporaryOutputDir:i,urlFiles:a.getAllUrlFilesIn(i)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,c.Z)(f().mark((function e(r,t){var n,o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.temporaryOutputDir,o=t.urlFiles,e.next=3,(0,Ge.t)({urlContainers:o,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",{temporaryOutputDir:n});case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){var t=r.temporaryOutputDir;return lr({path:t,outputFilename:e.exportState.archiveOutputFilename})},renderDoneFooter:function(e){var r=e.exportState,t=(e.onClose,function(){mr&&fr&&mr.openPath(fr.dirname(r.archiveOutputFilename))});return(0,R.jsx)(pr.Eg,{renderGameButton:function(){return(0,R.jsx)(Z.Z,{label:(0,R.jsx)(d.Trans,{id:"Open folder"}),primary:!0,onClick:t},"open")}})}},wr=t(10959),br=x()("electron"),yr=br?br.ipcRenderer:null,Pr=function(e,r,t){return yr?(yr.removeAllListeners("local-file-upload-progress"),yr.removeAllListeners("local-file-upload-done"),new Promise((function(n,o){yr.on("local-file-upload-progress",(function(e,r,n){t(r,n)})),yr.on("local-file-upload-done",(function(e,r){if(r)return o(r);n()})),yr.send("local-file-upload",e,r)}))):Promise.reject("No support for local file upload")},jr=t(28490),kr=x()("path"),Sr=x()("os"),Er=t.g.gd,Fr={name:"local-online-cordova",onlineBuildType:"cordova-build",limitedBuilds:!0,packageNameWarningType:"mobile",getInitialExportState:function(){return{targets:["androidApk"],keystore:"new",signingDialogOpen:!1}},canLaunchBuild:function(e,r,t){return r||""===t},isNavigationDisabled:function(e,r){return!r&&["register","export","resources-download","compress","upload"].includes(e)},renderHeader:function(e){return(0,R.jsx)(jr.s,(0,n.Z)({},e))},renderLaunchButtonLabel:function(){return(0,R.jsx)(d.Trans,{id:"Create package for Android"})},prepareExporter:function(e){return(0,pe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new le({downloadUrlsToLocalFiles:!0}),n=ke()(new Er.AbstractFileSystemJS,t),o=new Er.Exporter(n,r),a=kr.join(n.getTempDir(),"OnlineCordovaExport");return n.mkDir(a),n.clearDir(a),{exporter:o,localFileSystem:t,temporaryOutputDir:a}}))},launchExport:function(){var e=(0,c.Z)(f().mark((function e(r,t,n){var o,a,i,u;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=t.temporaryOutputDir,(u=new Er.ExportOptions(r.project,i)).setTarget("cordova"),n&&u.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(u),u.delete(),o.delete(),e.abrupt("return",{temporaryOutputDir:i,urlFiles:a.getAllUrlFilesIn(i)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,c.Z)(f().mark((function e(r,t){var n,o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.temporaryOutputDir,o=t.urlFiles,e.next=3,(0,Ge.t)({urlContainers:o,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",{temporaryOutputDir:n});case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){var t=r.temporaryOutputDir,n=Sr.tmpdir();return lr({path:t,outputFilename:kr.join(n,"game-archive.zip")})},launchUpload:function(e,r){return(0,wr.Zi)().then((function(t){return Pr(r,t,e.updateStepProgress).then((function(){return t.key}))}))},launchOnlineBuild:function(e,r,t,n,o){var a=r.getAuthorizationHeader,i=r.firebaseUser;return i?(0,wr.$C)(a,i.uid,t,e.targets,e.keystore,n,o):Promise.reject(new Error("User is not authenticated"))}},Dr=t(42141),Cr=x()("path"),Zr=x()("os"),Or=t.g.gd,Rr={name:"local-online-electron",onlineBuildType:"electron-build",limitedBuilds:!0,packageNameWarningType:"desktop",getInitialExportState:function(){return{targets:["winExe"]}},canLaunchBuild:function(e,r,t){return!!e.targets.length&&(r||""===t)},isNavigationDisabled:function(e,r){return!r&&["register","export","resources-download","compress","upload"].includes(e)},renderHeader:function(e){return(0,R.jsx)(Dr.s,(0,n.Z)({},e))},renderLaunchButtonLabel:function(){return(0,R.jsx)(d.Trans,{id:"Package"})},prepareExporter:function(e){return(0,pe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new le({downloadUrlsToLocalFiles:!0}),n=ke()(new Or.AbstractFileSystemJS,t),o=new Or.Exporter(n,r),a=Cr.join(n.getTempDir(),"OnlineElectronExport");return n.mkDir(a),n.clearDir(a),{exporter:o,localFileSystem:t,temporaryOutputDir:a}}))},launchExport:function(){var e=(0,c.Z)(f().mark((function e(r,t,n){var o,a,i,u;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=t.temporaryOutputDir,(u=new Or.ExportOptions(r.project,i)).setTarget("electron"),n&&u.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(u),u.delete(),o.delete(),e.abrupt("return",{temporaryOutputDir:i,urlFiles:a.getAllUrlFilesIn(i)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,c.Z)(f().mark((function e(r,t){var n,o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.temporaryOutputDir,o=t.urlFiles,e.next=3,(0,Ge.t)({urlContainers:o,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",{temporaryOutputDir:n});case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){var t=r.temporaryOutputDir,n=Zr.tmpdir();return lr({path:t,outputFilename:Cr.join(n,"game-archive.zip")})},launchUpload:function(e,r){return(0,wr.Zi)().then((function(t){return Pr(r,t,e.updateStepProgress).then((function(){return t.key}))}))},launchOnlineBuild:function(e,r,t,n,o){var a=r.getAuthorizationHeader,i=r.firebaseUser;return i?(0,wr.ch)(a,i.uid,t,e.targets,n,o):Promise.reject(new Error("User is not authenticated"))}},Nr=t(80010),Ar=x()("path"),Tr=x()("os"),Lr=t.g.gd,Mr={name:"local-online-web",onlineBuildType:"web-build",getInitialExportState:function(){return null},canLaunchBuild:function(e,r,t){return r||""===t||"done"===t},isNavigationDisabled:function(e,r){return!r&&!["","done"].includes(e)},renderHeader:function(){return(0,R.jsx)(Nr.if,{})},renderLaunchButtonLabel:function(){return(0,R.jsx)(d.Trans,{id:"Generate link"})},renderCustomStepsProgress:function(e){var r=e.build,t=e.project,n=e.onSaveProject,o=e.errored,a=e.exportStep;return(0,R.jsx)(Nr.lv,{build:r,project:t,onSaveProject:n,errored:o,exportStep:a})},prepareExporter:function(e){return(0,pe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new le({downloadUrlsToLocalFiles:!0}),n=ke()(new Lr.AbstractFileSystemJS,t),o=new Lr.Exporter(n,r),a=Ar.join(n.getTempDir(),"OnlineWebExport");return n.mkDir(a),n.clearDir(a),{exporter:o,localFileSystem:t,temporaryOutputDir:a}}))},launchExport:function(){var e=(0,c.Z)(f().mark((function e(r,t,n){var o,a,i,u;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=t.temporaryOutputDir,u=new Lr.ExportOptions(r.project,i),n&&u.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(u),u.delete(),o.delete(),e.abrupt("return",{temporaryOutputDir:i,urlFiles:a.getAllUrlFilesIn(i)});case 7:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,c.Z)(f().mark((function e(r,t){var n,o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.temporaryOutputDir,o=t.urlFiles,e.next=3,(0,Ge.t)({urlContainers:o,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",{temporaryOutputDir:n});case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){var t=r.temporaryOutputDir,n=Tr.tmpdir();return lr({path:t,outputFilename:Ar.join(n,"game-archive.zip"),sizeLimit:25e7})},launchUpload:function(e,r){return(0,wr.Zi)().then((function(t){return Pr(r,t,e.updateStepProgress).then((function(){return t.key}))}))},launchOnlineBuild:function(e,r,t,n,o){var a=r.getAuthorizationHeader,i=r.firebaseUser;return i?(0,wr.Bc)(a,i.uid,t,n,o):Promise.reject(new Error("User is not authenticated"))}},Ur=(0,n.Z)((0,n.Z)({},Nr.O1),{},{exportPipeline:Mr}),Ir=[(0,n.Z)((0,n.Z)({},Qe.BN),{},{exportPipeline:er}),(0,n.Z)((0,n.Z)({},jr.V),{},{exportPipeline:Fr}),(0,n.Z)((0,n.Z)({},Dr.O),{},{exportPipeline:Rr}),(0,n.Z)((0,n.Z)({},pr.xu),{},{exportPipeline:xr})],Gr=[(0,n.Z)((0,n.Z)({},Qe.BN),{},{exportPipeline:er}),(0,n.Z)((0,n.Z)({},Ie.VU),{},{exportPipeline:We}),(0,n.Z)((0,n.Z)({},ze.c8),{},{exportPipeline:Xe})],Br=t(76288),Jr=t(36559),_r=t(36262),Wr=x()("electron"),zr=x()("@electron/remote"),Hr=zr?zr.app:null,Kr=Wr?Wr.ipcRenderer:null,Vr=function(e){var r=e.ipcEvent,t=e.callback,n=e.shouldApply;o.useEffect((function(){if(Kr&&n){var e=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return t.apply(void 0,n)};return Kr.on(r,e),function(){return Kr.removeListener(r,e)}}}),[r,t,n])},Xr=function(e){var r=e.event,t=e.callback;o.useEffect((function(){if(Hr){var e=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return t.apply(void 0,n)};return Hr.on(r,e),function(){return Hr.removeListener(r,e)}}}),[r,t])},Qr=function(e){if(!e)return!1;var r=e.toLowerCase();return r.startsWith("gdevelop")&&"gdevelop dialogue tree editor (yarn)"!==r&&"gdevelop sound effects editor (jfxr)"!==r&&"gdevelop image editor (piskel)"!==r},Yr=function(e){var r=e.props,t=e.callbacks,n=e.extraCallbacks,a=r.i18n,i=r.project,u=r.recentProjectFiles,s=r.shortcutMap,c=n.onClosePreview,l=a.language,p=o.useState(!0),f=(0,w.Z)(p,2),d=f[0],h=f[1],v=o.useState(zr.getCurrentWindow().id),m=(0,w.Z)(v,2),g=m[0],x=m[1],b=!d&&c?function(){return c(g)}:null,y=o.useContext(_r.ZP).values.useShortcutToClosePreviewWindow;Xr({event:"browser-window-focus",callback:function(e){x(e.id),h(Qr(e.title))}}),Xr({event:"browser-window-blur",callback:function(e){h(!Qr(e.title))}}),Vr({ipcEvent:"main-menu-open",callback:t.onChooseProject,shouldApply:d}),Vr({ipcEvent:"main-menu-open-recent",callback:t.onOpenRecentFile,shouldApply:d}),Vr({ipcEvent:"main-menu-save",callback:t.onSaveProject,shouldApply:d}),Vr({ipcEvent:"main-menu-save-as",callback:t.onSaveProjectAs,shouldApply:d}),Vr({ipcEvent:"main-menu-close",callback:y&&b?b:t.onCloseProject,shouldApply:!(!y||!b)||d}),Vr({ipcEvent:"main-menu-close-app",callback:t.onCloseApp,shouldApply:d}),Vr({ipcEvent:"main-menu-export",callback:t.onExportProject,shouldApply:d}),Vr({ipcEvent:"main-menu-create-template",callback:t.onCreateProject,shouldApply:d}),Vr({ipcEvent:"main-menu-create-blank",callback:t.onCreateBlank,shouldApply:d}),Vr({ipcEvent:"main-menu-open-project-manager",callback:t.onOpenProjectManager,shouldApply:d}),Vr({ipcEvent:"main-menu-open-home-page",callback:t.onOpenHomePage,shouldApply:d}),Vr({ipcEvent:"main-menu-open-debugger",callback:t.onOpenDebugger,shouldApply:d}),Vr({ipcEvent:"main-menu-open-about",callback:t.onOpenAbout,shouldApply:d}),Vr({ipcEvent:"main-menu-open-preferences",callback:t.onOpenPreferences,shouldApply:d}),Vr({ipcEvent:"main-menu-open-language",callback:t.onOpenLanguage,shouldApply:d}),Vr({ipcEvent:"main-menu-open-profile",callback:t.onOpenProfile,shouldApply:d}),Vr({ipcEvent:"main-menu-open-games-dashboard",callback:t.onOpenGamesDashboard,shouldApply:d}),Vr({ipcEvent:"update-status",callback:t.setElectronUpdateStatus,shouldApply:!0}),o.useEffect((function(){Kr&&Kr.send("set-main-menu",(0,Jr.c)({project:i,i18n:a,recentProjectFiles:u,shortcutMap:s,isApplicationTopLevelMenu:!0}))}),[a,l,i,u,s]);var P=t.onOpenRecentFile;return(0,Br.gT)("OPEN_RECENT_PROJECT",!0,{generateOptions:o.useCallback((function(){return u.map((function(e){return{text:e.fileMetadata.fileIdentifier,handler:function(){return P(e)}}}))}),[P,u])}),null},qr=t(50790),$r=t.n(qr),et=t(91479),rt=t.n(et),tt=x()("path"),nt=x()("os"),ot=x()("fs"),at=function(e){var r=e.onWriteFile,t=tt.join(nt.tmpdir(),"GDGeneratedEventsFunctions-"+ne());ot.mkdir(t,(function(e){e&&"EEXIST"!==e.code&&console.error("Unable to create the directory where to output events functions generated code: ",e)}));var n=function(e){return"".concat(t,"/").concat(rt()(e),".js")};return{getIncludeFileFor:function(e){return n(e)},writeFunctionCode:function(e,t){return new Promise((function(o,a){var i=n(e);r({includeFile:i,content:t}),ot.writeFile(i,t,(function(e){if(e)return a(e);o()}))}))},writeBehaviorCode:function(e,t){return new Promise((function(o,a){var i=n(e);r({includeFile:i,content:t}),ot.writeFile(i,t,(function(e){if(e)return a(e);o()}))}))},writeObjectCode:function(e,t){return new Promise((function(o,a){var i=n(e);r({includeFile:i,content:t}),ot.writeFile(i,t,(function(e){if(e)return a(e);o()}))}))}}},it=t(14212),ut=t(90505),st=t(62052),ct=t(41006),lt=x()("fs-extra"),pt=x()("path"),ft=x()("@electron/remote"),dt=ft?ft.dialog:null,ht=function(e,r){if(!lt)return Promise.reject(new Error("Filesystem is not supported."));try{var t=JSON.stringify(e,null,2);return lt.ensureDir(pt.dirname(r)).then((function(){return new Promise((function(e,n){lt.writeFile(r,t,(function(r){return r?n(r):e()}))}))}))}catch(n){return Promise.reject(n)}},vt=(0,$.Z)((function e(){(0,q.Z)(this,e)}));vt.chooseEventsFunctionExtensionFile=function(e){if(!dt)return Promise.reject("Not supported");var r=ft.getCurrentWindow();return dt.showSaveDialog(r,{title:"Export an extension of the project",filters:[{name:'SpeXEngine 5 "events based" extension',extensions:["json"]}],defaultPath:e||"Extension.json"}).then((function(e){var r=e.filePath;return r||null}))},vt.writeEventsFunctionsExtension=function(e,r){var t=(0,ct.XH)(e);return ht(t,r).catch((function(e){throw console.error("Unable to write the events function extension:",e),e}))},vt.chooseCustomObjectFile=function(e){if(!dt)return Promise.reject("Not supported");var r=ft.getCurrentWindow();return dt.showSaveDialog(r,{title:"Export an object of the project",filters:[{name:"SpeXEngine 5 object configuration",extensions:["gdo"]}],defaultPath:e||"Object"}).then((function(e){var r=e.filePath;return r||null}))},vt.writeCustomObject=function(e,r){var t=e.clone().get();t.setTags(""),t.getVariables().clear(),t.getEffects().clear(),t.getAllBehaviorNames().toJSArray().forEach((function(e){return t.removeBehavior(e)}));var n=(0,ct.XH)(t);return ht(n,r).catch((function(e){throw console.error("Unable to write the object:",e),e}))};var mt=x()("fs"),gt=x()("@electron/remote"),xt=gt?gt.dialog:null,wt=(0,$.Z)((function e(){(0,q.Z)(this,e)}));wt.chooseEventsFunctionExtensionFile=function(){if(!xt)return Promise.reject("Not supported");var e=gt.getCurrentWindow();return xt.showOpenDialog(e,{title:"Import an extension in the project",properties:["openFile"],message:"Choose an extension file to import (.json file)",filters:[{name:'SpeXEngine 5 "events based" extension',extensions:["json"]}]}).then((function(e){var r=e.filePaths;return r&&r.length?r[0]:null}))},wt.readEventsFunctionExtensionFile=function(e){return function(e){return mt?new Promise((function(r,t){mt.readFile(e,{encoding:"utf8"},(function(n,o){if(n)return t(n);try{var a=JSON.parse(o);return r(a)}catch(i){return t(e+" is a corrupted/malformed file.")}}))})):Promise.reject("Filesystem is not supported.")}(e)};var bt,yt,Pt=t(56924),jt=t(59603),kt=x()("fs"),St=x()("path"),Et=x()("@electron/remote"),Ft=Et?Et.dialog:null,Dt=function(e){return kt?new Promise((function(r,t){kt.readFile(e,{encoding:"utf8"},(function(n,o){if(n)return t(n);try{var a=JSON.parse(o);return r(a)}catch(i){return t(e+" is a corrupted/malformed file.")}}))})):Promise.reject("Filesystem is not supported.")},Ct=function(){if(!Ft)return Promise.reject("Not supported");var e=Et.getCurrentWindow();return Ft.showOpenDialog(e,{title:"Open a project",properties:["openFile"],message:"If you want to open your SpeXEngine 4 project, be sure to save it as a .json file",filters:[{name:"SpeXEngine 5 project",extensions:["json"]}]}).then((function(e){var r=e.filePaths;return r&&r.length?{fileIdentifier:r[0]}:null}))},Zt=function(e){var r=e.fileIdentifier,t=St.dirname(r);return Dt(r).then((function(e){return(0,jt.dZ)(e,{getReferencePartialObject:function(e){return Dt(St.join(t,e)+".json")},isReferenceMagicPropertyName:"__REFERENCE_TO_SPLIT_OBJECT",maxUnsplitDepth:3}).then((function(){return{content:e}}))}))},Ot=function(){var e=(0,c.Z)(f().mark((function e(r,t){var n,o,a,i;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.fileIdentifier,o=n+".autosave",!kt.existsSync(o)){e.next=15;break}if(a=kt.statSync(o).mtime.getTime(),t){e.next=6;break}return e.abrupt("return",a);case 6:return e.prev=6,i=kt.statSync(n).mtime.getTime(),e.abrupt("return",a>i+5e3?a:null);case 11:return e.prev=11,e.t0=e.catch(6),console.error("Unable to compare *.autosave to project",e.t0),e.abrupt("return",null);case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[6,11]])})));return function(r,t){return e.apply(this,arguments)}}(),Rt=function(e){return Promise.resolve((0,n.Z)((0,n.Z)({},e),{},{fileIdentifier:e.fileIdentifier+".autosave"}))},Nt=t(93849),At=t(78118),Tt=o.memo((function(e){return(0,R.jsx)(At.Z,(0,n.Z)((0,n.Z)({},e),{},{viewBox:"0 0 16 16",style:{fill:"none"},children:(0,R.jsx)("path",{d:"M5.75 11.25C5.75 11.25 6 14.25 4 15.25H12C10 14.25 10.25 11.25 10.25 11.25M5.75 11.25H13.25C14.3546 11.25 15.25 10.3546 15.25 9.25V2.75C15.25 1.64543 14.3546 0.75 13.25 0.75H2.75C1.64543 0.75 0.75 1.64543 0.75 2.75V9.25C0.75 10.3546 1.64543 11.25 2.75 11.25H5.75Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}))})),Lt=t(18455),Mt=t.g.gd,Ut=(0,ur.Z)("glob"),It=x()("path"),Gt=x()("electron"),Bt=function(){var e=(0,c.Z)(f().mark((function e(r){var t,n,o,a,i,u,s,c,p,d;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.project,n=r.extensions,o=r.createResource,a=Ut()){e.next=4;break}return e.abrupt("return");case 4:return i=t.getResourcesManager(),u=It.dirname(t.getProjectFile()),s=[].concat((0,l.Z)(n),(0,l.Z)(n.map((function(e){return e.toUpperCase()})))),e.prev=7,e.next=10,new Promise((function(e,r){a(u+"/**/*.{"+s.join(",")+"}",(function(t,n){t?r(t):e(n)}))}));case 10:c=e.sent,p=new Mt.VectorString,c.forEach((function(e){return p.push_back(It.relative(u,e))})),d=t.getResourcesManager().findFilesNotInResources(p),p.delete(),(0,Lt.mapVector)(d,(function(e){var r=(0,b.Z)(e,(function(e){return i.hasResource(e)})),n=o();n.setFile(e),n.setName(r),(0,m.r3)(t,n),i.addResource(n),n.delete(),console.info('"'.concat(e,'" added to project as resource named "').concat(r,'".'))})),e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(7),console.error("Error finding files inside ".concat(u,":"),e.t0),e.abrupt("return");case 22:case"end":return e.stop()}}),e,null,[[7,18]])})));return function(r){return e.apply(this,arguments)}}(),Jt={internalName:"LocalFile",name:{id:"Your computer"},renderIcon:function(e){return(0,R.jsx)(Tt,{fontSize:e.size})},getFileMetadataFromAppArguments:function(e){return e[i.rM]&&e[i.rM].length?{fileIdentifier:e[i.rM][0]}:null},onRenderNewProjectSaveAsLocationChooser:Nt.CM,createOperations:function(){return{onOpenWithPicker:Ct,onOpen:Zt,getAutoSaveCreationDate:Ot,onSaveProject:Nt.mc,onChooseSaveProjectAsLocation:Nt.WM,onSaveProjectAs:Nt.uH,onAutoSaveProject:Nt.P_,onGetAutoSave:Rt,getOpenErrorMessage:function(e){return{id:"Check that the file exists, that this file is a proper game created with SpeXEngine and that you have the authorization to open it."}},getWriteErrorMessage:Nt.Kx}},createResourceOperations:function(){return function(e){var r=e.project,t=e.resource,n=e.i18n,o=e.updateInterface,a=e.cleanUserSelectionOfResources,i=e.informUser;return[{label:n._({id:"Locate file"}),click:function(){return function(e){var r=e.project,t=e.resource,n=(0,m.U3)(r,t.getName());Gt.shell.showItemInFolder(It.resolve(n))}({project:r,resource:t})}},{label:n._({id:"Open file"}),click:function(){return function(e){var r=e.project,t=e.resource,n=(0,m.U3)(r,t.getName());Gt.shell.openPath(It.resolve(n))}({project:r,resource:t})}},{label:n._({id:"Copy file path"}),click:function(){!function(e){var r=e.project,t=e.resource,n=(0,m.U3)(r,t.getName());Gt.clipboard.writeText(It.resolve(n))}({project:r,resource:t}),i({message:(0,R.jsx)(d.Trans,{id:"Resource file path copied to clipboard"})})}},{type:"separator"},{label:n._({id:"Scan in the project folder for..."}),submenu:h.Q.map((function(e){var t=e.displayName,a=e.fileExtensions,i=e.createNewResource;return{label:n._(t),click:function(){var e=(0,c.Z)(f().mark((function e(){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Bt({project:r,extensions:a,createResource:i});case 2:o();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}))},{label:n._({id:"Remove resources with invalid path"}),click:function(){!function(e){var r=e.project,t=r.getResourcesManager();t.getAllResourceNames().toJSArray().filter((function(e){return"error"===(0,m.iz)(r,e)})).forEach((function(e){t.removeResource(e),console.info("Removed due to invalid path: "+e)}))}({project:r}),a(),o()}}]}}},_t=x()("electron"),Wt=_t?_t.ipcRenderer:null,zt=function(){var e=o.useContext(_r.ZP).values.useGDJSDevelopmentWatcher;return o.useEffect((function(){if(e){if(Wt)return Wt.send("setup-local-gdjs-development-watcher"),function(){Wt.send("close-local-gdjs-development-watcher")};console.error("Unable to find ipcRenderer to set up GDJS development watchers")}}),[e]),null},Ht=t(32438),Kt=t(8018),Vt=t(38428),Xt=t.n(Vt),Qt=t(997),Yt=t(36465),qt=t(84140),$t=t(72702),en=t(34517),rn=t(14446),tn=t.n(rn),nn=x()("electron"),on=nn?nn.ipcRenderer:null,an=x()("fs-extra"),un=x()("path"),sn=function(e,r,t){var n=un.extname(t),o=un.basename(t,n),a=(0,b.Z)(o,(function(t){var o=un.join(e,t)+n;return an.existsSync(o)||r.has(o)}));return un.join(e,a)+n},cn=function(){var e=(0,c.Z)(f().mark((function e(r,t){var n,o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(on){e.next=2;break}throw new Error("Not supported");case 2:return e.next=4,tn().get(r,{responseType:"arraybuffer"});case 4:return n=e.sent,o=n.data,e.next=8,on.invoke("local-file-save-from-arraybuffer",o,t);case 8:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),ln=function(){var e=(0,c.Z)(f().mark((function e(r){var t,n,o,a,i,u,s,l,p,d,h;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.project,n=r.fileMetadata,o=r.onProgress,an&&on){e.next=3;break}throw new Error("Unsupported");case 3:return a=t.getResourcesManager(),i=a.getAllResourceNames().toJSArray(),u=i.filter((function(e){var r=a.getResource(e);return(0,m.PX)(r.getFile())})),s=un.dirname(n.fileIdentifier),l=un.join(s,"assets"),p=new Set,d=[],h=0,e.next=13,Xt().withConcurrency(50).for(u).process(function(){var e=(0,c.Z)(f().mark((function e(r){var t,n,i,v,g,x,w,b;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.getResource(r),n=t.getFile(),!(0,m.Gu)(n)){e.next=18;break}return e.prev=3,i=(0,m.OI)(t),v=i.localFilePath,g=i.extension,x=v?un.resolve(s,v):sn(l,p,(0,$t.B)(t.getName()+(g||""))),e.next=8,an.ensureDir(l);case 8:return e.next=10,cn(n,x);case 10:t.setFile(un.relative(s,x).replace(/\\/g,"/")),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),d.push({resourceName:r,error:e.t0});case 16:e.next=29;break;case 18:return w=(0,Yt.bW)(n)?(0,Yt.SV)(n):(0,qt.d0)(n)?(0,qt.uD)(n):(0,en.zu)(n),b=sn(l,p,w),p.add(b),e.prev=21,e.next=24,(0,Qt.x)({times:2},(0,c.Z)(f().mark((function e(){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,an.ensureDir(l);case 2:return e.next=4,on.invoke("local-file-download",n,b);case 4:t.setFile(un.relative(s,b).replace(/\\/g,"/"));case 5:case"end":return e.stop()}}),e)}))));case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(21),d.push({resourceName:r,error:e.t1});case 29:o(h++,u.length);case 30:case"end":return e.stop()}}),e,null,[[3,13],[21,26]])})));return function(r){return e.apply(this,arguments)}}());case 13:return e.abrupt("return",{erroredResources:d});case 14:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),pn=t(10822),fn=t(85919),dn=function(){var e=(0,c.Z)(f().mark((function e(r,t){var n,o,a,i,u,s;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.transformItem,o=t.isChunkTooBig,a=t.processChunk,i=0,u=[];case 3:if(!(i<r.length)){e.next=20;break}return e.next=6,n(r[i]);case 6:if(s=e.sent,u.length){e.next=10;break}e.next=16;break;case 10:if(o([].concat(u,[s]))){e.next=13;break}e.next=16;break;case 13:return e.next=15,a(u);case 15:u.length=0;case 16:u.push(s),i++,e.next=3;break;case 20:if(!u.length){e.next=24;break}return e.next=23,a(u);case 23:u.length=0;case 24:return e.abrupt("return");case 25:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),hn=x()("path"),vn=x()("fs"),mn=function(){var e=(0,c.Z)(f().mark((function e(r){var t,n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){vn.readFile(r,(function(r,n){r?t(r):e(n)}))}));case 2:return t=e.sent,n=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),gn={aac:"audio/aac",wav:"audio/wav",mp3:"audio/mp3",ogg:"audio/ogg",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",webp:"image/webp",ttf:"font/ttf",otf:"font/otf",mp4:"video/mp4",webm:"video/webm",json:"application/json",xml:"application/xml",gz:"application/gzip",js:"application/javascript"},xn=function(){var e=(0,c.Z)(f().mark((function e(r){var t,n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mn(r);case 2:return t=e.sent,n=hn.extname(r).replace(/^\./,""),e.abrupt("return",new File([t],hn.basename(r),{type:gn[n]||"application/octet-stream"}));case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),wn=x()("path"),bn=t.g.gd,yn=function(){var e=(0,c.Z)(f().mark((function e(){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{erroredResources:[]});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Pn=function(){var e=(0,c.Z)(f().mark((function e(r){var t,n,o,a,i,u,s,l,p,d,h;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.project,n=r.authenticatedUser,o=r.oldFileMetadata,a=r.newFileMetadata,i=r.onProgress,u={erroredResources:[]},s=a.fileIdentifier,l=t.getResourcesManager(),p=function(e){return l.getAllResourceNames().toJSArray().map((function(e){var r=l.getResource(e),t=r.getFile();return(0,m.PX)(t)?(0,fn.yk)(t)?null:(0,m.Gu)(t)?(u.erroredResources.push({resourceName:r.getName(),error:new Error("Unsupported blob URL.")}),null):null:r})).filter(Boolean)}(),d=wn.dirname(o.fileIdentifier),h=0,e.next=10,dn(p,{transformItem:function(){var e=(0,c.Z)(f().mark((function e(r){var t,n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=wn.resolve(d,r.getFile()),e.prev=1,e.next=4,xn(t);case 4:return n=e.sent,e.abrupt("return",{resource:r,file:n});case 8:return e.prev=8,e.t0=e.catch(1),u.erroredResources.push({resourceName:r.getName(),error:new Error("Unable to open the file (".concat(t,")."))}),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(r){return e.apply(this,arguments)}}(),isChunkTooBig:function(e){return e.length>70||e.filter(Boolean).reduce((function(e,r){return e+r.file.size}),0)>15e7},processChunk:function(){var e=(0,c.Z)(f().mark((function e(r){var t,o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.filter(Boolean),e.next=3,(0,en.LG)(n,s);case 3:return e.next=5,(0,en.ll)(n,s,t.map((function(e){return e.file})),(function(e,r){i(h+e,p.length)}));case 5:o=e.sent,h+=r.length,o.forEach((function(e,r){var n=e.url,o=e.error,a=t[r].resource;!o&&n?a.setFile(n):u.erroredResources.push({resourceName:a.getName(),error:o||new Error("Unknown error during upload.")})}));case 8:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()});case 10:return e.abrupt("return",u);case 11:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),jn=(bt={},(0,I.Z)(bt,"".concat(Jt.internalName,"=>").concat(Jt.internalName),function(){var e=(0,c.Z)(f().mark((function e(r){var t,n,o,a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.project,n=r.newFileMetadata,o=wn.dirname(n.fileIdentifier),a=ke()(new bn.AbstractFileSystemJS,new le),bn.ProjectResourcesCopier.copyAllResourcesTo(t,a,o,!0,!1,!0),e.abrupt("return",{erroredResources:[]});case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),(0,I.Z)(bt,"".concat(Ht.Z.internalName,"=>").concat(Jt.internalName),(function(e){var r=e.project,t=e.newFileMetadata,n=e.onProgress;return ln({project:r,fileMetadata:t,onProgress:n})})),(0,I.Z)(bt,"".concat(Kt.Z.internalName,"=>").concat(Jt.internalName),(function(e){var r=e.project,t=e.newFileMetadata,n=e.onProgress;return ln({project:r,fileMetadata:t,onProgress:n})})),(0,I.Z)(bt,"".concat(Jt.internalName,"=>").concat(Ht.Z.internalName),Pn),(0,I.Z)(bt,"".concat(Ht.Z.internalName,"=>").concat(Ht.Z.internalName),pn.x),(0,I.Z)(bt,"".concat(Kt.Z.internalName,"=>").concat(Ht.Z.internalName),yn),bt),kn={moveAllProjectResources:function(){var e=(0,c.Z)(f().mark((function e(r){var t,n,o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.oldStorageProvider,n=r.newStorageProvider,o=jn["".concat(t.internalName,"=>").concat(n.internalName)]){e.next=4;break}throw new Error("Can't find a ResourceMover for ".concat(t.internalName," to ").concat(n.internalName,"."));case 4:return e.abrupt("return",o(r));case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},Sn=kn,En=t(58271),Fn=t(527),Dn=(yt={},(0,I.Z)(yt,Ht.Z.internalName,Fn.f),(0,I.Z)(yt,Jt.internalName,ln),(0,I.Z)(yt,Kt.Z.internalName,En.j),yt),Cn={fetchAllProjectResources:function(){var e=(0,c.Z)(f().mark((function e(r){var t,n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.storageProvider,n=Dn[t.internalName]){e.next=4;break}throw new Error("Can't find a ResourceFetcher for ".concat(t.internalName," - have you registered the storage provider here?"));case 4:return e.abrupt("return",n(r));case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},Zn=Cn,On=t.g.gd,Rn=function(e){i.ZP.setUpContextMenu();var r=i.ZP.getArguments(),t=i.ZP.isDev();return(0,R.jsx)(st.Z,{authentication:e,disableCheckForUpdates:!!r["disable-update-check"],makeEventsFunctionCodeWriter:at,eventsFunctionsExtensionWriter:vt,eventsFunctionsExtensionOpener:wt,children:function(e){var o=e.i18n;return(0,R.jsx)(Pt.Z,{appArguments:r,storageProviders:[Jt,Kt.Z,Ht.Z],defaultStorageProvider:Jt,children:function(e){var r=e.getStorageProviderOperations,i=e.getStorageProviderResourceOperations,s=e.storageProviders,c=e.initialFileMetadataToOpen,l=e.getStorageProvider;return(0,R.jsx)(a.Z,{i18n:o,renderMainMenu:function(e,r,t){return(0,R.jsx)(Yr,{props:e,callbacks:r,extraCallbacks:t})},renderPreviewLauncher:function(e,r){return(0,R.jsx)(Me,(0,n.Z)((0,n.Z)({},e),{},{ref:r}))},renderExportDialog:function(e){return(0,R.jsx)(u.Z,{project:e.project,onSaveProject:e.onSaveProject,onChangeSubscription:e.onChangeSubscription,onClose:e.onClose,automatedExporters:Ir,manualExporters:Gr,onlineWebExporter:Ur})},renderGDJSDevelopmentWatcher:t?function(){return(0,R.jsx)(zt,{})}:null,storageProviders:s,resourceMover:Sn,resourceFetcher:Zn,getStorageProviderOperations:r,getStorageProviderResourceOperations:i,getStorageProvider:l,resourceSources:U,resourceExternalEditors:Y,extensionsLoader:$r()({gd:On,objectsEditorService:it.Z,objectsRenderingService:ut.Z,filterExamples:!t}),initialFileMetadataToOpen:c})}})}})}}}]);
//# sourceMappingURL=local-app.04abcf84.chunk.js.map