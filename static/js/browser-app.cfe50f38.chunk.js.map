{"version":3,"file":"static/js/browser-app.cfe50f38.chunk.js","mappings":"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","sources":["ResourcesList/BrowserResourceSources.js","Utils/BrowserExternalWindowUtils.js","ResourcesList/BrowserResourceExternalEditors.js","Export/BrowserExporters/BrowserS3PreviewLauncher/BrowserPreviewErrorDialog.js","Utils/GDevelopServices/Preview.js","Export/BrowserExporters/BrowserS3FileSystem.js","GameEngineFinder/BrowserS3GDJSFinder.js","Export/BrowserExporters/BrowserS3PreviewLauncher/BrowserPreviewDebuggerServer.js","Export/BrowserExporters/BrowserS3PreviewLauncher/index.js","Export/BrowserExporters/BrowserFileUploader.js","Export/BrowserExporters/BrowserFileSystem.js","Utils/BrowserArchiver.js","Export/BrowserExporters/BrowserOnlineCordovaExport.js","Export/BrowserExporters/BrowserOnlineElectronExport.js","Export/BrowserExporters/BrowserOnlineWebExport.js","Utils/BlobDownloadUrlHolder.js","Export/BrowserExporters/BrowserHTML5Export.js","Export/BrowserExporters/BrowserCordovaExport.js","Export/BrowserExporters/BrowserElectronExport.js","Export/BrowserExporters/BrowserFacebookInstantGamesExport.js","Export/BrowserExporters/index.js","JsExtensionsLoader/BrowserJsExtensionsLoader.js","EventsFunctionsExtensionsLoader/CodeWriters/BrowserS3EventsFunctionCodeWriter.js","UI/CustomSvgIcons/GoogleDrive.js","ProjectsStorage/GoogleDriveStorageProvider/GoogleDriveFileOrFolderPicker.js","ProjectsStorage/GoogleDriveStorageProvider/GoogleDriveSaveAsDialog.js","ProjectsStorage/GoogleDriveStorageProvider/index.js","ProjectsStorage/DownloadFileStorageProvider/DownloadFileSaveAsDialog.js","ProjectsStorage/DownloadFileStorageProvider/index.js","ProjectsStorage/ResourceMover/BrowserResourceMover.js","ProjectsStorage/ResourceFetcher/BrowserResourceFetcher.js","BrowserApp.js"],"sourcesContent":["// @flow\nimport { t, Trans } from '@lingui/macro';\nimport * as React from 'react';\nimport {\n  type ChooseResourceOptions,\n  type ResourceSourceComponentProps,\n  type ResourceSource,\n  allResourceKindsAndMetadata,\n} from './ResourceSource';\nimport { ResourceStore } from '../AssetStore/ResourceStore';\nimport path from 'path-browserify';\nimport { Line } from '../UI/Grid';\nimport { ColumnStackLayout, TextFieldWithButtonLayout } from '../UI/Layout';\nimport RaisedButton from '../UI/RaisedButton';\nimport SemiControlledTextField from '../UI/SemiControlledTextField';\nimport { useDebounce } from '../Utils/UseDebounce';\nimport axios from 'axios';\nimport AlertMessage from '../UI/AlertMessage';\nimport { FileToCloudProjectResourceUploader } from './FileToCloudProjectResourceUploader';\nimport {\n  extractFilenameWithExtensionFromPublicAssetResourceUrl,\n  isPublicAssetResourceUrl,\n} from '../Utils/GDevelopServices/Asset';\n\ntype ResourceStoreChooserProps = {\n  options: ChooseResourceOptions,\n  onChooseResources: (resources: Array<gdResource>) => void,\n  createNewResource: () => gdResource,\n};\n\nconst ResourceStoreChooser = ({\n  options,\n  onChooseResources,\n  createNewResource,\n}: ResourceStoreChooserProps) => {\n  return (\n    <ResourceStore\n      onChoose={resource => {\n        const chosenResourceUrl = resource.url;\n        const newResource = createNewResource();\n        newResource.setFile(chosenResourceUrl);\n        const resourceCleanedName = isPublicAssetResourceUrl(chosenResourceUrl)\n          ? extractFilenameWithExtensionFromPublicAssetResourceUrl(\n              chosenResourceUrl\n            )\n          : path.basename(chosenResourceUrl);\n        newResource.setName(resourceCleanedName);\n        newResource.setOrigin('gdevelop-asset-store', chosenResourceUrl);\n\n        onChooseResources([newResource]);\n      }}\n      resourceKind={options.resourceKind}\n    />\n  );\n};\n\nexport const UrlChooser = ({\n  options,\n  onChooseResources,\n  createNewResource,\n}: ResourceStoreChooserProps) => {\n  const [inputValue, setInputValue] = React.useState('');\n  const [error, setError] = React.useState<?Error>(null);\n  const [urlsErroredBooleanArray, setUrlsErroredBooleanArray] = React.useState<\n    boolean[]\n  >([]);\n  const hasErroredUrls = !!urlsErroredBooleanArray.filter(Boolean).length;\n\n  const validateInputValue = useDebounce(async (inputValue: string) => {\n    const urls = options.multiSelection\n      ? inputValue.split('\\n').filter(Boolean)\n      : [inputValue];\n    setError(null);\n    setUrlsErroredBooleanArray([]);\n\n    try {\n      const responses = await Promise.all(\n        urls.map(async url => {\n          return await axios.get(url, {\n            timeout: 1000,\n            validateStatus: status => true,\n          });\n        })\n      );\n\n      setUrlsErroredBooleanArray(\n        responses.map(\n          response => !(response.status >= 200 && response.status < 400)\n        )\n      );\n    } catch (error) {\n      setError(error);\n    }\n  }, 500);\n\n  React.useEffect(\n    () => {\n      validateInputValue(inputValue);\n    },\n    [inputValue, validateInputValue]\n  );\n\n  return (\n    <ColumnStackLayout noMargin expand>\n      <Line noMargin>\n        <TextFieldWithButtonLayout\n          renderButton={style => (\n            <RaisedButton\n              onClick={() => {\n                const urls = options.multiSelection\n                  ? inputValue.split('\\n').filter(Boolean)\n                  : [inputValue];\n\n                onChooseResources(\n                  urls.map(url => {\n                    const newResource = createNewResource();\n                    newResource.setFile(url);\n                    newResource.setName(path.basename(url));\n                    newResource.setOrigin('url', url);\n\n                    return newResource;\n                  })\n                );\n              }}\n              primary\n              label={<Trans>Choose</Trans>}\n              style={style}\n              disabled={!!error || hasErroredUrls}\n            />\n          )}\n          renderTextField={() => (\n            <SemiControlledTextField\n              floatingLabelText={\n                options.multiSelection ? (\n                  <Trans>Resource(s) URL(s) (one per line)</Trans>\n                ) : (\n                  <Trans>Resource URL</Trans>\n                )\n              }\n              value={inputValue}\n              onChange={setInputValue}\n              multiline={options.multiSelection}\n              rows={1}\n              rowsMax={5}\n              fullWidth\n              errorText={\n                error ? (\n                  <Trans>\n                    There was an error verifying the URL(s). Please check they\n                    are correct.\n                  </Trans>\n                ) : hasErroredUrls ? (\n                  <Trans>\n                    Unable to verify URLs{' '}\n                    {urlsErroredBooleanArray\n                      .map((isErrored, index) => {\n                        if (isErrored) return '#' + (index + 1);\n                        return null;\n                      })\n                      .filter(Boolean)\n                      .join(', ')}\n                    . Please check they are correct.\n                  </Trans>\n                ) : null\n              }\n            />\n          )}\n        />\n      </Line>\n      <AlertMessage kind=\"warning\">\n        <Trans>\n          The URLs must be public and stay accessible while you work on this\n          project - they won't be stored inside the project file. When exporting\n          a game, the resources pointed by these URLs will be downloaded and\n          stored inside the game.\n        </Trans>\n      </AlertMessage>\n    </ColumnStackLayout>\n  );\n};\n\nconst browserResourceSources: Array<ResourceSource> = [\n  ...allResourceKindsAndMetadata.map(({ kind, createNewResource }) => ({\n    name: `upload-${kind}`,\n    displayName: t`File(s) from your device`,\n    displayTab: 'import',\n    kind,\n    renderComponent: (props: ResourceSourceComponentProps) => (\n      <FileToCloudProjectResourceUploader\n        createNewResource={createNewResource}\n        onChooseResources={props.onChooseResources}\n        options={props.options}\n        fileMetadata={props.fileMetadata}\n        getStorageProvider={props.getStorageProvider}\n        key={`url-chooser-${kind}`}\n        automaticallyOpenInput={!!props.automaticallyOpenIfPossible}\n      />\n    ),\n  })),\n  ...allResourceKindsAndMetadata.map(({ kind, createNewResource }) => ({\n    name: `resource-store-${kind}`,\n    displayName: t`Choose from asset store`,\n    displayTab: 'standalone',\n    kind,\n    renderComponent: (props: ResourceSourceComponentProps) => (\n      <ResourceStoreChooser\n        createNewResource={createNewResource}\n        onChooseResources={props.onChooseResources}\n        options={props.options}\n        key={`resource-store-${kind}`}\n      />\n    ),\n  })),\n  ...allResourceKindsAndMetadata.map(({ kind, createNewResource }) => ({\n    name: `url-chooser-${kind}`,\n    displayName: t`Use a public URL`,\n    displayTab: 'import-advanced',\n    kind,\n    renderComponent: (props: ResourceSourceComponentProps) => (\n      <UrlChooser\n        createNewResource={createNewResource}\n        onChooseResources={props.onChooseResources}\n        options={props.options}\n        key={`url-chooser-${kind}`}\n      />\n    ),\n  })),\n];\n\nexport default browserResourceSources;\n","// @flow\nconst spinnerImgSrc = `data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGZpbGw9Im5vbmUiIHZpZXdCb3g9IjAgMCAyNCAyNCI+CjxjaXJjbGUgb3BhY2l0eT0nMC4yNScgY3g9IjEyIiBjeT0iMTIiIHI9IjEwIiBzdHJva2U9IiNGRkZGRkYiIHN0cm9rZS13aWR0aD0iNCI+PC9jaXJjbGU+CjxwYXRoIG9wYWNpdHk9JzAuNzUnIGZpbGw9IiNGRkZGRkYiIGQ9Ik00IDEyYTggOCAwIDAxOC04VjBDNS4zNzMgMCAwIDUuMzczIDAgMTJoNHptMiA1LjI5MUE3Ljk2MiA3Ljk2MiAwIDAxNCAxMkgwYzAgMy4wNDIgMS4xMzUgNS44MjQgMyA3LjkzOGwzLTIuNjQ3eiI+PC9wYXRoPgo8L3N2Zz4=`;\n\nexport const displayBlackLoadingScreen = (externalWindow: WindowProxy) => {\n  externalWindow.document.write(\n    `<html>\n  <head>\n    <style>\n      body {\n        margin: 0;\n        padding: 0;\n        background-color: #000000;\n        overflow: hidden;\n        height: 100vh;\n        width: 100%;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        color: white;\n      }\n      @keyframes spin {\n        100% {\n          transform:rotate(360deg);\n        }\n      }\n      .spinning-loader {\n        animation: spin 3s linear infinite;\n      }\n    </style>\n  </head>\n  <body>\n      <img class=\"spinning-loader\" width=\"50\" alt=\"Loading...\" src=\"${spinnerImgSrc}\">\n  </body>\n</html>`\n  );\n};\n","// @flow\nimport {\n  type ResourceExternalEditor,\n  type ExternalEditorInput,\n  type ExternalEditorOutput,\n  type ExternalEditorBase64Resource,\n  type EditWithExternalEditorOptions,\n  saveBlobUrlsFromExternalEditorBase64Resources,\n  freeBlobsAndUpdateMetadata,\n  patchExternalEditorMetadataWithResourcesNamesIfNecessary,\n  readMetadata,\n} from './ResourceExternalEditor';\nimport { sendExternalEditorOpened } from '../Utils/Analytics/EventSender';\nimport { t } from '@lingui/macro';\nimport { isBlobURL, isURL } from './ResourceUtils';\nimport { type ResourceKind } from './ResourceSource';\nimport {\n  convertBlobToDataURL,\n  downloadUrlsToBlobs,\n  type ItemResult,\n} from '../Utils/BlobDownloader';\nimport { showWarningBox } from '../UI/Messages/MessageBox';\nimport { displayBlackLoadingScreen } from '../Utils/BrowserExternalWindowUtils';\nlet nextExternalEditorWindowId = 0;\n\nconst externalEditorIndexHtml: { ['piskel' | 'yarn' | 'jfxr']: string } = {\n  piskel: 'external/piskel/piskel-index.html',\n  yarn: 'external/yarn/yarn-index.html',\n  jfxr: 'external/jfxr/jfxr-index.html',\n};\n\nconst openAndWaitForExternalEditorWindow = async (\n  externalEditorWindow: any,\n  editorName: 'piskel' | 'yarn' | 'jfxr',\n  externalEditorInput: ExternalEditorInput\n): Promise<?ExternalEditorOutput> => {\n  return new Promise((resolve, reject) => {\n    let externalEditorLoaded = false;\n    let externalEditorClosed = false;\n    let externalEditorOutput: ?ExternalEditorOutput = null;\n\n    const onMessageEvent = (event: MessageEvent) => {\n      if (event.source !== externalEditorWindow) {\n        return;\n      }\n\n      if (!event.data || typeof event.data !== 'object') {\n        console.warn(\n          'Ignoring malformed message data from the external editor window.'\n        );\n        return;\n      }\n\n      const { id, payload } = event.data;\n      if (id === `external-editor-ready`) {\n        console.info(`External editor \"${editorName}\" ready.`);\n\n        // Some browsers like Safari might not trigger the \"load\" event, but now we can\n        // be sure the editor is loaded: the proof being that we received this message.\n        // Mark the editor as loaded and re-attach a unload listener to be safe.\n        externalEditorLoaded = true;\n        externalEditorWindow.addEventListener('unload', () => {\n          onExternalEditorWindowClosed();\n        });\n\n        // Now that the external editor is loaded and ready, we can ask it to open the resources.\n        externalEditorWindow.postMessage(\n          {\n            id: 'open-external-editor-input',\n            payload: externalEditorInput,\n          },\n          // Ensure only external editors hosted on the same server as the SpeXEngine editor\n          // can receive the message:\n          window.location.origin\n        );\n      } else if (id === `save-external-editor-output`) {\n        console.info(`Received data from external editor \"${editorName}.\"`);\n        // $FlowFixMe - assuming the typing is good.\n        externalEditorOutput = payload;\n      } else if (event.data.id === 'close') {\n        externalEditorWindow.close();\n        onExternalEditorWindowClosed();\n      }\n    };\n    window.addEventListener('message', onMessageEvent);\n\n    const onExternalEditorWindowClosed = () => {\n      if (externalEditorClosed) {\n        // Somehow this editor was already closed.\n        return;\n      }\n      externalEditorClosed = true;\n      console.info(`External editor \"${editorName}\" closed.`);\n      window.removeEventListener('message', onMessageEvent);\n      resolve(externalEditorOutput);\n    };\n\n    externalEditorWindow.addEventListener('load', () => {\n      console.info(`External editor \"${editorName}\" loaded.`);\n      externalEditorLoaded = true;\n\n      externalEditorWindow.addEventListener('unload', () => {\n        onExternalEditorWindowClosed();\n      });\n    });\n\n    // Change the HTML file displayed by the window so that it starts loading\n    // the editor.\n    // The browser will load the editor HTML/CSS/JS, then will fire the `load` event\n    // (though not on Safari), then the editor will send a `external-editor-ready` event\n    // (on all browsers), after which we will then be ready to have it open the resources.\n    // (see `open-external-editor-input`).\n    externalEditorWindow.location = externalEditorIndexHtml[editorName];\n\n    // If the editor is not ready after 10 seconds and not closed, force it to be closed.\n    // Something wrong is going on and we don't want to block the user.\n    setTimeout(() => {\n      if (externalEditorLoaded || externalEditorClosed) return;\n      console.info(\n        `External editor \"${editorName} not loaded after 10 seconds - closing its window.\"`\n      );\n\n      // The external editor is not loaded after 10 seconds, abort.\n      externalEditorWindow.close();\n      onExternalEditorWindowClosed();\n    }, 10000);\n  });\n};\n\n/**\n * Download (or read locally) resources and prepare them to be edited\n * by an external editor.\n */\nexport const downloadAndPrepareExternalEditorBase64Resources = async ({\n  project,\n  resourceNames,\n}: {|\n  project: gdProject,\n  resourceNames: Array<string>,\n|}): Promise<Array<ExternalEditorBase64Resource>> => {\n  type ResourceToDownload = {|\n    resourceName: string,\n    url: string,\n  |};\n\n  const urlsToDownload: Array<ResourceToDownload> = [];\n  const resourcesManager = project.getResourcesManager();\n  resourceNames.forEach(resourceName => {\n    if (!resourcesManager.hasResource(resourceName)) return;\n\n    const resource = resourcesManager.getResource(resourceName);\n    const url = resource.getFile();\n    if (isURL(url)) {\n      if (isBlobURL(url)) {\n        console.error('Unsupported blob URL for a resource - ignoring it.');\n      } else {\n        urlsToDownload.push({\n          url,\n          resourceName,\n        });\n      }\n    } else {\n      console.error('Unsupported local file for a resource - ignoring it.');\n    }\n  });\n\n  const downloadedBlobs: Array<\n    ItemResult<ResourceToDownload>\n  > = await downloadUrlsToBlobs({\n    urlContainers: urlsToDownload,\n    onProgress: (count, total) => {},\n  });\n\n  const resourcesToDataUrl = new Map<\n    string,\n    {|\n      dataUrl: string,\n      localFilePath?: string,\n    |}\n  >();\n  await Promise.all(\n    downloadedBlobs.map(async ({ error, blob, item }) => {\n      if (blob) {\n        try {\n          resourcesToDataUrl.set(item.resourceName, {\n            dataUrl: await convertBlobToDataURL(blob),\n          });\n        } catch (error) {\n          console.error(\n            `Unable to read data from resource \"${\n              item.resourceName\n            }\" - ignoring it.`,\n            error\n          );\n        }\n      }\n    })\n  );\n\n  return resourceNames.map(resourceName => {\n    const resourceData = resourcesToDataUrl.get(resourceName);\n    if (!resourceData)\n      return {\n        name: resourceName,\n        dataUrl: '',\n      };\n\n    const { localFilePath, dataUrl } = resourceData;\n    return {\n      name: resourceName,\n      dataUrl,\n      localFilePath,\n    };\n  });\n};\n\n/**\n * Edit one or more resources with the specified external editor.\n */\nconst editWithBrowserExternalEditor = async ({\n  externalEditorName,\n  externalEditorWindow,\n  defaultName,\n  metadataKey,\n  resourceKind,\n  options,\n}: {|\n  externalEditorName: 'piskel' | 'yarn' | 'jfxr',\n  externalEditorWindow: any,\n  defaultName: string,\n  metadataKey: string,\n  resourceKind: ResourceKind,\n  options: EditWithExternalEditorOptions,\n|}) => {\n  const { project, resourceNames, resourceManagementProps } = options;\n\n  // Fetch all edited resources as base64 encoded \"data urls\" (`data:...`).\n  const resources = await downloadAndPrepareExternalEditorBase64Resources({\n    project,\n    resourceNames,\n  });\n\n  const externalEditorInput: ExternalEditorInput = {\n    singleFrame: options.extraOptions.singleFrame,\n    externalEditorData: readMetadata(\n      metadataKey,\n      options.extraOptions.existingMetadata\n    ),\n    fps: options.extraOptions.fps,\n    isLooping: options.extraOptions.isLooping,\n    name: options.extraOptions.name || resourceNames[0] || defaultName,\n    resources,\n  };\n\n  sendExternalEditorOpened(externalEditorName);\n  const externalEditorOutput: ?ExternalEditorOutput = await openAndWaitForExternalEditorWindow(\n    externalEditorWindow,\n    externalEditorName,\n    externalEditorInput\n  );\n  if (!externalEditorOutput) return null; // Changes cancelled.\n\n  // Save the edited files back to the SpeXEngine resources, as \"blob urls\" (blob:...)\n  // which can then uploaded or saved locally.\n  const modifiedResources = await saveBlobUrlsFromExternalEditorBase64Resources(\n    {\n      baseNameForNewResources: externalEditorOutput.baseNameForNewResources,\n      project,\n      resources: externalEditorOutput.resources,\n      resourceKind,\n    }\n  );\n\n  // Ask the project to persist the resources (\"blob urls\" will be either uploaded\n  // or saved locally).\n  try {\n    await resourceManagementProps.onFetchNewlyAddedResources();\n  } catch (error) {\n    console.error(\n      'An error happened while fetching the newly added resources:',\n      error\n    );\n  }\n\n  // Free the \"blob urls\" so that blobs don't stay in memory! They are only temporarily\n  // useful while waiting for an upload/local file save.\n  freeBlobsAndUpdateMetadata({\n    modifiedResources,\n    metadataKey,\n    metadata: options.extraOptions.singleFrame\n      ? externalEditorOutput.externalEditorData\n      : null,\n  });\n\n  // Some editors (Piskel) need to have resource names persisted.\n  patchExternalEditorMetadataWithResourcesNamesIfNecessary(\n    modifiedResources.map(({ resource }) => resource.getName()),\n    externalEditorOutput.externalEditorData\n  );\n\n  return {\n    resources: modifiedResources.map(({ resource, originalIndex }) => ({\n      name: resource.getName(),\n      originalIndex,\n    })),\n    newName: externalEditorOutput.baseNameForNewResources,\n    newMetadata: { [metadataKey]: externalEditorOutput.externalEditorData },\n  };\n};\n\nconst cloudProjectWarning = t`You need to save this project as a cloud project to install this asset. Please save your project and try again.`;\n\n/**\n * Open a window showing a black \"loading...\" screen. It's important this is done\n * NOT in an asynchronous way but JUST after a click. Otherwise, browsers like Safari\n * will block the window opening.\n */\nconst immediatelyOpenLoadingWindowForExternalEditor = () => {\n  const targetId = 'GDevelopExternalEditor' + nextExternalEditorWindowId++;\n  const width = 800;\n  const height = 600;\n  const left = window.screenX + window.innerWidth / 2 - width / 2;\n  const top = window.screenY + window.innerHeight / 2 - height / 2;\n\n  const externalEditorWindow = window.open(\n    'about:blank',\n    targetId,\n    `width=${width},height=${height},left=${left},top=${top}`\n  );\n  if (!externalEditorWindow) {\n    throw new Error(\n      \"Can't open the external editor because of browser restrictions.\"\n    );\n  }\n\n  displayBlackLoadingScreen(externalEditorWindow);\n\n  return externalEditorWindow;\n};\n\n/**\n * This is the list of editors that can be used to edit resources\n * when running in a browser.\n */\nconst editors: Array<ResourceExternalEditor> = [\n  {\n    name: 'piskel-app',\n    createDisplayName: t`Create with Piskel`,\n    editDisplayName: t`Edit with Piskel`,\n    kind: 'image',\n    edit: async options => {\n      if (options.getStorageProvider().internalName !== 'Cloud') {\n        const { i18n } = options;\n        showWarningBox(i18n._(cloudProjectWarning), {\n          delayToNextTick: true,\n        });\n        return null;\n      }\n\n      const externalEditorWindow = immediatelyOpenLoadingWindowForExternalEditor();\n      return await editWithBrowserExternalEditor({\n        options,\n        externalEditorWindow,\n        externalEditorName: 'piskel',\n        defaultName: 'New image',\n        metadataKey: 'pskl',\n        resourceKind: 'image',\n      });\n    },\n  },\n  {\n    name: 'jfxr-app',\n    createDisplayName: t`Create with Jfxr`,\n    editDisplayName: t`Edit with Jfxr`,\n    kind: 'audio',\n    edit: async options => {\n      if (options.getStorageProvider().internalName !== 'Cloud') {\n        const { i18n } = options;\n        showWarningBox(i18n._(cloudProjectWarning), {\n          delayToNextTick: true,\n        });\n        return null;\n      }\n\n      const externalEditorWindow = immediatelyOpenLoadingWindowForExternalEditor();\n      return await editWithBrowserExternalEditor({\n        options,\n        externalEditorWindow,\n        externalEditorName: 'jfxr',\n        defaultName: 'New sound effect',\n        metadataKey: 'jfxr',\n        resourceKind: 'audio',\n      });\n    },\n  },\n  {\n    name: 'yarn-app',\n    createDisplayName: t`Create with Yarn`,\n    editDisplayName: t`Edit with Yarn`,\n    kind: 'json',\n    edit: async options => {\n      if (options.getStorageProvider().internalName !== 'Cloud') {\n        const { i18n } = options;\n        showWarningBox(i18n._(cloudProjectWarning), {\n          delayToNextTick: true,\n        });\n        return null;\n      }\n\n      const externalEditorWindow = immediatelyOpenLoadingWindowForExternalEditor();\n      return await editWithBrowserExternalEditor({\n        options,\n        externalEditorWindow,\n        externalEditorName: 'yarn',\n        defaultName: 'New dialogue tree',\n        metadataKey: 'yarn',\n        resourceKind: 'json',\n      });\n    },\n  },\n];\n\nexport default editors;\n","// @flow\nimport { Trans } from '@lingui/macro';\nimport { I18n } from '@lingui/react';\nimport React, { Component } from 'react';\nimport Dialog from '../../../UI/Dialog';\nimport FlatButton from '../../../UI/FlatButton';\nimport { Column, Line } from '../../../UI/Grid';\nimport Text from '../../../UI/Text';\n\ntype Props = {|\n  error: Error,\n  onClose: () => void,\n|};\n\nexport default class BrowserPreviewErrorDialog extends Component<Props> {\n  render() {\n    const { error, onClose } = this.props;\n\n    return (\n      <I18n>\n        {({ i18n }) => (\n          <Dialog\n            title={<Trans>Could not launch the preview</Trans>}\n            actions={[\n              <FlatButton\n                key=\"close\"\n                label={<Trans>Close</Trans>}\n                onClick={onClose}\n              />,\n            ]}\n            onRequestClose={onClose}\n            open\n          >\n            <Line>\n              <Column noMargin>\n                <Text>\n                  {// $FlowFixMe - AWS returned errors can have extra fields\n                  error.code === 'NetworkingError' ? (\n                    <Trans>\n                      The preview could not be launched because you're offline.\n                    </Trans>\n                  ) : (\n                    <Trans>\n                      The preview could not be launched because an error\n                      happened: {error.message}.\n                    </Trans>\n                  )}\n                </Text>\n              </Column>\n            </Line>\n            <Line>\n              <Column noMargin>\n                <Text>\n                  <Trans>\n                    Make sure you're online, have a proper internet connection\n                    and try again. If you download and use SpeXEngine desktop\n                    application, you can also run previews without any internet\n                    connection.\n                  </Trans>\n                </Text>\n              </Column>\n            </Line>\n          </Dialog>\n        )}\n      </I18n>\n    );\n  }\n}\n","// @flow\nimport axios from 'axios';\nimport { GDevelopGamePreviews } from './ApiConfigs';\nimport { getSignedUrl } from './Usage';\n\nexport type UploadedObject = {|\n  Key: string,\n  Body: string,\n  ContentType: 'text/javascript' | 'text/html',\n|};\n\nexport const uploadObject = (params: UploadedObject): Promise<any> => {\n  return getSignedUrl({\n    uploadType: 'preview',\n    key: params.Key,\n    contentType: params.ContentType,\n  }).then(({ signedUrl }) =>\n    axios.put(signedUrl, params.Body, {\n      headers: {\n        'Content-Type': params.ContentType,\n      },\n    })\n  );\n};\n\nexport const getBaseUrl = () => {\n  return GDevelopGamePreviews.baseUrl;\n};\n","// @flow\nimport path from 'path-browserify';\nimport { uploadObject } from '../../Utils/GDevelopServices/Preview';\nconst gd: libGDevelop = global.gd;\n\nexport type TextFileDescriptor = {|\n  filePath: string,\n  text: string,\n|};\n\ntype PendingUploadFileDescriptor = {|\n  Key: string,\n  Body: string,\n  ContentType: 'text/javascript' | 'text/html',\n|};\n\ntype ConstructorArgs = {|\n  filesContent: Array<TextFileDescriptor>,\n  prefix: string,\n  bucketBaseUrl: string,\n|};\n\nconst isURL = (filename: string) => {\n  return (\n    filename.startsWith('http://') ||\n    filename.startsWith('https://') ||\n    filename.startsWith('ftp://') ||\n    filename.startsWith('blob:') ||\n    filename.startsWith('data:')\n  );\n};\n\n/**\n * An in-memory \"file system\" that can be used for SpeXEngine previews.\n */\nexport default class BrowserS3FileSystem {\n  prefix: string;\n  bucketBaseUrl: string;\n\n  // Store the content of some files.\n  _indexedFilesContent: { [string]: TextFileDescriptor };\n\n  // Store all the objects that should be written on the S3 bucket.\n  // Call uploadPendingObjects to send them\n  _pendingUploadObjects: Array<PendingUploadFileDescriptor> = [];\n\n  // Store a set of all external URLs copied so that we can simulate\n  // readDir result.\n  _allCopiedExternalUrls = new Set<string>();\n\n  constructor({ filesContent, prefix, bucketBaseUrl }: ConstructorArgs) {\n    this.prefix = prefix;\n    this.bucketBaseUrl = bucketBaseUrl;\n\n    this._indexedFilesContent = {};\n    filesContent.forEach(textFileDescriptor => {\n      this._indexedFilesContent[\n        textFileDescriptor.filePath\n      ] = textFileDescriptor;\n    });\n  }\n\n  uploadPendingObjects = () => {\n    return Promise.all(this._pendingUploadObjects.map(uploadObject)).then(\n      result => {\n        console.log('Uploaded all objects:', result);\n        this._pendingUploadObjects = [];\n      },\n      error => {\n        console.error(\"Can't upload all objects:\", error);\n        throw error;\n      }\n    );\n  };\n\n  mkDir = (path: string) => {\n    // Assume required directories always exist.\n  };\n  dirExists = (path: string) => {\n    // Assume required directories always exist.\n    return true;\n  };\n  clearDir = (path: string) => {\n    // Assume path is cleared.\n  };\n  getTempDir = () => {\n    return '/virtual-unused-tmp-dir';\n  };\n  fileNameFrom = (fullpath: string) => {\n    if (isURL(fullpath)) return fullpath;\n\n    return path.basename(fullpath);\n  };\n  dirNameFrom = (fullpath: string) => {\n    if (isURL(fullpath)) return '';\n\n    return path.dirname(fullpath);\n  };\n  makeAbsolute = (filename: string, baseDirectory: string) => {\n    if (isURL(filename)) return filename;\n\n    if (!this.isAbsolute(baseDirectory))\n      baseDirectory = path.resolve(baseDirectory);\n\n    return path.resolve(baseDirectory, path.normalize(filename));\n  };\n  makeRelative = (filename: string, baseDirectory: string) => {\n    if (isURL(filename)) return filename;\n\n    return path.relative(baseDirectory, path.normalize(filename));\n  };\n  isAbsolute = (fullpath: string) => {\n    if (isURL(fullpath)) return true;\n\n    if (fullpath.length === 0) return true;\n    return (\n      (fullpath.length > 0 && fullpath.charAt(0) === '/') ||\n      (fullpath.length > 1 && fullpath.charAt(1) === ':')\n    );\n  };\n  copyFile = (source: string, dest: string) => {\n    //URL are not copied.\n    if (isURL(source)) {\n      this._allCopiedExternalUrls.add(source);\n      return true;\n    }\n\n    console.warn('Copy not done from', source, 'to', dest);\n    return true;\n  };\n  writeToFile = (fullPath: string, contents: string) => {\n    const key = fullPath.replace(this.bucketBaseUrl, '');\n    const mime = {\n      '.js': 'text/javascript',\n      '.html': 'text/html',\n    };\n    const fileExtension = path.extname(fullPath);\n\n    // Defer real upload until it's triggered by calling\n    // uploadPendingObjects.\n    this._pendingUploadObjects.push({\n      Key: key,\n      Body: contents,\n      ContentType: mime[fileExtension],\n    });\n    return true;\n  };\n\n  readFile = (file: string) => {\n    if (!!this._indexedFilesContent[file])\n      return this._indexedFilesContent[file].text;\n\n    console.error(`Unknown file ${file}, returning an empty string`);\n    return '';\n  };\n\n  readDir = (path: string, ext: string) => {\n    ext = ext.toUpperCase();\n    var output = new gd.VectorString();\n\n    // Simulate ReadDir by returning all external URLs\n    // with the filename matching the extension.\n    this._allCopiedExternalUrls.forEach(url => {\n      const upperCaseUrl = url.toUpperCase();\n      if (upperCaseUrl.indexOf(ext) === upperCaseUrl.length - ext.length) {\n        output.push_back(url);\n      }\n    });\n\n    return output;\n  };\n\n  fileExists = (filename: string) => {\n    if (isURL(filename)) return true;\n\n    // Assume all files asked for exists.\n    return true;\n  };\n}\n","// @flow\nimport { getIDEVersion } from '../Version';\n\ntype FileSet =\n  | 'preview'\n  | 'cordova'\n  | 'electron'\n  | 'web'\n  | 'cocos2d-js'\n  | 'facebook-instant-games';\n\nconst filesToDownload: { [FileSet]: Array<string> } = {\n  preview: ['/Runtime/index.html'],\n  web: ['/Runtime/index.html'],\n  'cocos2d-js': [\n    '/Runtime/Cocos2d/cocos2d-js-v3.10.js',\n    '/Runtime/Cocos2d/index.html',\n    '/Runtime/Cocos2d/main.js',\n    '/Runtime/Cocos2d/project.json',\n  ],\n  'facebook-instant-games': [\n    '/Runtime/FacebookInstantGames/fbapp-config.json',\n    '/Runtime/FacebookInstantGames/index.html',\n  ],\n  cordova: [\n    '/Runtime/Cordova/www/index.html',\n    '/Runtime/Cordova/config.xml',\n    '/Runtime/Cordova/package.json',\n  ],\n  electron: [\n    '/Runtime/index.html',\n    '/Runtime/Electron/main.js',\n    '/Runtime/Electron/package.json',\n  ],\n};\n\nexport type TextFileDescriptor = {| text: string, filePath: string |};\n\nexport const findGDJS = (\n  fileSet: FileSet\n): Promise<{|\n  gdjsRoot: string,\n  filesContent: Array<TextFileDescriptor>,\n|}> => {\n  // Get GDJS for this version. If you updated the version,\n  // run `newIDE/web-app/scripts/deploy-GDJS-Runtime` script.\n  let gdjsRoot = `https://resources.gdevelop-app.com/GDJS-${getIDEVersion()}`;\n\n  // If you want to test your local changes to the game engine on the local web-app,\n  // run `npx serve --cors` (or another CORS enabled http server on port 5000)\n  // in `newIDE/app/resources/GDJS` and uncomment this line:\n  // gdjsRoot = `http://localhost:5000`;\n\n  return Promise.all(\n    filesToDownload[fileSet].map(relativeFilePath => {\n      const url = gdjsRoot + relativeFilePath;\n\n      // Don't do any caching, rely on the browser cache only.\n      return fetch(url).then(response => {\n        if (!response.ok) {\n          console.error(`Error while downloading \"${url}\"`, response);\n          throw new Error(\n            `Error while downloading \"${url}\" (status: ${response.status})`\n          );\n        }\n        return response.text().then(text => ({\n          filePath: url,\n          text,\n        }));\n      });\n    })\n  ).then(filesContent => {\n    return {\n      gdjsRoot,\n      filesContent,\n    };\n  });\n};\n","// @flow\nimport {\n  type PreviewDebuggerServerCallbacks,\n  type PreviewDebuggerServer,\n  type DebuggerId,\n} from '../../PreviewLauncher.flow';\n\nlet debuggerServerState: 'started' | 'stopped' = 'stopped';\nconst callbacksList: Array<PreviewDebuggerServerCallbacks> = [];\n\nlet nextDebuggerId = 0;\n\nconst existingPreviewWindows: {\n  [DebuggerId]: WindowProxy,\n} = {};\n\nconst getExistingDebuggerIds = () =>\n  Object.keys(existingPreviewWindows).map(key => Number(key));\n\nconst getDebuggerIdForPreviewWindow = (previewWindow: any) => {\n  for (const key in existingPreviewWindows) {\n    const id = Number(key);\n    if (existingPreviewWindows[id] === previewWindow) {\n      return id;\n    }\n  }\n  return null;\n};\n\nlet windowClosedPollingIntervalId = null;\n\n/**\n * Listen to window closing so that we can notify the debuggers\n * when a preview window is closed.\n * Polling seems the only option to do so.\n */\nconst setupWindowClosedPolling = () => {\n  if (windowClosedPollingIntervalId !== null) return;\n\n  windowClosedPollingIntervalId = setInterval(() => {\n    for (const key in existingPreviewWindows) {\n      const id = Number(key);\n      const previewWindow = existingPreviewWindows[id];\n      if (previewWindow.closed) {\n        console.info('A preview window was closed, with debugger id:', id);\n        delete existingPreviewWindows[id];\n        callbacksList.forEach(({ onConnectionClosed }) =>\n          onConnectionClosed({\n            id,\n            debuggerIds: getExistingDebuggerIds(),\n          })\n        );\n        if (!Object.keys(existingPreviewWindows).length) {\n          clearInterval(windowClosedPollingIntervalId);\n          windowClosedPollingIntervalId = null;\n        }\n      }\n    }\n  }, 1000);\n};\n\nconst PREVIEWS_ORIGIN = 'https://game-previews.gdevelop.io';\n\n/**\n * A debugger server implemented using the ability to send/receive messages\n * from popup windows in the browser.\n */\nexport const browserPreviewDebuggerServer: PreviewDebuggerServer = {\n  startServer: async () => {\n    if (debuggerServerState === 'started') return;\n    debuggerServerState = 'started';\n\n    window.addEventListener('message', event => {\n      if (event.origin !== PREVIEWS_ORIGIN) return;\n\n      const id = getDebuggerIdForPreviewWindow(event.source);\n      if (id === null) return; // Could not find the id of this preview window.\n\n      try {\n        const parsedMessage = JSON.parse(event.data);\n        callbacksList.forEach(({ onHandleParsedMessage }) =>\n          onHandleParsedMessage({ id, parsedMessage })\n        );\n      } catch (error) {\n        console.error(\n          'Error while parsing messages coming from a preview:',\n          error\n        );\n      }\n    });\n\n    setupWindowClosedPolling();\n\n    callbacksList.forEach(({ onServerStateChanged }) => onServerStateChanged());\n  },\n  sendMessage: (id: DebuggerId, message: Object) => {\n    const previewWindow = existingPreviewWindows[id];\n    if (!previewWindow) return;\n\n    try {\n      previewWindow.postMessage(message, PREVIEWS_ORIGIN);\n    } catch (error) {\n      console.error('Unable to send a message to the preview window:', error);\n    }\n  },\n  getServerState: () => debuggerServerState,\n  getExistingDebuggerIds,\n  registerCallbacks: (callbacks: PreviewDebuggerServerCallbacks) => {\n    callbacksList.push(callbacks);\n\n    return () => {\n      const callbacksIndex = callbacksList.indexOf(callbacks);\n      if (callbacksIndex !== -1) callbacksList.splice(callbacksIndex, 1);\n    };\n  },\n};\n\nexport const registerNewPreviewWindow = (previewWindow: WindowProxy) => {\n  // Associate this window with a new debugger id.\n  const id = nextDebuggerId++;\n  existingPreviewWindows[id] = previewWindow;\n\n  setupWindowClosedPolling();\n\n  // Notify the debuggers that a new preview was opened.\n  callbacksList.forEach(({ onConnectionOpened }) =>\n    onConnectionOpened({\n      id,\n      debuggerIds: getExistingDebuggerIds(),\n    })\n  );\n};\n\nexport const getExistingPreviewWindowForDebuggerId = (\n  id: ?DebuggerId\n): ?WindowProxy => {\n  if (id == null) return null;\n\n  return existingPreviewWindows[id] || null;\n};\n","// @flow\nimport * as React from 'react';\nimport BrowserPreviewErrorDialog from './BrowserPreviewErrorDialog';\nimport BrowserS3FileSystem from '../BrowserS3FileSystem';\nimport { findGDJS } from '../../../GameEngineFinder/BrowserS3GDJSFinder';\nimport assignIn from 'lodash/assignIn';\nimport { type PreviewOptions } from '../../PreviewLauncher.flow';\nimport { getBaseUrl } from '../../../Utils/GDevelopServices/Preview';\nimport { makeTimestampedId } from '../../../Utils/TimestampedId';\nimport {\n  browserPreviewDebuggerServer,\n  getExistingPreviewWindowForDebuggerId,\n  registerNewPreviewWindow,\n} from './BrowserPreviewDebuggerServer';\nimport Window from '../../../Utils/Window';\nimport { displayBlackLoadingScreen } from '../../../Utils/BrowserExternalWindowUtils';\nimport { getGDevelopResourceJwtToken } from '../../../Utils/GDevelopServices/Project';\nconst gd: libGDevelop = global.gd;\n\ntype State = {|\n  error: ?Error,\n|};\n\ntype Props = {|\n  getIncludeFileHashs: () => { [string]: number },\n  onExport?: () => void,\n|};\n\nlet nextPreviewWindowId = 0;\n\n/**\n * Open a window showing a black \"loading...\" screen. It's important this is done\n * NOT in an asynchronous way but JUST after a click. Otherwise, browsers like Safari\n * will block the window opening.\n */\nexport const immediatelyOpenNewPreviewWindow = (\n  project: gdProject\n): WindowProxy => {\n  const width = project.getGameResolutionWidth();\n  const height = project.getGameResolutionHeight();\n  const left = window.screenX + window.innerWidth / 2 - width / 2;\n  const top = window.screenY + window.innerHeight / 2 - height / 2;\n\n  const targetId = 'GDevelopPreview' + nextPreviewWindowId++;\n  const previewWindow = window.open(\n    'about:blank',\n    targetId,\n    `width=${width},height=${height},left=${left},top=${top}`\n  );\n\n  displayBlackLoadingScreen(previewWindow);\n\n  return previewWindow;\n};\n\nexport default class BrowserS3PreviewLauncher extends React.Component<\n  Props,\n  State\n> {\n  canDoNetworkPreview = () => false;\n  canDoHotReload = () => false;\n\n  state = {\n    error: null,\n  };\n\n  _prepareExporter = (): Promise<{|\n    outputDir: string,\n    exporter: gdjsExporter,\n    browserS3FileSystem: BrowserS3FileSystem,\n  |}> => {\n    return findGDJS('preview').then(({ gdjsRoot, filesContent }) => {\n      console.info('GDJS found in ', gdjsRoot);\n\n      const prefix = makeTimestampedId();\n\n      const outputDir = getBaseUrl() + prefix;\n      const browserS3FileSystem = new BrowserS3FileSystem({\n        filesContent,\n        bucketBaseUrl: getBaseUrl(),\n        prefix,\n      });\n      const fileSystem = assignIn(\n        new gd.AbstractFileSystemJS(),\n        browserS3FileSystem\n      );\n      const exporter = new gd.Exporter(fileSystem, gdjsRoot);\n      exporter.setCodeOutputDirectory(outputDir);\n\n      return {\n        exporter,\n        outputDir,\n        browserS3FileSystem,\n      };\n    });\n  };\n\n  launchPreview = async (previewOptions: PreviewOptions): Promise<any> => {\n    const { project, layout, externalLayout } = previewOptions;\n    this.setState({\n      error: null,\n    });\n\n    const debuggerIds = this.getPreviewDebuggerServer().getExistingDebuggerIds();\n    const lastDebuggerId = debuggerIds.length\n      ? debuggerIds[debuggerIds.length - 1]\n      : null;\n    const shouldHotReload = previewOptions.hotReload && lastDebuggerId !== null;\n\n    // We abuse the \"hot reload\" to choose if we open a new window or replace\n    // the content of an existing one. But hot reload is NOT implemented (yet -\n    // it would need to generate the preview in the same place and trigger a reload\n    // of the scripts).\n    const existingPreviewWindow = shouldHotReload\n      ? getExistingPreviewWindowForDebuggerId(lastDebuggerId)\n      : null;\n\n    const previewWindow =\n      existingPreviewWindow || immediatelyOpenNewPreviewWindow(project);\n\n    try {\n      await this.getPreviewDebuggerServer().startServer();\n    } catch (err) {\n      // Ignore any error when running the debugger server - the preview\n      // can still work without it.\n      console.error(\n        'Unable to start the Debugger Server for the preview:',\n        err\n      );\n    }\n\n    try {\n      const {\n        exporter,\n        outputDir,\n        browserS3FileSystem,\n      } = await this._prepareExporter();\n\n      const previewExportOptions = new gd.PreviewExportOptions(\n        project,\n        outputDir\n      );\n      previewExportOptions.setLayoutName(layout.getName());\n      previewExportOptions.setIsDevelopmentEnvironment(Window.isDev());\n      if (externalLayout) {\n        previewExportOptions.setExternalLayoutName(externalLayout.getName());\n      }\n\n      previewExportOptions.useWindowMessageDebuggerClient();\n\n      // Scripts generated from extensions keep the same URL even after being modified.\n      // Use a cache bursting parameter to force the browser to reload them.\n      previewExportOptions.setNonRuntimeScriptsCacheBurst(Date.now());\n\n      previewExportOptions.setFullLoadingScreen(\n        previewOptions.fullLoadingScreen\n      );\n\n      if (previewOptions.fallbackAuthor) {\n        previewExportOptions.setFallbackAuthor(\n          previewOptions.fallbackAuthor.id,\n          previewOptions.fallbackAuthor.username\n        );\n      }\n\n      // The token, if any, to be used to read resources on SpeXEngine Cloud buckets.\n      const gdevelopResourceToken = getGDevelopResourceJwtToken();\n      if (gdevelopResourceToken)\n        previewExportOptions.setGDevelopResourceToken(gdevelopResourceToken);\n\n      exporter.exportProjectForPixiPreview(previewExportOptions);\n      previewExportOptions.delete();\n      exporter.delete();\n\n      // Upload any file that must be exported for the preview.\n      await browserS3FileSystem.uploadPendingObjects();\n\n      // Change the HTML file displayed by the preview window so that it starts loading\n      // the game.\n      previewWindow.location = outputDir + '/index.html';\n\n      // If the preview window is a new one, register it so that it can be accessed\n      // by the debugger.\n      if (!existingPreviewWindow) {\n        registerNewPreviewWindow(previewWindow);\n      }\n    } catch (error) {\n      this.setState({\n        error,\n      });\n    }\n  };\n\n  getPreviewDebuggerServer() {\n    return browserPreviewDebuggerServer;\n  }\n\n  render() {\n    const { error } = this.state;\n\n    if (error) {\n      return (\n        <BrowserPreviewErrorDialog\n          error={error}\n          onClose={() =>\n            this.setState({\n              error: null,\n            })\n          }\n        />\n      );\n    }\n\n    return null;\n  }\n}\n","// @flow\nimport axios from 'axios';\n\ntype UploadOptions = {\n  signedUrl: string,\n  contentType: string,\n};\n\nexport const uploadBlobFile = (\n  blob: Blob,\n  uploadOptions: UploadOptions,\n  onProgress: (progress: number, total: number) => void\n): Promise<void> => {\n  return axios\n    .put(uploadOptions.signedUrl, blob, {\n      headers: {\n        'Content-Type': uploadOptions.contentType,\n      },\n      // Allow any arbitrary large file to be sent\n      maxContentLength: Infinity,\n      onUploadProgress: progressEvent => {\n        if (!progressEvent || !progressEvent.total) {\n          onProgress(0, 0);\n          return;\n        }\n\n        onProgress(progressEvent.loaded, progressEvent.total);\n      },\n    })\n    .then(() => undefined);\n};\n","// @flow\nimport path from 'path-browserify';\nconst gd: libGDevelop = global.gd;\n\nexport type BlobFileDescriptor = {|\n  filePath: string,\n  blob: Blob,\n|};\n\nexport type TextFileDescriptor = {|\n  filePath: string,\n  text: string,\n|};\n\nexport type UrlFileDescriptor = {|\n  filePath: string,\n  url: string,\n|};\n\ntype ConstructorArgs = {|\n  textFiles: Array<TextFileDescriptor>,\n|};\n\nconst isURL = (filename: string) => {\n  return (\n    filename.startsWith('http://') ||\n    filename.startsWith('https://') ||\n    filename.startsWith('ftp://') ||\n    filename.startsWith('blob:') ||\n    filename.startsWith('data:')\n  );\n};\n\n// For some reason, `path.posix` is undefined when packaged\n// with webpack, so we're using `path` directly. As it's for the web-app,\n// it should always be the posix version. In tests on Windows,\n// it's necessary to use path.posix.\n// Search for \"pathPosix\" in the codebase for other places where this is used.\nconst pathPosix = path.posix || path;\n\n// TODO: Merge BrowserS3FileSystem into this? The way URLs are handled\n// is different though (BrowserS3FileSystem is not downloading anything\n// from URLs, while this file system does download files).\n\n/**\n * An in-memory \"file system\" that can be used for SpeXEngine exports.\n */\nexport default class BrowserFileSystem {\n  // The representation of the \"file system\":\n\n  /**\n   * Store all the text files (filepath => content)\n   * @private\n   */\n  _textFiles: { [string]: string } = {};\n\n  /**\n   * Store all the files that should be downloaded (filepath => url)\n   * @private\n   */\n  _filesToDownload: { [string]: string } = {};\n\n  /**\n   * Create a new in-memory file system.\n   */\n  constructor({ textFiles }: ConstructorArgs) {\n    textFiles.forEach(textFileDescriptor => {\n      this._textFiles[textFileDescriptor.filePath] = textFileDescriptor.text;\n    });\n  }\n\n  /**\n   * Returns all the in memory text files with the specified path prefix.\n   */\n  getAllTextFilesIn = (pathPrefix: string): Array<TextFileDescriptor> => {\n    return Object.keys(this._textFiles)\n      .filter(filePath => filePath.indexOf(pathPrefix) === 0)\n      .map(filePath => ({\n        filePath,\n        text: this._textFiles[filePath],\n      }));\n  };\n\n  /**\n   * Returns all the files that should be downloaded from a URL, with the specified destination path prefix.\n   */\n  getAllUrlFilesIn = (pathPrefix: string): Array<UrlFileDescriptor> => {\n    return Object.keys(this._filesToDownload)\n      .filter(filePath => filePath.indexOf(pathPrefix) === 0)\n      .map(filePath => ({\n        filePath,\n        url: this._filesToDownload[filePath],\n      }));\n  };\n\n  mkDir = (path: string) => {\n    // \"Directories\" are assumed to exist.\n    return true;\n  };\n  dirExists = (path: string) => {\n    // TODO: To be changed to be EnsureDirExists.\n    // \"Directories\" are assumed to exist.\n    return true;\n  };\n  clearDir = (path: string) => {\n    // Clear the files to be written in the specified directory.\n    const filePaths = Object.keys(this._textFiles);\n    filePaths.forEach(filePath => {\n      if (filePath.indexOf(path) === 0) {\n        delete this._textFiles[filePath];\n      }\n    });\n\n    return true;\n  };\n  getTempDir = () => {\n    return '/browser-file-system-tmp-dir';\n  };\n  fileNameFrom = (fullpath: string) => {\n    return pathPosix.basename(fullpath);\n  };\n  dirNameFrom = (fullpath: string) => {\n    return pathPosix.dirname(fullpath);\n  };\n  makeAbsolute = (filePathOrURL: string, baseDirectoryOrURL: string) => {\n    // URLs are always absolute\n    if (isURL(filePathOrURL)) return filePathOrURL;\n\n    if (!this.isAbsolute(baseDirectoryOrURL))\n      baseDirectoryOrURL = pathPosix.resolve(baseDirectoryOrURL);\n\n    return pathPosix.resolve(\n      baseDirectoryOrURL,\n      pathPosix.normalize(filePathOrURL)\n    );\n  };\n  makeRelative = (filePathOrURL: string, baseDirectoryOrURL: string) => {\n    if (isURL(filePathOrURL)) {\n      // Cutting the start if the URL is relative to the base URL\n      if (filePathOrURL.indexOf(baseDirectoryOrURL) === 0) {\n        return filePathOrURL.substring(baseDirectoryOrURL.length);\n      }\n\n      // Keep the URL \"absolute\" if on different domains.\n      console.warn(\n        `${filePathOrURL} cannot be made relative to ${baseDirectoryOrURL}, please double check this behavior is correct.`\n      );\n      return filePathOrURL;\n    }\n\n    // Paths are treated as usual paths.\n    return pathPosix.relative(\n      baseDirectoryOrURL,\n      pathPosix.normalize(filePathOrURL)\n    );\n  };\n  isAbsolute = (fullpath: string) => {\n    // URLs are always absolute\n    if (isURL(fullpath)) return true;\n\n    // Paths are absolute if starting from the root\n    return fullpath.length > 0 && fullpath.charAt(0) === '/';\n  };\n\n  copyFile = (source: string, dest: string) => {\n    // URLs are not copied, but marked as to be downloaded.\n    if (isURL(source)) {\n      if (isURL(dest)) {\n        console.error(\n          `Destination can't be a URL in copyFile (from ${source} to ${dest}).`\n        );\n        return false;\n      }\n\n      this._filesToDownload[pathPosix.normalize(dest)] = source;\n      return true;\n    }\n\n    // If this is a file that we have already in memory,\n    // copy its path.\n    if (!!this._textFiles[source]) {\n      this._textFiles[pathPosix.normalize(dest)] = this._textFiles[source];\n      return true;\n    }\n\n    console.error(`File not found in copyFile (from ${source} to ${dest}).`);\n    return false;\n  };\n\n  writeToFile = (filePath: string, content: string) => {\n    this._textFiles[pathPosix.normalize(filePath)] = content;\n    return true;\n  };\n\n  readFile = (file: string): string => {\n    if (this._textFiles[file]) return this._textFiles[file];\n\n    console.error(`Unknown file ${file}, returning an empty string`);\n    return '';\n  };\n\n  readDir = (path: string, ext: string) => {\n    ext = ext.toUpperCase();\n    var output = new gd.VectorString();\n\n    // Simulate ReadDir by returning all external URLs\n    // with the filename matching the extension.\n    Object.keys(this._filesToDownload).forEach(filePath => {\n      const upperCaseFilePath = filePath.toUpperCase();\n      if (\n        upperCaseFilePath.indexOf(ext) ===\n        upperCaseFilePath.length - ext.length\n      ) {\n        output.push_back(filePath);\n      }\n    });\n\n    return output;\n  };\n\n  fileExists = (filePath: string) => {\n    if (isURL(filePath)) return true;\n\n    const normalizedFilePath = pathPosix.normalize(filePath);\n    return (\n      !!this._textFiles[normalizedFilePath] ||\n      !!this._filesToDownload[normalizedFilePath]\n    );\n  };\n}\n","// @flow\nimport { initializeZipJs } from './Zip.js';\nimport { downloadUrlsToBlobs, type ItemResult } from './BlobDownloader';\nimport path from 'path-browserify';\nimport { shortenString } from './StringHelpers.js';\n\nexport type BlobFileDescriptor = {|\n  filePath: string,\n  blob: Blob,\n|};\n\nexport type TextFileDescriptor = {|\n  filePath: string,\n  text: string,\n|};\n\nexport type UrlFileDescriptor = {|\n  filePath: string,\n  url: string,\n|};\n\nfunction eachCallback<T>(\n  array: Array<T>,\n  callback: (T, () => void) => void,\n  done: () => void\n) {\n  if (!array.length) {\n    done();\n    return;\n  }\n  let index = 0;\n\n  const callNextCallback = () => {\n    callback(array[index], () => {\n      index++;\n      if (index >= array.length) {\n        done();\n      } else {\n        callNextCallback();\n      }\n    });\n  };\n\n  callNextCallback();\n}\n\nexport const downloadUrlFilesToBlobFiles = async ({\n  urlFiles,\n  onProgress,\n}: {|\n  urlFiles: Array<UrlFileDescriptor>,\n  onProgress: (count: number, total: number) => void,\n|}): Promise<Array<BlobFileDescriptor>> => {\n  const downloadedBlobs: Array<\n    ItemResult<UrlFileDescriptor>\n  > = await downloadUrlsToBlobs({\n    urlContainers: urlFiles.filter(({ url }) => url.indexOf('.h') === -1), // Should be useless now, still keep it by safety.\n    onProgress,\n  });\n\n  const erroredUrls = downloadedBlobs.filter(downloadedBlob => {\n    return !!downloadedBlob.error || !downloadedBlob.blob;\n  });\n  if (erroredUrls.length) {\n    const errorMessages = erroredUrls\n      .map(({ error }) =>\n        error ? error.message : 'Unknown error during download.'\n      )\n      .filter(Boolean)\n      .join(',\\n');\n\n    throw new Error(\n      `Could not download ${erroredUrls.length} files:\\n ${shortenString(\n        errorMessages,\n        300\n      )}`\n    );\n  }\n\n  return downloadedBlobs.map(({ item, blob }) => {\n    return {\n      // $FlowFixMe - any non existing blob is discarded before.\n      blob,\n      filePath: item.filePath,\n    };\n  });\n};\n\n/**\n * Archive the specified blobs and texts into a zip file,\n * returned as a blob.\n */\nexport const archiveFiles = async ({\n  textFiles,\n  blobFiles,\n  basePath,\n  onProgress,\n  sizeLimit,\n}: {|\n  textFiles: Array<TextFileDescriptor>,\n  blobFiles: Array<BlobFileDescriptor>,\n  basePath: string,\n  onProgress: (count: number, total: number) => void,\n  sizeLimit?: number,\n|}): Promise<Blob> => {\n  const zipJs: ZipJs = await initializeZipJs();\n\n  let zippedFilesCount = 0;\n  let totalFilesCount = blobFiles.length + textFiles.length;\n\n  return new Promise((resolve, reject) => {\n    zipJs.createWriter(\n      new zipJs.BlobWriter('application/zip'),\n      function(zipWriter) {\n        eachCallback(\n          blobFiles,\n          ({ filePath, blob }, done) => {\n            // All files in a zip are relative\n            const relativeFilePath = path.relative(basePath, filePath);\n\n            zipWriter.add(\n              relativeFilePath,\n              new zipJs.BlobReader(blob),\n              () => {\n                zippedFilesCount++;\n                onProgress(zippedFilesCount, totalFilesCount);\n                done();\n              },\n              () => {\n                /* We don't track progress at the file level */\n              }\n            );\n          },\n          () => {\n            eachCallback(\n              textFiles,\n              ({ filePath, text }, done) => {\n                // All files in a zip are relative\n                const relativeFilePath = path.relative(basePath, filePath);\n\n                zipWriter.add(\n                  relativeFilePath,\n                  new zipJs.TextReader(text),\n                  () => {\n                    zippedFilesCount++;\n                    onProgress(zippedFilesCount, totalFilesCount);\n                    done();\n                  },\n                  () => {\n                    /* We don't track progress at the file level */\n                  }\n                );\n              },\n              () => {\n                zipWriter.close((blob: Blob) => {\n                  const fileSize = blob.size;\n                  if (sizeLimit && fileSize > sizeLimit) {\n                    const roundFileSizeInMb = Math.round(\n                      fileSize / (1000 * 1000)\n                    );\n                    reject(\n                      new Error(\n                        `Archive is of size ${roundFileSizeInMb} MB, which is above the limit allowed of ${sizeLimit /\n                          (1000 * 1000)} MB.`\n                      )\n                    );\n                  }\n                  resolve(blob);\n                });\n              }\n            );\n          }\n        );\n      },\n      error => {\n        console.error('Error while making zip:', error);\n        reject(error);\n      }\n    );\n  });\n};\n","// @flow\nimport * as React from 'react';\nimport { Trans } from '@lingui/macro';\nimport assignIn from 'lodash/assignIn';\nimport {\n  type Build,\n  buildCordovaAndroid,\n  getBuildFileUploadOptions,\n} from '../../Utils/GDevelopServices/Build';\nimport { uploadBlobFile } from './BrowserFileUploader';\nimport { type AuthenticatedUser } from '../../Profile/AuthenticatedUserContext';\nimport { findGDJS } from '../../GameEngineFinder/BrowserS3GDJSFinder';\nimport BrowserFileSystem from './BrowserFileSystem';\nimport {\n  type UrlFileDescriptor,\n  type TextFileDescriptor,\n  type BlobFileDescriptor,\n  downloadUrlFilesToBlobFiles,\n  archiveFiles,\n} from '../../Utils/BrowserArchiver';\nimport {\n  type ExportPipeline,\n  type ExportPipelineContext,\n} from '../ExportPipeline.flow';\nimport {\n  type ExportState,\n  SetupExportHeader,\n} from '../GenericExporters/OnlineCordovaExport';\nconst gd: libGDevelop = global.gd;\n\ntype PreparedExporter = {|\n  exporter: gdjsExporter,\n  abstractFileSystem: BrowserFileSystem,\n  outputDir: string,\n|};\n\ntype ExportOutput = {|\n  textFiles: Array<TextFileDescriptor>,\n  urlFiles: Array<UrlFileDescriptor>,\n|};\n\ntype ResourcesDownloadOutput = {|\n  textFiles: Array<TextFileDescriptor>,\n  blobFiles: Array<BlobFileDescriptor>,\n|};\n\ntype CompressionOutput = Blob;\n\nexport const browserOnlineCordovaExportPipeline: ExportPipeline<\n  ExportState,\n  PreparedExporter,\n  ExportOutput,\n  ResourcesDownloadOutput,\n  CompressionOutput\n> = {\n  name: 'browser-online-cordova',\n  onlineBuildType: 'cordova-build',\n  limitedBuilds: true,\n  packageNameWarningType: 'mobile',\n\n  getInitialExportState: () => ({\n    targets: ['androidApk'],\n    keystore: 'new',\n    signingDialogOpen: false,\n  }),\n\n  // Build can be launched only if just opened the dialog or build errored.\n  canLaunchBuild: (exportState, errored, exportStep) =>\n    errored || exportStep === '',\n\n  // Navigation is enabled when the build is errored or whilst uploading.\n  isNavigationDisabled: (exportStep, errored) =>\n    !errored &&\n    ['register', 'export', 'resources-download', 'compress', 'upload'].includes(\n      exportStep\n    ),\n\n  renderHeader: props => <SetupExportHeader {...props} />,\n\n  renderLaunchButtonLabel: () => <Trans>Create package for Android</Trans>,\n\n  prepareExporter: (\n    context: ExportPipelineContext<ExportState>\n  ): Promise<PreparedExporter> => {\n    return findGDJS('cordova').then(({ gdjsRoot, filesContent }) => {\n      console.info('GDJS found in ', gdjsRoot);\n\n      const outputDir = '/export/';\n      const abstractFileSystem = new BrowserFileSystem({\n        textFiles: filesContent,\n      });\n      const fileSystem = assignIn(\n        new gd.AbstractFileSystemJS(),\n        abstractFileSystem\n      );\n      const exporter = new gd.Exporter(fileSystem, gdjsRoot);\n\n      return {\n        exporter,\n        outputDir,\n        abstractFileSystem,\n      };\n    });\n  },\n\n  launchExport: (\n    context: ExportPipelineContext<ExportState>,\n    { exporter, outputDir, abstractFileSystem }: PreparedExporter,\n    fallbackAuthor: ?{ id: string, username: string }\n  ): Promise<ExportOutput> => {\n    const { project } = context;\n    const exportOptions = new gd.ExportOptions(project, outputDir);\n    exportOptions.setTarget('cordova');\n    if (fallbackAuthor) {\n      exportOptions.setFallbackAuthor(\n        fallbackAuthor.id,\n        fallbackAuthor.username\n      );\n    }\n    exporter.exportWholePixiProject(exportOptions);\n    exportOptions.delete();\n    exporter.delete();\n\n    return Promise.resolve({\n      textFiles: abstractFileSystem.getAllTextFilesIn(outputDir),\n      urlFiles: abstractFileSystem.getAllUrlFilesIn(outputDir),\n    });\n  },\n\n  launchResourcesDownload: (\n    context: ExportPipelineContext<ExportState>,\n    { textFiles, urlFiles }: ExportOutput\n  ): Promise<ResourcesDownloadOutput> => {\n    return downloadUrlFilesToBlobFiles({\n      urlFiles,\n      onProgress: context.updateStepProgress,\n    }).then(blobFiles => ({\n      blobFiles,\n      textFiles,\n    }));\n  },\n\n  launchCompression: (\n    context: ExportPipelineContext<ExportState>,\n    { textFiles, blobFiles }: ResourcesDownloadOutput\n  ): Promise<Blob> => {\n    return archiveFiles({\n      blobFiles,\n      textFiles,\n      basePath: '/export/',\n      onProgress: context.updateStepProgress,\n    });\n  },\n\n  launchUpload: (\n    context: ExportPipelineContext<ExportState>,\n    blobFile: Blob\n  ): Promise<string> => {\n    return getBuildFileUploadOptions().then(uploadOptions => {\n      return uploadBlobFile(\n        blobFile,\n        uploadOptions,\n        context.updateStepProgress\n      ).then(() => uploadOptions.key);\n    });\n  },\n\n  launchOnlineBuild: (\n    exportState: ExportState,\n    authenticatedUser: AuthenticatedUser,\n    uploadBucketKey: string,\n    gameId: string,\n    options: {|\n      gameName: string,\n      gameVersion: string,\n    |}\n  ): Promise<Build> => {\n    const { getAuthorizationHeader, firebaseUser } = authenticatedUser;\n    if (!firebaseUser)\n      return Promise.reject(new Error('User is not authenticated'));\n\n    return buildCordovaAndroid(\n      getAuthorizationHeader,\n      firebaseUser.uid,\n      uploadBucketKey,\n      exportState.targets,\n      exportState.keystore,\n      gameId,\n      options\n    );\n  },\n};\n","// @flow\nimport * as React from 'react';\nimport { Trans } from '@lingui/macro';\nimport assignIn from 'lodash/assignIn';\nimport {\n  type Build,\n  buildElectron,\n  getBuildFileUploadOptions,\n} from '../../Utils/GDevelopServices/Build';\nimport { uploadBlobFile } from './BrowserFileUploader';\nimport { type AuthenticatedUser } from '../../Profile/AuthenticatedUserContext';\nimport { findGDJS } from '../../GameEngineFinder/BrowserS3GDJSFinder';\nimport BrowserFileSystem from './BrowserFileSystem';\nimport {\n  type UrlFileDescriptor,\n  type TextFileDescriptor,\n  type BlobFileDescriptor,\n  downloadUrlFilesToBlobFiles,\n  archiveFiles,\n} from '../../Utils/BrowserArchiver';\nimport {\n  type ExportPipeline,\n  type ExportPipelineContext,\n} from '../ExportPipeline.flow';\nimport {\n  type ExportState,\n  SetupExportHeader,\n} from '../GenericExporters/OnlineElectronExport';\nconst gd: libGDevelop = global.gd;\n\ntype PreparedExporter = {|\n  exporter: gdjsExporter,\n  abstractFileSystem: BrowserFileSystem,\n  outputDir: string,\n|};\n\ntype ExportOutput = {|\n  textFiles: Array<TextFileDescriptor>,\n  urlFiles: Array<UrlFileDescriptor>,\n|};\n\ntype ResourcesDownloadOutput = {|\n  textFiles: Array<TextFileDescriptor>,\n  blobFiles: Array<BlobFileDescriptor>,\n|};\n\ntype CompressionOutput = Blob;\n\nexport const browserOnlineElectronExportPipeline: ExportPipeline<\n  ExportState,\n  PreparedExporter,\n  ExportOutput,\n  ResourcesDownloadOutput,\n  CompressionOutput\n> = {\n  name: 'browser-online-electron',\n  onlineBuildType: 'electron-build',\n  limitedBuilds: true,\n  packageNameWarningType: 'desktop',\n\n  getInitialExportState: () => ({\n    targets: ['winExe'],\n  }),\n\n  // Build can be launched only if just opened the dialog or build errored.\n  canLaunchBuild: (exportState, errored, exportStep) =>\n    !!exportState.targets.length && (errored || exportStep === ''),\n\n  // Navigation is enabled when the build is errored or whilst uploading.\n  isNavigationDisabled: (exportStep, errored) =>\n    !errored &&\n    ['register', 'export', 'resources-download', 'compress', 'upload'].includes(\n      exportStep\n    ),\n\n  renderHeader: props => <SetupExportHeader {...props} />,\n\n  renderLaunchButtonLabel: () => <Trans>Package</Trans>,\n\n  prepareExporter: (\n    context: ExportPipelineContext<ExportState>\n  ): Promise<PreparedExporter> => {\n    return findGDJS('electron').then(({ gdjsRoot, filesContent }) => {\n      console.info('GDJS found in ', gdjsRoot);\n\n      const outputDir = '/export/';\n      const abstractFileSystem = new BrowserFileSystem({\n        textFiles: filesContent,\n      });\n      const fileSystem = assignIn(\n        new gd.AbstractFileSystemJS(),\n        abstractFileSystem\n      );\n      const exporter = new gd.Exporter(fileSystem, gdjsRoot);\n\n      return {\n        exporter,\n        outputDir,\n        abstractFileSystem,\n      };\n    });\n  },\n\n  launchExport: (\n    context: ExportPipelineContext<ExportState>,\n    { exporter, outputDir, abstractFileSystem }: PreparedExporter,\n    fallbackAuthor: ?{ id: string, username: string }\n  ): Promise<ExportOutput> => {\n    const { project } = context;\n    const exportOptions = new gd.ExportOptions(project, outputDir);\n    exportOptions.setTarget('electron');\n    if (fallbackAuthor) {\n      exportOptions.setFallbackAuthor(\n        fallbackAuthor.id,\n        fallbackAuthor.username\n      );\n    }\n    exporter.exportWholePixiProject(exportOptions);\n    exportOptions.delete();\n    exporter.delete();\n\n    return Promise.resolve({\n      textFiles: abstractFileSystem.getAllTextFilesIn(outputDir),\n      urlFiles: abstractFileSystem.getAllUrlFilesIn(outputDir),\n    });\n  },\n\n  launchResourcesDownload: (\n    context: ExportPipelineContext<ExportState>,\n    { textFiles, urlFiles }: ExportOutput\n  ): Promise<ResourcesDownloadOutput> => {\n    return downloadUrlFilesToBlobFiles({\n      urlFiles,\n      onProgress: context.updateStepProgress,\n    }).then(blobFiles => ({\n      blobFiles,\n      textFiles,\n    }));\n  },\n\n  launchCompression: (\n    context: ExportPipelineContext<ExportState>,\n    { textFiles, blobFiles }: ResourcesDownloadOutput\n  ): Promise<Blob> => {\n    return archiveFiles({\n      blobFiles,\n      textFiles,\n      basePath: '/export/',\n      onProgress: context.updateStepProgress,\n    });\n  },\n\n  launchUpload: (\n    context: ExportPipelineContext<ExportState>,\n    blobFile: Blob\n  ): Promise<string> => {\n    return getBuildFileUploadOptions().then(uploadOptions => {\n      return uploadBlobFile(\n        blobFile,\n        uploadOptions,\n        context.updateStepProgress\n      ).then(() => uploadOptions.key);\n    });\n  },\n\n  launchOnlineBuild: (\n    exportState: ExportState,\n    authenticatedUser: AuthenticatedUser,\n    uploadBucketKey: string,\n    gameId: string,\n    options: {|\n      gameName: string,\n      gameVersion: string,\n    |}\n  ): Promise<Build> => {\n    const { getAuthorizationHeader, firebaseUser } = authenticatedUser;\n    if (!firebaseUser)\n      return Promise.reject(new Error('User is not authenticated'));\n\n    return buildElectron(\n      getAuthorizationHeader,\n      firebaseUser.uid,\n      uploadBucketKey,\n      exportState.targets,\n      gameId,\n      options\n    );\n  },\n};\n","// @flow\nimport * as React from 'react';\nimport { Trans } from '@lingui/macro';\nimport assignIn from 'lodash/assignIn';\nimport {\n  type Build,\n  buildWeb,\n  getBuildFileUploadOptions,\n} from '../../Utils/GDevelopServices/Build';\nimport { uploadBlobFile } from './BrowserFileUploader';\nimport { type AuthenticatedUser } from '../../Profile/AuthenticatedUserContext';\nimport { findGDJS } from '../../GameEngineFinder/BrowserS3GDJSFinder';\nimport BrowserFileSystem from './BrowserFileSystem';\nimport {\n  type UrlFileDescriptor,\n  type TextFileDescriptor,\n  type BlobFileDescriptor,\n  downloadUrlFilesToBlobFiles,\n  archiveFiles,\n} from '../../Utils/BrowserArchiver';\nimport {\n  type ExportPipeline,\n  type ExportPipelineContext,\n} from '../ExportPipeline.flow';\nimport {\n  ExplanationHeader,\n  OnlineGameLink,\n} from '../GenericExporters/OnlineWebExport';\nconst gd: libGDevelop = global.gd;\n\ntype ExportState = null;\n\ntype PreparedExporter = {|\n  exporter: gdjsExporter,\n  abstractFileSystem: BrowserFileSystem,\n  outputDir: string,\n|};\n\ntype ExportOutput = {|\n  textFiles: Array<TextFileDescriptor>,\n  urlFiles: Array<UrlFileDescriptor>,\n|};\n\ntype ResourcesDownloadOutput = {|\n  textFiles: Array<TextFileDescriptor>,\n  blobFiles: Array<BlobFileDescriptor>,\n|};\n\ntype CompressionOutput = Blob;\n\nexport const browserOnlineWebExportPipeline: ExportPipeline<\n  ExportState,\n  PreparedExporter,\n  ExportOutput,\n  ResourcesDownloadOutput,\n  CompressionOutput\n> = {\n  name: 'browser-online-web',\n  onlineBuildType: 'web-build',\n\n  getInitialExportState: () => null,\n\n  // Build can be launched if just opened the dialog or build errored, re-enabled when done.\n  canLaunchBuild: (exportState, errored, exportStep) =>\n    errored || exportStep === '' || exportStep === 'done',\n\n  // Navigation is enabled when the build is errored or if the build is not done.\n  isNavigationDisabled: (exportStep, errored) =>\n    !errored && !['', 'done'].includes(exportStep),\n\n  renderHeader: () => <ExplanationHeader />,\n\n  renderLaunchButtonLabel: () => <Trans>Generate link</Trans>,\n\n  renderCustomStepsProgress: ({\n    build,\n    project,\n    onSaveProject,\n    errored,\n    exportStep,\n  }) => (\n    <OnlineGameLink\n      build={build}\n      project={project}\n      onSaveProject={onSaveProject}\n      errored={errored}\n      exportStep={exportStep}\n    />\n  ),\n\n  prepareExporter: (\n    context: ExportPipelineContext<ExportState>\n  ): Promise<PreparedExporter> => {\n    return findGDJS('web').then(({ gdjsRoot, filesContent }) => {\n      console.info('GDJS found in ', gdjsRoot);\n\n      const outputDir = '/export/';\n      const abstractFileSystem = new BrowserFileSystem({\n        textFiles: filesContent,\n      });\n      const fileSystem = assignIn(\n        new gd.AbstractFileSystemJS(),\n        abstractFileSystem\n      );\n      const exporter = new gd.Exporter(fileSystem, gdjsRoot);\n\n      return {\n        exporter,\n        outputDir,\n        abstractFileSystem,\n      };\n    });\n  },\n\n  launchExport: (\n    context: ExportPipelineContext<ExportState>,\n    { exporter, outputDir, abstractFileSystem }: PreparedExporter,\n    fallbackAuthor: ?{ id: string, username: string }\n  ): Promise<ExportOutput> => {\n    const { project } = context;\n    const exportOptions = new gd.ExportOptions(project, outputDir);\n    if (fallbackAuthor) {\n      exportOptions.setFallbackAuthor(\n        fallbackAuthor.id,\n        fallbackAuthor.username\n      );\n    }\n    exporter.exportWholePixiProject(exportOptions);\n    exportOptions.delete();\n    exporter.delete();\n\n    return Promise.resolve({\n      textFiles: abstractFileSystem.getAllTextFilesIn(outputDir),\n      urlFiles: abstractFileSystem.getAllUrlFilesIn(outputDir),\n    });\n  },\n\n  launchResourcesDownload: (\n    context: ExportPipelineContext<ExportState>,\n    { textFiles, urlFiles }: ExportOutput\n  ): Promise<ResourcesDownloadOutput> => {\n    return downloadUrlFilesToBlobFiles({\n      urlFiles,\n      onProgress: context.updateStepProgress,\n    }).then(blobFiles => ({\n      blobFiles,\n      textFiles,\n    }));\n  },\n\n  launchCompression: (\n    context: ExportPipelineContext<ExportState>,\n    { textFiles, blobFiles }: ResourcesDownloadOutput\n  ): Promise<Blob> => {\n    return archiveFiles({\n      blobFiles,\n      textFiles,\n      basePath: '/export/',\n      onProgress: context.updateStepProgress,\n      sizeLimit: 250 * 1000 * 1000,\n    });\n  },\n\n  launchUpload: (\n    context: ExportPipelineContext<ExportState>,\n    blobFile: Blob\n  ): Promise<string> => {\n    return getBuildFileUploadOptions().then(uploadOptions => {\n      return uploadBlobFile(\n        blobFile,\n        uploadOptions,\n        context.updateStepProgress\n      ).then(() => uploadOptions.key);\n    });\n  },\n\n  launchOnlineBuild: (\n    exportState: ExportState,\n    authenticatedUser: AuthenticatedUser,\n    uploadBucketKey: string,\n    gameId: string,\n    options: {|\n      gameName: string,\n      gameVersion: string,\n    |}\n  ): Promise<Build> => {\n    const { getAuthorizationHeader, firebaseUser } = authenticatedUser;\n    if (!firebaseUser)\n      return Promise.reject(new Error('User is not authenticated'));\n\n    return buildWeb(\n      getAuthorizationHeader,\n      firebaseUser.uid,\n      uploadBucketKey,\n      gameId,\n      options\n    );\n  },\n};\n","// @flow\nimport * as React from 'react';\n\ntype Props = {\n  blob: ?Blob,\n  children: (blobDownloadUrl: string) => React.Node,\n};\n\nexport const BlobDownloadUrlHolder = ({ blob, children }: Props) => {\n  const [blobDownloadUrl, setBlobDownloadUrl] = React.useState('');\n  const [currentBlob, setCurrentBlob] = React.useState<?Blob>(null);\n  React.useEffect(\n    () => {\n      // This effect function does not look at the blobDownloadUrl, to avoid infinite loops.\n      // It is only in charge of updating the Url when the blob changes.\n      if (blob && blob !== currentBlob) {\n        setBlobDownloadUrl(URL.createObjectURL(blob));\n        setCurrentBlob(blob);\n      }\n    },\n    [blob, currentBlob]\n  );\n\n  React.useEffect(\n    () => {\n      // This cleanup is called both when the component is unmounted or when an update happens.\n      // This allows releasing the URL when a new one is generated.\n      // See https://reactjs.org/docs/hooks-effect.html#explanation-why-effects-run-on-each-update\n      return () => {\n        if (blobDownloadUrl) {\n          URL.revokeObjectURL(blobDownloadUrl);\n        }\n      };\n    },\n    [blobDownloadUrl]\n  );\n\n  return children(blobDownloadUrl);\n};\n\n/**\n * Open an URL generated from a blob, to download it with the specified filename.\n */\nexport const openBlobDownloadUrl = (url: string, filename: string) => {\n  const { body } = document;\n  if (!body) return;\n\n  // Not using Window.openExternalURL because blob urls are blocked\n  // by Adblock Plus (and maybe other ad blockers).\n  const a = document.createElement('a');\n  body.appendChild(a);\n  a.style.display = 'none';\n  a.href = url;\n  a.download = filename;\n  a.click();\n  body.removeChild(a);\n};\n","// @flow\nimport * as React from 'react';\nimport { Trans } from '@lingui/macro';\nimport assignIn from 'lodash/assignIn';\nimport { findGDJS } from '../../GameEngineFinder/BrowserS3GDJSFinder';\nimport BrowserFileSystem from './BrowserFileSystem';\nimport {\n  type UrlFileDescriptor,\n  type TextFileDescriptor,\n  type BlobFileDescriptor,\n  downloadUrlFilesToBlobFiles,\n  archiveFiles,\n} from '../../Utils/BrowserArchiver';\nimport {\n  type ExportPipeline,\n  type ExportPipelineContext,\n} from '../ExportPipeline.flow';\nimport RaisedButton from '../../UI/RaisedButton';\nimport {\n  BlobDownloadUrlHolder,\n  openBlobDownloadUrl,\n} from '../../Utils/BlobDownloadUrlHolder';\nimport { ExplanationHeader, DoneFooter } from '../GenericExporters/HTML5Export';\nconst gd: libGDevelop = global.gd;\n\ntype ExportState = null;\n\ntype PreparedExporter = {|\n  exporter: gdjsExporter,\n  abstractFileSystem: BrowserFileSystem,\n  outputDir: string,\n|};\n\ntype ExportOutput = {|\n  textFiles: Array<TextFileDescriptor>,\n  urlFiles: Array<UrlFileDescriptor>,\n|};\n\ntype ResourcesDownloadOutput = {|\n  textFiles: Array<TextFileDescriptor>,\n  blobFiles: Array<BlobFileDescriptor>,\n|};\n\ntype CompressionOutput = Blob;\n\nexport const browserHTML5ExportPipeline: ExportPipeline<\n  ExportState,\n  PreparedExporter,\n  ExportOutput,\n  ResourcesDownloadOutput,\n  CompressionOutput\n> = {\n  name: 'browser-html5',\n\n  getInitialExportState: () => null,\n\n  canLaunchBuild: () => true,\n\n  isNavigationDisabled: () => false,\n\n  renderHeader: () => <ExplanationHeader />,\n\n  renderLaunchButtonLabel: () => <Trans>Export as a HTML5 game</Trans>,\n\n  prepareExporter: (\n    context: ExportPipelineContext<ExportState>\n  ): Promise<PreparedExporter> => {\n    return findGDJS('web').then(({ gdjsRoot, filesContent }) => {\n      console.info('GDJS found in ', gdjsRoot);\n\n      const outputDir = '/export/';\n      const abstractFileSystem = new BrowserFileSystem({\n        textFiles: filesContent,\n      });\n      // TODO: Memory leak? Check for other exporters too.\n      const fileSystem = assignIn(\n        new gd.AbstractFileSystemJS(),\n        abstractFileSystem\n      );\n      const exporter = new gd.Exporter(fileSystem, gdjsRoot);\n\n      return {\n        exporter,\n        outputDir,\n        abstractFileSystem,\n      };\n    });\n  },\n\n  launchExport: (\n    context: ExportPipelineContext<ExportState>,\n    { exporter, outputDir, abstractFileSystem }: PreparedExporter,\n    fallbackAuthor: ?{ id: string, username: string }\n  ): Promise<ExportOutput> => {\n    const { project } = context;\n    const exportOptions = new gd.ExportOptions(project, outputDir);\n    if (fallbackAuthor) {\n      exportOptions.setFallbackAuthor(\n        fallbackAuthor.id,\n        fallbackAuthor.username\n      );\n    }\n    exporter.exportWholePixiProject(exportOptions);\n    exportOptions.delete();\n    exporter.delete();\n\n    return Promise.resolve({\n      textFiles: abstractFileSystem.getAllTextFilesIn(outputDir),\n      urlFiles: abstractFileSystem.getAllUrlFilesIn(outputDir),\n    });\n  },\n\n  launchResourcesDownload: (\n    context: ExportPipelineContext<ExportState>,\n    { textFiles, urlFiles }: ExportOutput\n  ): Promise<ResourcesDownloadOutput> => {\n    return downloadUrlFilesToBlobFiles({\n      urlFiles,\n      onProgress: context.updateStepProgress,\n    }).then(blobFiles => ({\n      blobFiles,\n      textFiles,\n    }));\n  },\n\n  launchCompression: (\n    context: ExportPipelineContext<ExportState>,\n    { textFiles, blobFiles }: ResourcesDownloadOutput\n  ): Promise<Blob> => {\n    return archiveFiles({\n      blobFiles,\n      textFiles,\n      basePath: '/export/',\n      onProgress: context.updateStepProgress,\n    });\n  },\n\n  renderDoneFooter: ({ compressionOutput, exportState, onClose }) => {\n    return (\n      <DoneFooter\n        renderGameButton={() => (\n          <BlobDownloadUrlHolder blob={compressionOutput}>\n            {blobDownloadUrl => (\n              <RaisedButton\n                fullWidth\n                primary\n                onClick={() => openBlobDownloadUrl(blobDownloadUrl, 'game.zip')}\n                label={<Trans>Download the exported game</Trans>}\n              />\n            )}\n          </BlobDownloadUrlHolder>\n        )}\n      />\n    );\n  },\n};\n","// @flow\nimport * as React from 'react';\nimport { Trans } from '@lingui/macro';\nimport assignIn from 'lodash/assignIn';\nimport { findGDJS } from '../../GameEngineFinder/BrowserS3GDJSFinder';\nimport BrowserFileSystem from './BrowserFileSystem';\nimport {\n  type UrlFileDescriptor,\n  type TextFileDescriptor,\n  type BlobFileDescriptor,\n  downloadUrlFilesToBlobFiles,\n  archiveFiles,\n} from '../../Utils/BrowserArchiver';\nimport {\n  type ExportPipeline,\n  type ExportPipelineContext,\n} from '../ExportPipeline.flow';\nimport RaisedButton from '../../UI/RaisedButton';\nimport {\n  BlobDownloadUrlHolder,\n  openBlobDownloadUrl,\n} from '../../Utils/BlobDownloadUrlHolder';\nimport {\n  ExplanationHeader,\n  DoneFooter,\n} from '../GenericExporters/CordovaExport';\nconst gd: libGDevelop = global.gd;\n\ntype ExportState = null;\n\ntype PreparedExporter = {|\n  exporter: gdjsExporter,\n  abstractFileSystem: BrowserFileSystem,\n  outputDir: string,\n|};\n\ntype ExportOutput = {|\n  textFiles: Array<TextFileDescriptor>,\n  urlFiles: Array<UrlFileDescriptor>,\n|};\n\ntype ResourcesDownloadOutput = {|\n  textFiles: Array<TextFileDescriptor>,\n  blobFiles: Array<BlobFileDescriptor>,\n|};\n\ntype CompressionOutput = Blob;\n\nexport const browserCordovaExportPipeline: ExportPipeline<\n  ExportState,\n  PreparedExporter,\n  ExportOutput,\n  ResourcesDownloadOutput,\n  CompressionOutput\n> = {\n  name: 'browser-cordova',\n  packageNameWarningType: 'mobile',\n\n  getInitialExportState: () => null,\n\n  canLaunchBuild: () => true,\n\n  isNavigationDisabled: () => false,\n\n  renderHeader: () => <ExplanationHeader />,\n\n  renderLaunchButtonLabel: () => <Trans>Package</Trans>,\n\n  prepareExporter: (\n    context: ExportPipelineContext<ExportState>\n  ): Promise<PreparedExporter> => {\n    return findGDJS('cordova').then(({ gdjsRoot, filesContent }) => {\n      console.info('GDJS found in ', gdjsRoot);\n\n      const outputDir = '/export/';\n      const abstractFileSystem = new BrowserFileSystem({\n        textFiles: filesContent,\n      });\n      // TODO: Memory leak? Check for other exporters too.\n      const fileSystem = assignIn(\n        new gd.AbstractFileSystemJS(),\n        abstractFileSystem\n      );\n      const exporter = new gd.Exporter(fileSystem, gdjsRoot);\n\n      return {\n        exporter,\n        outputDir,\n        abstractFileSystem,\n      };\n    });\n  },\n\n  launchExport: (\n    context: ExportPipelineContext<ExportState>,\n    { exporter, outputDir, abstractFileSystem }: PreparedExporter,\n    fallbackAuthor: ?{ id: string, username: string }\n  ): Promise<ExportOutput> => {\n    const { project } = context;\n    const exportOptions = new gd.ExportOptions(project, outputDir);\n    exportOptions.setTarget('cordova');\n    if (fallbackAuthor) {\n      exportOptions.setFallbackAuthor(\n        fallbackAuthor.id,\n        fallbackAuthor.username\n      );\n    }\n    exporter.exportWholePixiProject(exportOptions);\n    exportOptions.delete();\n    exporter.delete();\n\n    return Promise.resolve({\n      textFiles: abstractFileSystem.getAllTextFilesIn(outputDir),\n      urlFiles: abstractFileSystem.getAllUrlFilesIn(outputDir),\n    });\n  },\n\n  launchResourcesDownload: (\n    context: ExportPipelineContext<ExportState>,\n    { textFiles, urlFiles }: ExportOutput\n  ): Promise<ResourcesDownloadOutput> => {\n    return downloadUrlFilesToBlobFiles({\n      urlFiles,\n      onProgress: context.updateStepProgress,\n    }).then(blobFiles => ({\n      blobFiles,\n      textFiles,\n    }));\n  },\n\n  launchCompression: (\n    context: ExportPipelineContext<ExportState>,\n    { textFiles, blobFiles }: ResourcesDownloadOutput\n  ): Promise<Blob> => {\n    return archiveFiles({\n      blobFiles,\n      textFiles,\n      basePath: '/export/',\n      onProgress: context.updateStepProgress,\n    });\n  },\n\n  renderDoneFooter: ({ compressionOutput, exportState, onClose }) => {\n    return (\n      <DoneFooter\n        renderGameButton={() => (\n          <BlobDownloadUrlHolder blob={compressionOutput}>\n            {blobDownloadUrl => (\n              <RaisedButton\n                fullWidth\n                primary\n                onClick={() => openBlobDownloadUrl(blobDownloadUrl, 'game.zip')}\n                label={<Trans>Download the exported game</Trans>}\n              />\n            )}\n          </BlobDownloadUrlHolder>\n        )}\n      />\n    );\n  },\n};\n","// @flow\nimport * as React from 'react';\nimport { Trans } from '@lingui/macro';\nimport assignIn from 'lodash/assignIn';\nimport { findGDJS } from '../../GameEngineFinder/BrowserS3GDJSFinder';\nimport BrowserFileSystem from './BrowserFileSystem';\nimport {\n  type UrlFileDescriptor,\n  type TextFileDescriptor,\n  type BlobFileDescriptor,\n  downloadUrlFilesToBlobFiles,\n  archiveFiles,\n} from '../../Utils/BrowserArchiver';\nimport {\n  type ExportPipeline,\n  type ExportPipelineContext,\n} from '../ExportPipeline.flow';\nimport RaisedButton from '../../UI/RaisedButton';\nimport {\n  BlobDownloadUrlHolder,\n  openBlobDownloadUrl,\n} from '../../Utils/BlobDownloadUrlHolder';\nimport {\n  ExplanationHeader,\n  DoneFooter,\n} from '../GenericExporters/ElectronExport';\nconst gd: libGDevelop = global.gd;\n\ntype ExportState = null;\n\ntype PreparedExporter = {|\n  exporter: gdjsExporter,\n  abstractFileSystem: BrowserFileSystem,\n  outputDir: string,\n|};\n\ntype ExportOutput = {|\n  textFiles: Array<TextFileDescriptor>,\n  urlFiles: Array<UrlFileDescriptor>,\n|};\n\ntype ResourcesDownloadOutput = {|\n  textFiles: Array<TextFileDescriptor>,\n  blobFiles: Array<BlobFileDescriptor>,\n|};\n\ntype CompressionOutput = Blob;\n\nexport const browserElectronExportPipeline: ExportPipeline<\n  ExportState,\n  PreparedExporter,\n  ExportOutput,\n  ResourcesDownloadOutput,\n  CompressionOutput\n> = {\n  name: 'browser-electron',\n  packageNameWarningType: 'desktop',\n\n  getInitialExportState: () => null,\n\n  canLaunchBuild: () => true,\n\n  isNavigationDisabled: () => false,\n\n  renderHeader: () => <ExplanationHeader />,\n\n  renderLaunchButtonLabel: () => <Trans>Package</Trans>,\n\n  prepareExporter: (\n    context: ExportPipelineContext<ExportState>\n  ): Promise<PreparedExporter> => {\n    return findGDJS('electron').then(({ gdjsRoot, filesContent }) => {\n      console.info('GDJS found in ', gdjsRoot);\n\n      const outputDir = '/export/';\n      const abstractFileSystem = new BrowserFileSystem({\n        textFiles: filesContent,\n      });\n      // TODO: Memory leak? Check for other exporters too.\n      const fileSystem = assignIn(\n        new gd.AbstractFileSystemJS(),\n        abstractFileSystem\n      );\n      const exporter = new gd.Exporter(fileSystem, gdjsRoot);\n\n      return {\n        exporter,\n        outputDir,\n        abstractFileSystem,\n      };\n    });\n  },\n\n  launchExport: (\n    context: ExportPipelineContext<ExportState>,\n    { exporter, outputDir, abstractFileSystem }: PreparedExporter,\n    fallbackAuthor: ?{ id: string, username: string }\n  ): Promise<ExportOutput> => {\n    const { project } = context;\n    const exportOptions = new gd.ExportOptions(project, outputDir);\n    exportOptions.setTarget('electron');\n    if (fallbackAuthor) {\n      exportOptions.setFallbackAuthor(\n        fallbackAuthor.id,\n        fallbackAuthor.username\n      );\n    }\n    exporter.exportWholePixiProject(exportOptions);\n    exportOptions.delete();\n    exporter.delete();\n\n    return Promise.resolve({\n      textFiles: abstractFileSystem.getAllTextFilesIn(outputDir),\n      urlFiles: abstractFileSystem.getAllUrlFilesIn(outputDir),\n    });\n  },\n\n  launchResourcesDownload: (\n    context: ExportPipelineContext<ExportState>,\n    { textFiles, urlFiles }: ExportOutput\n  ): Promise<ResourcesDownloadOutput> => {\n    return downloadUrlFilesToBlobFiles({\n      urlFiles,\n      onProgress: context.updateStepProgress,\n    }).then(blobFiles => ({\n      blobFiles,\n      textFiles,\n    }));\n  },\n\n  launchCompression: (\n    context: ExportPipelineContext<ExportState>,\n    { textFiles, blobFiles }: ResourcesDownloadOutput\n  ): Promise<Blob> => {\n    return archiveFiles({\n      blobFiles,\n      textFiles,\n      basePath: '/export/',\n      onProgress: context.updateStepProgress,\n    });\n  },\n\n  renderDoneFooter: ({ compressionOutput, exportState, onClose }) => {\n    return (\n      <DoneFooter\n        renderGameButton={() => (\n          <BlobDownloadUrlHolder blob={compressionOutput}>\n            {blobDownloadUrl => (\n              <RaisedButton\n                fullWidth\n                primary\n                onClick={() => openBlobDownloadUrl(blobDownloadUrl, 'game.zip')}\n                label={<Trans>Download the exported game</Trans>}\n              />\n            )}\n          </BlobDownloadUrlHolder>\n        )}\n      />\n    );\n  },\n};\n","// @flow\nimport * as React from 'react';\nimport { Trans } from '@lingui/macro';\nimport assignIn from 'lodash/assignIn';\nimport { findGDJS } from '../../GameEngineFinder/BrowserS3GDJSFinder';\nimport BrowserFileSystem from './BrowserFileSystem';\nimport {\n  type UrlFileDescriptor,\n  type TextFileDescriptor,\n  type BlobFileDescriptor,\n  downloadUrlFilesToBlobFiles,\n  archiveFiles,\n} from '../../Utils/BrowserArchiver';\nimport {\n  type ExportPipeline,\n  type ExportPipelineContext,\n} from '../ExportPipeline.flow';\nimport RaisedButton from '../../UI/RaisedButton';\nimport {\n  BlobDownloadUrlHolder,\n  openBlobDownloadUrl,\n} from '../../Utils/BlobDownloadUrlHolder';\nimport {\n  ExplanationHeader,\n  DoneFooter,\n} from '../GenericExporters/FacebookInstantGamesExport';\nconst gd: libGDevelop = global.gd;\n\ntype ExportState = null;\n\ntype PreparedExporter = {|\n  exporter: gdjsExporter,\n  abstractFileSystem: BrowserFileSystem,\n  outputDir: string,\n|};\n\ntype ExportOutput = {|\n  textFiles: Array<TextFileDescriptor>,\n  urlFiles: Array<UrlFileDescriptor>,\n|};\n\ntype ResourcesDownloadOutput = {|\n  textFiles: Array<TextFileDescriptor>,\n  blobFiles: Array<BlobFileDescriptor>,\n|};\n\ntype CompressionOutput = Blob;\n\nexport const browserFacebookInstantGamesExportPipeline: ExportPipeline<\n  ExportState,\n  PreparedExporter,\n  ExportOutput,\n  ResourcesDownloadOutput,\n  CompressionOutput\n> = {\n  name: 'browser-facebook-instant-games',\n\n  getInitialExportState: () => null,\n\n  canLaunchBuild: () => true,\n\n  isNavigationDisabled: () => false,\n\n  renderHeader: () => <ExplanationHeader />,\n\n  renderLaunchButtonLabel: () => <Trans>Package</Trans>,\n\n  prepareExporter: (\n    context: ExportPipelineContext<ExportState>\n  ): Promise<PreparedExporter> => {\n    return findGDJS('facebook-instant-games').then(\n      ({ gdjsRoot, filesContent }) => {\n        console.info('GDJS found in ', gdjsRoot);\n\n        const outputDir = '/export/';\n        const abstractFileSystem = new BrowserFileSystem({\n          textFiles: filesContent,\n        });\n        // TODO: Memory leak? Check for other exporters too.\n        const fileSystem = assignIn(\n          new gd.AbstractFileSystemJS(),\n          abstractFileSystem\n        );\n        const exporter = new gd.Exporter(fileSystem, gdjsRoot);\n\n        return {\n          exporter,\n          outputDir,\n          abstractFileSystem,\n        };\n      }\n    );\n  },\n\n  launchExport: (\n    context: ExportPipelineContext<ExportState>,\n    { exporter, outputDir, abstractFileSystem }: PreparedExporter,\n    fallbackAuthor: ?{ id: string, username: string }\n  ): Promise<ExportOutput> => {\n    const { project } = context;\n    const exportOptions = new gd.ExportOptions(project, outputDir);\n    exportOptions.setTarget('facebookInstantGames');\n    if (fallbackAuthor) {\n      exportOptions.setFallbackAuthor(\n        fallbackAuthor.id,\n        fallbackAuthor.username\n      );\n    }\n    exporter.exportWholePixiProject(exportOptions);\n    exportOptions.delete();\n    exporter.delete();\n\n    return Promise.resolve({\n      textFiles: abstractFileSystem.getAllTextFilesIn(outputDir),\n      urlFiles: abstractFileSystem.getAllUrlFilesIn(outputDir),\n    });\n  },\n\n  launchResourcesDownload: (\n    context: ExportPipelineContext<ExportState>,\n    { textFiles, urlFiles }: ExportOutput\n  ): Promise<ResourcesDownloadOutput> => {\n    return downloadUrlFilesToBlobFiles({\n      urlFiles,\n      onProgress: context.updateStepProgress,\n    }).then(blobFiles => ({\n      blobFiles,\n      textFiles,\n    }));\n  },\n\n  launchCompression: (\n    context: ExportPipelineContext<ExportState>,\n    { textFiles, blobFiles }: ResourcesDownloadOutput\n  ): Promise<Blob> => {\n    return archiveFiles({\n      blobFiles,\n      textFiles,\n      basePath: '/export/',\n      onProgress: context.updateStepProgress,\n    });\n  },\n\n  renderDoneFooter: ({ compressionOutput, exportState, onClose }) => {\n    return (\n      <DoneFooter\n        renderGameButton={() => (\n          <BlobDownloadUrlHolder blob={compressionOutput}>\n            {blobDownloadUrl => (\n              <RaisedButton\n                primary\n                onClick={() =>\n                  openBlobDownloadUrl(blobDownloadUrl, 'fb-instant-game.zip')\n                }\n                label={<Trans>Download the Instant Game archive</Trans>}\n              />\n            )}\n          </BlobDownloadUrlHolder>\n        )}\n      />\n    );\n  },\n};\n","// @flow\nimport { type Exporter } from '../ExportDialog';\nimport { browserOnlineCordovaExportPipeline } from './BrowserOnlineCordovaExport';\nimport { browserOnlineElectronExportPipeline } from './BrowserOnlineElectronExport';\nimport { browserOnlineWebExportPipeline } from './BrowserOnlineWebExport';\nimport { browserHTML5ExportPipeline } from './BrowserHTML5Export';\nimport { browserCordovaExportPipeline } from './BrowserCordovaExport';\nimport { browserElectronExportPipeline } from './BrowserElectronExport';\nimport { browserFacebookInstantGamesExportPipeline } from './BrowserFacebookInstantGamesExport';\nimport { cordovaExporter } from '../GenericExporters/CordovaExport';\nimport { onlineWebExporter } from '../GenericExporters/OnlineWebExport';\nimport { html5Exporter } from '../GenericExporters/HTML5Export';\nimport { facebookInstantGamesExporter } from '../GenericExporters/FacebookInstantGamesExport';\nimport { onlineCordovaExporter } from '../GenericExporters/OnlineCordovaExport';\nimport { onlineElectronExporter } from '../GenericExporters/OnlineElectronExport';\nimport { electronExporter } from '../GenericExporters/ElectronExport';\n\nexport const browserOnlineWebExporter: Exporter = {\n  ...onlineWebExporter,\n  exportPipeline: browserOnlineWebExportPipeline,\n};\n\nexport const browserAutomatedExporters: Array<Exporter> = [\n  {\n    ...html5Exporter,\n    exportPipeline: browserHTML5ExportPipeline,\n  },\n  {\n    ...onlineCordovaExporter,\n    exportPipeline: browserOnlineCordovaExportPipeline,\n  },\n  {\n    ...onlineElectronExporter,\n    exportPipeline: browserOnlineElectronExportPipeline,\n  },\n  {\n    ...facebookInstantGamesExporter,\n    exportPipeline: browserFacebookInstantGamesExportPipeline,\n  },\n];\n\nexport const browserManualExporters: Array<Exporter> = [\n  {\n    ...html5Exporter,\n    exportPipeline: browserHTML5ExportPipeline,\n  },\n  {\n    ...cordovaExporter,\n    exportPipeline: browserCordovaExportPipeline,\n  },\n  {\n    ...electronExporter,\n    exportPipeline: browserElectronExportPipeline,\n  },\n];\n","// @flow\nimport {\n  type JsExtensionsLoader,\n  type ExtensionLoadingResult,\n  type TranslationFunction,\n  loadExtension,\n} from '.';\nimport ObjectsEditorService from '../ObjectEditor/ObjectsEditorService';\nimport ObjectsRenderingService from '../ObjectsRendering/ObjectsRenderingService';\nconst gd: libGDevelop = global.gd;\n\n// The list of \"JsExtension.js\" files to be bundled in the webapp, keyed by their extension name.\nconst jsExtensions = [\n  {\n    name: 'AdMob',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/AdMob/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'AdvancedWindow',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/AdvancedWindow/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'FacebookInstantGames',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/FacebookInstantGames/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'DeviceSensors',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/DeviceSensors/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'DeviceVibration',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/DeviceVibration/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'DebuggerTools',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/DebuggerTools/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'Physics2',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/Physics2Behavior/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'ExampleJsExtension',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/ExampleJsExtension/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'Tween',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/TweenBehavior/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'Video',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/Video/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'FileSystem',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/FileSystem/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'Firebase',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/Firebase/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'Leaderboards',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/Leaderboards/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'PlayerAuthentication',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/PlayerAuthentication/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'DialogueTree',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/DialogueTree/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'BBText',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/BBText/JsExtension.js'),\n    objectsRenderingServiceModules: {\n      // $FlowExpectedError - this path is ignored for Flow.\n      'pixi-multistyle-text/dist/pixi-multistyle-text.umd': require('GDJS-for-web-app-only/Runtime/Extensions/BBText/pixi-multistyle-text/dist/pixi-multistyle-text.umd'),\n    },\n  },\n  {\n    name: 'TileMap',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/TileMap/JsExtension.js'),\n    objectsRenderingServiceModules: {\n      // $FlowExpectedError - this path is ignored for Flow.\n      'pixi-tilemap/dist/pixi-tilemap.umd': require('GDJS-for-web-app-only/Runtime/Extensions/TileMap/pixi-tilemap/dist/pixi-tilemap.umd'),\n      // $FlowExpectedError - this path is ignored for Flow.\n      'helper/TileMapHelper': require('GDJS-for-web-app-only/Runtime/Extensions/TileMap/helper/TileMapHelper.js'),\n      // $FlowExpectedError - this path is ignored for Flow.\n      'pako/dist/pako.min': require('GDJS-for-web-app-only/Runtime/Extensions/TileMap/pako/dist/pako.min'),\n    },\n  },\n  {\n    name: 'Effects',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/Effects/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'P2P',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/P2P/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'Lighting',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/Lighting/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'SpatialSound',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/SpatialSound/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'BitmapText',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/BitmapText/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'Screenshot',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/Screenshot/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'TextInput',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/TextInput/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n  {\n    name: 'Scene3D',\n    // $FlowExpectedError - this path is ignored for Flow.\n    extensionModule: require('GDJS-for-web-app-only/Runtime/Extensions/3D/JsExtension.js'),\n    objectsRenderingServiceModules: {},\n  },\n];\n\ntype MakeExtensionsLoaderArguments = {|\n  objectsEditorService: typeof ObjectsEditorService,\n  objectsRenderingService: typeof ObjectsRenderingService,\n  filterExamples: boolean,\n|};\n\n/**\n * Loader that load all JS extensions required in this file.\n * Extensions are usually auto-discovered when declared in Extensions/xxx/JsExtension.js, but not\n * for the web-app where everything must be bundled.\n */\nexport default function makeExtensionsLoader({\n  objectsEditorService,\n  objectsRenderingService,\n  filterExamples,\n}: MakeExtensionsLoaderArguments): JsExtensionsLoader {\n  return {\n    loadAllExtensions(\n      _: TranslationFunction\n    ): Promise<\n      Array<{ extensionModulePath: string, result: ExtensionLoadingResult }>\n    > {\n      return Promise.resolve(\n        jsExtensions\n          .filter(({ name }) => !filterExamples || !name.includes('Example'))\n          .map(({ name, extensionModule, objectsRenderingServiceModules }) => {\n            // Load any editor for objects, if we have somewhere where\n            // to register them.\n            if (\n              objectsEditorService &&\n              extensionModule.registerEditorConfigurations\n            ) {\n              extensionModule.registerEditorConfigurations(\n                objectsEditorService\n              );\n            }\n\n            // Register modules for ObjectsRenderingService\n            if (objectsRenderingService && objectsRenderingServiceModules) {\n              for (let requirePath in objectsRenderingServiceModules) {\n                objectsRenderingService.registerModule(\n                  requirePath,\n                  objectsRenderingServiceModules[requirePath]\n                );\n              }\n            }\n\n            // Load any renderer for objects, if we have somewhere where\n            // to register them.\n            if (\n              objectsRenderingService &&\n              extensionModule.registerInstanceRenderers\n            ) {\n              extensionModule.registerInstanceRenderers(\n                objectsRenderingService\n              );\n            }\n\n            return {\n              extensionModulePath: 'internal-extension://' + name,\n              result: loadExtension(\n                _,\n                gd,\n                gd.JsPlatform.get(),\n                extensionModule\n              ),\n            };\n          })\n      );\n    },\n  };\n}\n","// @flow\nimport {\n  type EventsFunctionCodeWriter,\n  type EventsFunctionCodeWriterCallbacks,\n} from '..';\nimport { uploadObject, getBaseUrl } from '../../Utils/GDevelopServices/Preview';\nimport { makeTimestampedId } from '../../Utils/TimestampedId';\nimport slugs from 'slugs';\n\n/**\n * Create the EventsFunctionCodeWriter that writes generated code for events functions\n * to temporary S3 files.\n */\nexport const makeBrowserS3EventsFunctionCodeWriter = ({\n  onWriteFile,\n}: EventsFunctionCodeWriterCallbacks): EventsFunctionCodeWriter => {\n  const prefix = makeTimestampedId();\n  const getPathFor = (codeNamespace: string) => {\n    return `${prefix}/${slugs(codeNamespace)}.js`;\n  };\n\n  return {\n    getIncludeFileFor: (codeNamespace: string) =>\n      getBaseUrl() + getPathFor(codeNamespace),\n    writeFunctionCode: (\n      functionCodeNamespace: string,\n      code: string\n    ): Promise<void> => {\n      const key = getPathFor(functionCodeNamespace);\n      onWriteFile({ includeFile: key, content: code });\n      console.log(`Uploading function generated code to ${key}...`);\n      return uploadObject({\n        Key: getPathFor(functionCodeNamespace),\n        Body: code,\n        ContentType: 'text/javascript',\n      });\n    },\n    writeBehaviorCode: (\n      behaviorCodeNamespace: string,\n      code: string\n    ): Promise<void> => {\n      const key = getPathFor(behaviorCodeNamespace);\n      onWriteFile({ includeFile: key, content: code });\n      console.log(`Uploading behavior generated code to ${key}...`);\n      return uploadObject({\n        Key: getPathFor(behaviorCodeNamespace),\n        Body: code,\n        ContentType: 'text/javascript',\n      });\n    },\n    writeObjectCode: (\n      objectCodeNamespace: string,\n      code: string\n    ): Promise<void> => {\n      const key = getPathFor(objectCodeNamespace);\n      onWriteFile({ includeFile: key, content: code });\n      console.log(`Uploading object generated code to ${key}...`);\n      return uploadObject({\n        Key: getPathFor(objectCodeNamespace),\n        Body: code,\n        ContentType: 'text/javascript',\n      });\n    },\n  };\n};\n","import React from 'react';\nimport SvgIcon from '@material-ui/core/SvgIcon';\n\nexport default React.memo(props => (\n  <SvgIcon {...props}>\n    <path d=\"M7.71,3.5L1.15,15L4.58,21L11.13,9.5M9.73,15L6.3,21H19.42L22.85,15M22.28,14L15.42,2H8.58L8.57,2L15.43,14H22.28Z\" />\n  </SvgIcon>\n));\n","// @flow\nimport { Trans } from '@lingui/macro';\nimport { t } from '@lingui/macro';\nimport * as React from 'react';\nimport RaisedButton from '../../UI/RaisedButton';\nimport TextField from '../../UI/TextField';\nimport { type GoogleDriveFileOrFolder } from '.';\n\ntype Props = {|\n  floatingLabelText: React.Node,\n  value: ?GoogleDriveFileOrFolder,\n  onOpenPicker: () => void,\n|};\n\nconst styles = {\n  container: {\n    position: 'relative',\n    display: 'flex',\n    alignItems: 'baseline',\n    width: '100%',\n  },\n  button: {\n    marginLeft: 10,\n  },\n  textField: {\n    flex: 1,\n  },\n};\n\nconst GoogleDriveFileOrFolderPicker = (props: Props) => {\n  return (\n    <div\n      style={{\n        ...styles.container,\n      }}\n    >\n      <TextField\n        style={styles.textField}\n        floatingLabelText={props.floatingLabelText}\n        floatingLabelFixed\n        type=\"text\"\n        translatableHintText={t`Choose a file or folder`}\n        value={props.value ? props.value.name : ''}\n        onChange={() => {}}\n      />\n      <RaisedButton\n        label={<Trans>Choose...</Trans>}\n        primary\n        style={styles.button}\n        onClick={props.onOpenPicker}\n      />\n    </div>\n  );\n};\n\nexport default GoogleDriveFileOrFolderPicker;\n","// @flow\nimport { t } from '@lingui/macro';\nimport { Trans } from '@lingui/macro';\nimport * as React from 'react';\nimport Dialog, { DialogPrimaryButton } from '../../UI/Dialog';\nimport FlatButton from '../../UI/FlatButton';\nimport { Column, Line } from '../../UI/Grid';\nimport GoogleDriveFileOrFolderPicker from './GoogleDriveFileOrFolderPicker';\nimport {\n  type GoogleDriveFileOrFolder,\n  type GoogleDriveFilePickerOptions,\n} from '.';\nimport TextField from '../../UI/TextField';\nimport LeftLoader from '../../UI/LeftLoader';\nimport AlertMessage from '../../UI/AlertMessage';\n\ntype Props = {|\n  onCancel: () => void,\n  onSave: ({|\n    selectedFileOrFolder: GoogleDriveFileOrFolder,\n    newFileName: string,\n  |}) => Promise<void>,\n  onShowFilePicker: GoogleDriveFilePickerOptions => Promise<?GoogleDriveFileOrFolder>,\n|};\n\n/**\n * A \"Save as\" dialog for Google Drive, allowing to pick a file to overwrite or a folder\n * and a new filename where to save the game.\n */\nconst GoogleDriveSaveAsDialog = (props: Props) => {\n  const [selectedFileOrFolder, setSelectedFileOrFolder] = React.useState(\n    (null: ?GoogleDriveFileOrFolder)\n  );\n  const [newFileName, setNewFileName] = React.useState('');\n  const [saving, setSaving] = React.useState(false);\n  const [saveError, setSaveError] = React.useState((null: ?Error));\n  const [pickerError, setPickerError] = React.useState((null: ?Error));\n  const [dialogHidden, hideDialog] = React.useState(false);\n\n  const canSave = () => {\n    if (saving) return;\n    if (!selectedFileOrFolder) return;\n\n    return selectedFileOrFolder.type === 'FOLDER' ? !!newFileName : true;\n  };\n  const save = () => {\n    if (!canSave() || !selectedFileOrFolder) return;\n\n    setSaveError(null);\n    setSaving(true);\n    props\n      .onSave({\n        selectedFileOrFolder,\n        newFileName,\n      })\n      .catch(error => {\n        setSaveError(error);\n        setSaving(false);\n      });\n  };\n  const canCancel = () => !saving;\n  const cancel = () => {\n    if (!canCancel()) return;\n\n    props.onCancel();\n  };\n  const openPicker = () => {\n    hideDialog(true);\n    setPickerError(null);\n    props\n      .onShowFilePicker({ selectFolderEnabled: true, showUploadView: false })\n      .then(selectedFileOrFolder => {\n        setSelectedFileOrFolder(selectedFileOrFolder);\n        hideDialog(false);\n      })\n      .catch(error => {\n        setPickerError(error);\n        hideDialog(false);\n      });\n  };\n\n  // Hide the dialog while the picker is opened, as it does not play nice with material-ui's\n  // Dialog.\n  if (dialogHidden) {\n    return null;\n  }\n\n  return (\n    <Dialog\n      title={<Trans>Save on Google Drive</Trans>}\n      actions={[\n        <FlatButton\n          key=\"cancel\"\n          label={<Trans>Cancel</Trans>}\n          primary={false}\n          disabled={!canCancel()}\n          onClick={props.onCancel}\n        />,\n        <LeftLoader key=\"save\" isLoading={saving}>\n          <DialogPrimaryButton\n            label={<Trans>Save</Trans>}\n            primary\n            disabled={!canSave()}\n            onClick={save}\n          />\n        </LeftLoader>,\n      ]}\n      cannotBeDismissed={saving}\n      onRequestClose={cancel}\n      onApply={save}\n      open\n      maxWidth=\"sm\"\n    >\n      <Column noMargin>\n        <Line>\n          <GoogleDriveFileOrFolderPicker\n            floatingLabelText={\n              <Trans>Google Drive folder or existing file to overwrite</Trans>\n            }\n            value={selectedFileOrFolder}\n            onOpenPicker={openPicker}\n          />\n        </Line>\n        <Line>\n          {selectedFileOrFolder && selectedFileOrFolder.type === 'FOLDER' ? (\n            <TextField\n              floatingLabelText={<Trans>New file name</Trans>}\n              floatingLabelFixed\n              type=\"text\"\n              translatableHintText={t`YourGame.json`}\n              value={newFileName}\n              onChange={(event, newFileName) => setNewFileName(newFileName)}\n              fullWidth\n            />\n          ) : null}\n        </Line>\n        {saveError && (\n          <Line>\n            <AlertMessage kind=\"error\">\n              There was an error when saving your game. Verify that you have the\n              rights on the folder or file that you selected and try again.\n            </AlertMessage>\n          </Line>\n        )}\n        {pickerError && (\n          <Line>\n            <AlertMessage kind=\"error\">\n              There was an error when selecting a file or folder from Google\n              Drive. Try again later or verify that you are properly connected\n              to Google Drive.\n            </AlertMessage>\n          </Line>\n        )}\n      </Column>\n    </Dialog>\n  );\n};\n\nexport default GoogleDriveSaveAsDialog;\n","// @flow\nimport { t } from '@lingui/macro';\nimport * as React from 'react';\nimport {\n  type StorageProvider,\n  type FileMetadata,\n  type SaveAsLocation,\n} from '../index';\nimport { serializeToJSON } from '../../Utils/Serializer';\nimport GoogleDrive from '../../UI/CustomSvgIcons/GoogleDrive';\nimport GoogleDriveSaveAsDialog from './GoogleDriveSaveAsDialog';\nimport { type MessageDescriptor } from '../../Utils/i18n/MessageDescriptor.flow';\nimport { type AppArguments } from '../../Utils/Window';\nimport { loadScript } from '../../Utils/LoadScript';\nconst isDev = process.env.NODE_ENV === 'development';\n\nconst DEVELOPER_KEY = isDev\n  ? 'AIzaSyDH3UNpxzIpcTyd6aMCWI5oNFSptG_BhOc'\n  : 'AIzaSyDJYQmzLCfjXnNImDa1X_cDTWjl2BOrcM4';\nconst CLIENT_ID = isDev\n  ? '28563107180-bd29h9f3og4h1632m94nv6hat2igrej6.apps.googleusercontent.com'\n  : '44882707384-3t4tubr3fbht87sbtdp7u5mlo45k5uku.apps.googleusercontent.com';\nconst APP_ID = isDev ? '28563107180' : '44882707384'; // This is the first part of CLIENT_ID.\nconst DISCOVERY_DOCS = [\n  'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest',\n];\nconst SCOPE =\n  'https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/drive.install';\n\nlet apisLoaded = false;\nlet apisLoadingPromise = null;\n\n/**\n * Load Google Drive APIs. Return a fulfilled promise when done.\n */\nconst initializeApis = (): Promise<void> => {\n  if (apisLoaded) {\n    return Promise.resolve();\n  }\n\n  if (apisLoadingPromise) {\n    // Only do a single initialization attempt at a given time.\n    return apisLoadingPromise;\n  }\n\n  apisLoadingPromise = loadScript('https://apis.google.com/js/api:client.js')\n    .then(() => {\n      const gapi = global.gapi;\n      if (!gapi) {\n        throw new Error(\n          'No gapi global object found after loading Google Drive API script'\n        );\n      }\n\n      return new Promise((resolve, reject) => {\n        gapi.load('client:auth2:picker', {\n          callback: () => {\n            const auth2LoadPromise = gapi.auth2.init({\n              apiKey: DEVELOPER_KEY,\n              clientId: CLIENT_ID,\n              discoveryDocs: DISCOVERY_DOCS,\n              scope: SCOPE,\n            });\n\n            gapi.client.setApiKey(DEVELOPER_KEY);\n            const driveLoadPromise = gapi.client.load('drive', 'v3');\n\n            resolve(Promise.all([auth2LoadPromise, driveLoadPromise]));\n          },\n          onerror: () => {\n            reject(\n              new Error(\n                'Unable to load auth2 and picker APIs for Google Drive.'\n              )\n            );\n          },\n        });\n      });\n    })\n    .then(() => {\n      apisLoaded = true;\n      apisLoadingPromise = null;\n    })\n    .catch(error => {\n      console.error('Error while loading Google Drive APIs:', error);\n      apisLoadingPromise = null;\n\n      throw error;\n    });\n\n  return apisLoadingPromise;\n};\n\ntype GoogleUser = {\n  getAuthResponse: () => { access_token: string, error?: ?Error },\n};\n\nlet isAuthenticated = false;\n\n/**\n * Sign in the user to Google Drive, returning the user object after a successful sign up\n * (or if the user is already signed in).\n */\nexport const authenticate = (): Promise<GoogleUser> => {\n  return initializeApis().then(() => {\n    const gapi = global.gapi;\n    const googleAuth = gapi.auth2.getAuthInstance();\n    if (isAuthenticated && googleAuth.isSignedIn.get()) {\n      return googleAuth.currentUser.get();\n    }\n\n    isAuthenticated = false;\n    googleAuth.isSignedIn.listen(authenticated => {\n      console.info('Authenticated with Google APIs: ', authenticated);\n      isAuthenticated = authenticated;\n    });\n    return googleAuth\n      .signIn({ scope: SCOPE })\n      .then((googleUser: GoogleUser) => {\n        if (\n          !googleUser.getAuthResponse() ||\n          googleUser.getAuthResponse().error\n        ) {\n          console.error(\n            'OAuth2 error while sign in:',\n            googleUser.getAuthResponse()\n              ? googleUser.getAuthResponse().error\n              : 'No AuthResponse'\n          );\n          throw new Error('Authentication error');\n        }\n\n        isAuthenticated = true;\n        return googleUser;\n      });\n  });\n};\n\n/**\n * Update a JSON file, given its file id.\n */\nexport const patchJsonFile = (\n  fileId: string,\n  googleUser: GoogleUser,\n  content: string\n): Promise<void> => {\n  return fetch(`https://www.googleapis.com/upload/drive/v3/files/${fileId}`, {\n    method: 'PATCH',\n    headers: new Headers({\n      Authorization: `Bearer ${googleUser.getAuthResponse().access_token}`,\n      'Content-Type': 'application/json',\n    }),\n    body: content,\n  }).then(res => {\n    if (res.status !== 200) {\n      if (res.status === 401) {\n        isAuthenticated = false;\n      }\n\n      throw res;\n    }\n  });\n};\n\n/**\n * Create a new empty JSON file, returning its fileid.\n */\nexport const createNewJsonFile = (\n  parentId: string,\n  name: string\n): Promise<string> => {\n  const gapi = global.gapi;\n\n  return gapi.client.drive.files\n    .create({\n      'content-type': 'application/json',\n      uploadType: 'multipart',\n      name: name,\n      parents: [parentId],\n      mimeType: 'application/json',\n      fields: 'id, name, kind, size',\n    })\n    .then(apiResponse => {\n      return apiResponse.result.id;\n    });\n};\n\n/**\n * Information about a file or folder picked by the user.\n */\nexport type GoogleDriveFileOrFolder =\n  | {|\n      type: 'FOLDER',\n      id: string,\n      name: string,\n    |}\n  | {|\n      type: 'FILE',\n      id: string,\n      name: string,\n      parentId: string,\n    |};\n\nexport type GoogleDriveFilePickerOptions = {|\n  selectFolderEnabled: boolean,\n  showUploadView: boolean,\n|};\n\n/**\n * Display a file picker as a modal, resolving with the selected file or folder,\n * if any.\n *\n * The picker dialog is not playing nice with material-ui dialogs or overlays. They should\n * not be displayed when the picker is on screen.\n */\nconst showFilePicker = ({\n  selectFolderEnabled,\n  showUploadView,\n}: GoogleDriveFilePickerOptions): Promise<?GoogleDriveFileOrFolder> => {\n  return authenticate().then(googleUser => {\n    const google = global.google;\n\n    return new Promise(resolve => {\n      let picker = null;\n      const pickerBuilder = new google.picker.PickerBuilder()\n        .addView(\n          new google.picker.DocsView()\n            .setIncludeFolders(true)\n            .setSelectFolderEnabled(selectFolderEnabled)\n        )\n        .setOAuthToken(googleUser.getAuthResponse().access_token)\n        .setDeveloperKey(DEVELOPER_KEY)\n        .setAppId(APP_ID) // App ID is required to correctly identify files created with the app.\n        .setCallback(data => {\n          if (\n            data[google.picker.Response.ACTION] === google.picker.Action.PICKED\n          ) {\n            const doc = data[google.picker.Response.DOCUMENTS][0];\n            const id: string = doc[google.picker.Document.ID];\n            const name: string = doc[google.picker.Document.NAME];\n            const parentId: string = doc[google.picker.Document.PARENT_ID];\n            if (\n              doc[google.picker.Document.TYPE] ===\n                google.picker.Type.LOCATION ||\n              doc[google.picker.Document.MIME_TYPE] ===\n                'application/vnd.google-apps.folder'\n            ) {\n              resolve({ id, name, type: 'FOLDER' });\n            } else {\n              resolve({ id, name, type: 'FILE', parentId });\n            }\n            if (picker) picker.dispose();\n          } else if (\n            data[google.picker.Response.ACTION] === google.picker.Action.CANCEL\n          ) {\n            resolve(null);\n            if (picker) picker.dispose();\n          }\n        });\n      if (showUploadView) {\n        pickerBuilder.addView(\n          new google.picker.DocsUploadView().setIncludeFolders(true)\n        );\n      }\n\n      picker = pickerBuilder.build();\n\n      picker.setVisible(true);\n      const pickerElements = document.getElementsByClassName('picker-dialog');\n      for (var i = 0; i < pickerElements.length; ++i) {\n        pickerElements[i].style.zIndex = '5000'; // Higher than Material UI modals\n      }\n    });\n  });\n};\n\n/**\n * A storage that is using Google Drive to open and store files.\n */\nexport default ({\n  internalName: 'GoogleDrive',\n  name: t`Google Drive`,\n  renderIcon: props => <GoogleDrive fontSize={props.size} />,\n  getFileMetadataFromAppArguments: (appArguments: AppArguments) => {\n    if (appArguments.state) {\n      try {\n        // See \"state\" argument passed by Google Drive API:\n        // https://developers.google.com/drive/api/v3/enable-sdk#construct\n        const googleDriveState = JSON.parse(appArguments.state);\n        if (googleDriveState.ids && googleDriveState.ids[0]) {\n          return {\n            fileIdentifier: googleDriveState.ids[0],\n          };\n        }\n      } catch (e) {\n        console.warn(\n          \"Error while trying to parse the Google Drive 'ids' in 'state' from the app arguments.\"\n        );\n      }\n    }\n\n    return null;\n  },\n  createOperations: ({ setDialog, closeDialog }) => {\n    initializeApis().catch(() => {\n      // Ignore error as we'll retry later.\n    });\n\n    return {\n      doesInitialOpenRequireUserInteraction: true, // Authentication will open a popup, requiring user interaction\n      onOpen: (\n        fileMetadata: FileMetadata\n      ): Promise<{|\n        content: Object,\n      |}> => {\n        const fileId = fileMetadata.fileIdentifier;\n\n        return authenticate()\n          .then(googleUser =>\n            fetch(\n              `https://www.googleapis.com/drive/v3/files/${fileId}?alt=media`,\n              {\n                method: 'GET',\n                headers: new Headers({\n                  Authorization: `Bearer ${\n                    googleUser.getAuthResponse().access_token\n                  }`,\n                }),\n              }\n            )\n          )\n          .then(\n            response => {\n              return response.text().then(\n                fileContent => {\n                  return new Promise((resolve, reject) => {\n                    try {\n                      const dataObject = JSON.parse(fileContent);\n                      return resolve({\n                        content: dataObject,\n                      });\n                    } catch (ex) {\n                      return reject(fileId + ' is a corrupted/malformed file.');\n                    }\n                  });\n                },\n                error => {\n                  console.error(\n                    'Error while reading the file from Google Drive API: ',\n                    error\n                  );\n                  throw error;\n                }\n              );\n            },\n            error => {\n              console.error(\n                'Error while fetching the file from Google Drive API: ',\n                error\n              );\n              throw error;\n            }\n          );\n      },\n      onOpenWithPicker: (): Promise<?FileMetadata> => {\n        return authenticate()\n          .then(googleUser =>\n            showFilePicker({ selectFolderEnabled: false, showUploadView: true })\n          )\n          .then(googleDriveFileOrFolder => {\n            if (!googleDriveFileOrFolder) {\n              return null;\n            }\n\n            return {\n              fileIdentifier: googleDriveFileOrFolder.id,\n            };\n          });\n      },\n      onSaveProject: (project: gdProject, fileMetadata: FileMetadata) => {\n        const fileId = fileMetadata.fileIdentifier;\n        const newFileMetadata = {\n          ...fileMetadata,\n          lastModifiedDate: Date.now(),\n        };\n\n        const content = serializeToJSON(project);\n        return authenticate()\n          .then(googleUser => patchJsonFile(fileId, googleUser, content))\n          .then(() => ({\n            wasSaved: true,\n            fileMetadata: newFileMetadata,\n          }));\n      },\n      onChooseSaveProjectAsLocation: ({\n        project,\n        fileMetadata,\n      }: {|\n        project: gdProject,\n        fileMetadata: ?FileMetadata,\n      |}) => {\n        return new Promise(resolve => {\n          setDialog(() => (\n            <GoogleDriveSaveAsDialog\n              onShowFilePicker={showFilePicker}\n              onCancel={() => {\n                closeDialog();\n                resolve({ saveAsLocation: null });\n              }}\n              onSave={async ({ selectedFileOrFolder, newFileName }) => {\n                await authenticate();\n                if (selectedFileOrFolder.type === 'FOLDER') {\n                  const newFileId = await createNewJsonFile(\n                    selectedFileOrFolder.id,\n                    newFileName\n                  );\n                  resolve({\n                    saveAsLocation: {\n                      fileIdentifier: newFileId,\n                    },\n                  });\n                } else {\n                  resolve({\n                    saveAsLocation: {\n                      fileIdentifier: selectedFileOrFolder.id,\n                    },\n                  });\n                }\n              }}\n            />\n          ));\n        });\n      },\n      onSaveProjectAs: async (\n        project: gdProject,\n        saveAsLocation: ?SaveAsLocation,\n        options\n      ) => {\n        if (!saveAsLocation)\n          throw new Error('A location was not chosen before saving as.');\n        const { fileIdentifier } = saveAsLocation;\n        if (!fileIdentifier)\n          throw new Error('A file was not chosen before saving as.');\n\n        const content = serializeToJSON(project);\n        options.onStartSaving();\n\n        const googleUser = await authenticate();\n        const newFileMetadata = { fileIdentifier };\n        await options.onMoveResources({ newFileMetadata });\n        await patchJsonFile(fileIdentifier, googleUser, content);\n\n        closeDialog();\n        return {\n          wasSaved: true,\n          fileMetadata: newFileMetadata,\n        };\n      },\n      getOpenErrorMessage: (error: Error): MessageDescriptor => {\n        if (!apisLoaded) {\n          return t`Google Drive could not be loaded. Check that you are not offline and have a proper internet connection, then try again.`;\n        }\n\n        return t`Check that you don't have any blocked popup (if so, allow them and retry) and that you have the authorization for reading the file you're trying to access.`;\n      },\n    };\n  },\n}: StorageProvider);\n","// @flow\nimport { Trans } from '@lingui/macro';\nimport * as React from 'react';\nimport Dialog from '../../UI/Dialog';\nimport FlatButton from '../../UI/FlatButton';\nimport RaisedButton from '../../UI/RaisedButton';\nimport { Line } from '../../UI/Grid';\nimport { ColumnStackLayout } from '../../UI/Layout';\nimport Window from '../../Utils/Window';\nimport {\n  BlobDownloadUrlHolder,\n  openBlobDownloadUrl,\n} from '../../Utils/BlobDownloadUrlHolder';\nimport PlaceholderLoader from '../../UI/PlaceholderLoader';\nimport { serializeToJSObject } from '../../Utils/Serializer';\nimport { showErrorBox } from '../../UI/Messages/MessageBox';\nimport Text from '../../UI/Text';\nimport {\n  downloadUrlsToBlobs,\n  type ItemResult,\n} from '../../Utils/BlobDownloader';\nimport { useGenericRetryableProcessWithProgress } from '../../Utils/UseGenericRetryableProcessWithProgress';\nimport { checkIfIsGDevelopCloudBucketUrl } from '../../Utils/CrossOrigin';\nimport { extractFilenameFromProjectResourceUrl } from '../../Utils/GDevelopServices/Project';\nimport {\n  archiveFiles,\n  type BlobFileDescriptor,\n  type TextFileDescriptor,\n} from '../../Utils/BrowserArchiver';\nimport path from 'path-browserify';\nimport newNameGenerator from '../../Utils/NewNameGenerator';\nconst gd: libGDevelop = global.gd;\n\nconst PROJECT_JSON_FILENAME = 'game.json';\n\n// For some reason, `path.posix` is undefined when packaged\n// with webpack, so we're using `path` directly. As it's for the web-app,\n// it should always be the posix version. In tests on Windows,\n// it's necessary to use path.posix.\n// Search for \"pathPosix\" in the codebase for other places where this is used.\nconst pathPosix = path.posix || path;\n\nconst isURL = (filename: string) => {\n  return (\n    filename.startsWith('http://') ||\n    filename.startsWith('https://') ||\n    filename.startsWith('ftp://') ||\n    filename.startsWith('blob:') ||\n    filename.startsWith('data:')\n  );\n};\n\ntype DownloadResourcesAsBlobsOptionsWithoutProgress = {\n  project: gdProject,\n  onAddBlobFile: (blobFileDescriptor: BlobFileDescriptor) => void,\n};\n\ntype DownloadResourcesAsBlobsOptions = {\n  ...DownloadResourcesAsBlobsOptionsWithoutProgress,\n  onProgress: (count: number, total: number) => void,\n};\n\nexport const downloadResourcesAsBlobs = async ({\n  project,\n  onAddBlobFile,\n  onProgress,\n}: DownloadResourcesAsBlobsOptions) => {\n  const result = {\n    erroredResources: [],\n  };\n\n  type ResourceToFetch = {|\n    resource: gdResource,\n    url: string,\n    filename: string,\n  |};\n\n  const getResourcesToFetch = (project: gdProject): Array<ResourceToFetch> => {\n    const resourcesManager = project.getResourcesManager();\n    const allResourceNames = resourcesManager.getAllResourceNames().toJSArray();\n    return allResourceNames\n      .map(\n        (resourceName: string): ?ResourceToFetch => {\n          const resource = resourcesManager.getResource(resourceName);\n          const resourceFile = resource.getFile();\n\n          if (isURL(resourceFile)) {\n            if (checkIfIsGDevelopCloudBucketUrl(resourceFile)) {\n              return {\n                resource,\n                url: resourceFile,\n                filename: extractFilenameFromProjectResourceUrl(resourceFile),\n              };\n            } else {\n              // Public URL resource: nothing to do.\n              return null;\n            }\n          } else {\n            // Local resource: unsupported.\n            result.erroredResources.push({\n              resourceName: resource.getName(),\n              error: new Error(\n                'Unsupported relative file when downloading a copy.'\n              ),\n            });\n            return null;\n          }\n        }\n      )\n      .filter(Boolean);\n  };\n\n  const resourcesToFetchAndUpload = getResourcesToFetch(project);\n\n  // Download all the project resources as blob (much like what is done during an export).\n  const downloadedBlobsAndResources: Array<\n    ItemResult<ResourceToFetch>\n  > = await downloadUrlsToBlobs({\n    urlContainers: resourcesToFetchAndUpload,\n    onProgress: (count, total) => {\n      onProgress(count, total * 2);\n    },\n  });\n\n  const alreadyUsedFilenames = new Set([PROJECT_JSON_FILENAME]);\n\n  downloadedBlobsAndResources.forEach(({ item, error, blob }) => {\n    const { resource, filename } = item;\n    if (error || !blob) {\n      result.erroredResources.push({\n        resourceName: resource.getName(),\n        error: error || new Error('Unknown error during download.'),\n      });\n      return;\n    }\n\n    // Ensure each filename is unique, and sort resources in folder by types.\n    const extension = pathPosix.extname(filename);\n    const basename = pathPosix.basename(filename, extension);\n    const pathPrefix = 'assets/' + resource.getKind();\n    const newBasename = newNameGenerator(basename, tentativeBasename =>\n      alreadyUsedFilenames.has(\n        pathPosix.join(pathPrefix, tentativeBasename + extension)\n      )\n    );\n    const newResourcePath = pathPosix.join(pathPrefix, newBasename + extension);\n    alreadyUsedFilenames.add(newResourcePath);\n\n    resource.setFile(newResourcePath);\n    onAddBlobFile({ blob, filePath: newResourcePath });\n  });\n\n  return result;\n};\n\ntype Props = {|\n  project: gdProject,\n  onDone: () => void,\n|};\n\nexport default function DownloadFileSaveAsDialog({ project, onDone }: Props) {\n  const [zippedProjectBlob, setZippedProjectBlob] = React.useState<?Blob>(null);\n  const {\n    ensureProcessIsDone,\n    renderProcessDialog,\n  } = useGenericRetryableProcessWithProgress<DownloadResourcesAsBlobsOptionsWithoutProgress>(\n    {\n      onDoProcess: React.useCallback(\n        (options, onProgress) =>\n          downloadResourcesAsBlobs({ ...options, onProgress }),\n        []\n      ),\n    }\n  );\n  React.useEffect(\n    () => {\n      (async () => {\n        setZippedProjectBlob(null);\n        const newProject = gd.ProjectHelper.createNewGDJSProject();\n        try {\n          // Make a copy of the project, as it will be updated.\n          const serializedProject = new gd.SerializerElement();\n          project.serializeTo(serializedProject);\n          newProject.unserializeFrom(serializedProject);\n          serializedProject.delete();\n\n          // Download resources to blobs, and update the project resources.\n          const blobFiles: Array<BlobFileDescriptor> = [];\n          const textFiles: Array<TextFileDescriptor> = [];\n          await ensureProcessIsDone({\n            project: newProject,\n            onAddBlobFile: (blobFileDescriptor: BlobFileDescriptor) => {\n              blobFiles.push(blobFileDescriptor);\n            },\n          });\n\n          // Serialize the project.\n          textFiles.push({\n            text: JSON.stringify(serializeToJSObject(newProject)),\n            filePath: PROJECT_JSON_FILENAME,\n          });\n\n          // Archive the whole project.\n          const zippedProjectBlob = await archiveFiles({\n            textFiles,\n            blobFiles,\n            basePath: '/',\n            onProgress: (count: number, total: number) => {},\n          });\n          setZippedProjectBlob(zippedProjectBlob);\n        } catch (rawError) {\n          showErrorBox({\n            message:\n              'Unable to save your project because of an internal error.',\n            rawError,\n            errorId: 'download-file-save-as-dialog-error',\n          });\n          return;\n        } finally {\n          newProject.delete();\n        }\n      })();\n      return () => setZippedProjectBlob(null);\n    },\n    [project, ensureProcessIsDone]\n  );\n\n  return (\n    <Dialog\n      title={<Trans>Download a copy</Trans>}\n      actions={[\n        <FlatButton\n          key=\"download\"\n          label={<Trans>Download SpeXEngine desktop version</Trans>}\n          primary={false}\n          onClick={() => Window.openExternalURL('http://gdevelop.io')}\n        />,\n        <FlatButton\n          key=\"close\"\n          label={<Trans>Close</Trans>}\n          primary={false}\n          onClick={onDone}\n        />,\n      ]}\n      onRequestClose={onDone}\n      open\n      maxWidth=\"sm\"\n    >\n      <ColumnStackLayout noMargin>\n        <Text>\n          <Trans>\n            You can download the file of your game to continue working on it\n            using the full SpeXEngine version:\n          </Trans>\n        </Text>\n        <Line noMargin expand justifyContent=\"center\">\n          {zippedProjectBlob ? (\n            <BlobDownloadUrlHolder blob={zippedProjectBlob}>\n              {blobDownloadUrl => (\n                <RaisedButton\n                  primary\n                  onClick={() =>\n                    openBlobDownloadUrl(blobDownloadUrl, 'gdevelop-game.zip')\n                  }\n                  label={\n                    <Trans>Download the compressed game and resources</Trans>\n                  }\n                />\n              )}\n            </BlobDownloadUrlHolder>\n          ) : (\n            <PlaceholderLoader />\n          )}\n        </Line>\n      </ColumnStackLayout>\n      {renderProcessDialog()}\n    </Dialog>\n  );\n}\n","// @flow\nimport { t } from '@lingui/macro';\nimport * as React from 'react';\nimport Download from '../../UI/CustomSvgIcons/Download';\nimport { type StorageProvider, type SaveAsLocation } from '../index';\nimport DownloadFileSaveAsDialog from './DownloadFileSaveAsDialog';\n\n/**\n * \"Storage\" allowing to download a copy of the game.\n * Used for the web-app.\n */\nexport default ({\n  internalName: 'DownloadFile',\n  name: t`Download a copy`,\n  renderIcon: props => <Download fontSize={props.size} />,\n  hiddenInOpenDialog: true,\n  createOperations: ({ setDialog, closeDialog }) => ({\n    onSaveProjectAs: async (\n      project: gdProject,\n      saveAsLocation: ?SaveAsLocation, // Unused - everything is done in memory.\n      options\n    ) => {\n      options.onStartSaving();\n\n      return new Promise(resolve => {\n        setDialog(() => (\n          <DownloadFileSaveAsDialog\n            onDone={() => {\n              closeDialog();\n              resolve({ wasSaved: false, fileMetadata: null });\n            }}\n            project={project}\n          />\n        ));\n      });\n    },\n  }),\n}: StorageProvider);\n","// @flow\nimport {\n  type ResourceMover,\n  type MoveAllProjectResourcesOptions,\n  type MoveAllProjectResourcesResult,\n  type MoveAllProjectResourcesFunction,\n} from './index';\nimport CloudStorageProvider from '../CloudStorageProvider';\nimport GoogleDriveStorageProvider from '../GoogleDriveStorageProvider';\nimport UrlStorageProvider from '../UrlStorageProvider';\nimport DownloadFileStorageProvider from '../DownloadFileStorageProvider';\nimport { checkIfIsGDevelopCloudBucketUrl } from '../../Utils/CrossOrigin';\nimport { moveAllCloudProjectResourcesToCloudProject } from '../CloudStorageProvider/CloudResourceMover';\nimport { isBlobURL, isURL } from '../../ResourcesList/ResourceUtils';\n\nconst ensureNoCloudProjectResources = async ({\n  project,\n}: MoveAllProjectResourcesOptions): Promise<MoveAllProjectResourcesResult> => {\n  const result: MoveAllProjectResourcesResult = {\n    erroredResources: [],\n  };\n  const resourcesManager = project.getResourcesManager();\n  const allResourceNames = resourcesManager.getAllResourceNames().toJSArray();\n  allResourceNames.forEach((resourceName: string) => {\n    const resource = resourcesManager.getResource(resourceName);\n    const resourceFile = resource.getFile();\n\n    if (isURL(resourceFile)) {\n      if (checkIfIsGDevelopCloudBucketUrl(resourceFile)) {\n        result.erroredResources.push({\n          resourceName: resource.getName(),\n          error: new Error(\n            'Resources uploaded to SpeXEngine Cloud are not supported on Google Drive.'\n          ),\n        });\n      } else if (isBlobURL(resourceFile)) {\n        result.erroredResources.push({\n          resourceName: resource.getName(),\n          error: new Error('Resources with Blob URLs are not supported.'),\n        });\n        return;\n      } else {\n        // Public URL resource: it works.\n        return;\n      }\n    } else {\n      // Local resource: unsupported.\n      result.erroredResources.push({\n        resourceName: resource.getName(),\n        error: new Error('Relative files in resources are not supported.'),\n      });\n      return;\n    }\n  });\n\n  return result;\n};\n\nconst moveNothing = async () => {\n  return {\n    erroredResources: [],\n  };\n};\n\nconst movers: {\n  [string]: MoveAllProjectResourcesFunction,\n} = {\n  // Moving to SpeXEngine \"Cloud\" storage:\n\n  // From a Cloud project to another, resources need to be copied\n  // (unless they are public URLs).\n  [`${CloudStorageProvider.internalName}=>${\n    CloudStorageProvider.internalName\n  }`]: moveAllCloudProjectResourcesToCloudProject,\n  // Nothing to move around when going from a project on a public URL\n  // to a cloud project (we could offer an option one day though to download\n  // and upload the URL resources on SpeXEngine Cloud).\n  [`${UrlStorageProvider.internalName}=>${\n    CloudStorageProvider.internalName\n  }`]: moveNothing,\n  // Nothing to move around when going from a project on Google Drive\n  // to a cloud project (because only public URLs are supported on Google Drive).\n  [`${GoogleDriveStorageProvider.internalName}=>${\n    CloudStorageProvider.internalName\n  }`]: moveNothing,\n\n  // Moving to \"GoogleDrive\" storage:\n\n  // Google Drive does not support SpeXEngine cloud resources, so ensure there are none.\n  [`${CloudStorageProvider.internalName}=>${\n    GoogleDriveStorageProvider.internalName\n  }`]: ensureNoCloudProjectResources,\n  // Nothing to move around when saving to a Google Drive project from a public URL\n  // (because only public URLs are supported).\n  [`${UrlStorageProvider.internalName}=>${\n    GoogleDriveStorageProvider.internalName\n  }`]: moveNothing,\n  // Nothing to move around when saving from a Google Drive project to another\n  // (because only public URLs are supported).\n  [`${GoogleDriveStorageProvider.internalName}=>${\n    GoogleDriveStorageProvider.internalName\n  }`]: moveNothing,\n\n  // Moving to \"DownloadFile\":\n\n  // Saving to \"DownloadFile\" will *not* change any resources, as it's a\n  // \"temporary save\" that is made and given to the user.\n  [`${CloudStorageProvider.internalName}=>${\n    DownloadFileStorageProvider.internalName\n  }`]: moveNothing,\n  [`${UrlStorageProvider.internalName}=>${\n    DownloadFileStorageProvider.internalName\n  }`]: moveNothing,\n  [`${GoogleDriveStorageProvider.internalName}=>${\n    DownloadFileStorageProvider.internalName\n  }`]: moveNothing,\n};\n\nconst BrowserResourceMover: ResourceMover = {\n  moveAllProjectResources: async (\n    options: MoveAllProjectResourcesOptions\n  ): Promise<MoveAllProjectResourcesResult> => {\n    const { oldStorageProvider, newStorageProvider } = options;\n    const mover =\n      movers[\n        `${oldStorageProvider.internalName}=>${newStorageProvider.internalName}`\n      ];\n    if (!mover)\n      throw new Error(\n        `Can't find a ResourceMover for ${oldStorageProvider.internalName} to ${\n          newStorageProvider.internalName\n        }.`\n      );\n\n    return mover(options);\n  },\n};\n\nexport default BrowserResourceMover;\n","// @flow\nimport {\n  type ResourceFetcher,\n  type FetchAllProjectResourcesOptions,\n  type FetchAllProjectResourcesResult,\n  type FetchAllProjectResourcesFunction,\n} from './index';\nimport CloudStorageProvider from '../CloudStorageProvider';\nimport { moveUrlResourcesToCloudFilesIfPrivate } from '../CloudStorageProvider/CloudResourceFetcher';\nimport GoogleDriveStorageProvider from '../GoogleDriveStorageProvider';\nimport UrlStorageProvider from '../UrlStorageProvider';\nimport { fetchRelativeResourcesToFullUrls } from '../UrlStorageProvider/UrlResourceFetcher';\n\nconst fetchNothing: FetchAllProjectResourcesFunction = async () => {\n  return {\n    erroredResources: [],\n  };\n};\n\nconst fetchers: {\n  [string]: FetchAllProjectResourcesFunction,\n} = {\n  // The Cloud file storage provider fetches the resources that are\n  // private URLs by downloading them and reuploading them to the cloud.\n  [CloudStorageProvider.internalName]: moveUrlResourcesToCloudFilesIfPrivate,\n  // The cloud storage has nothing to fetch, all resources are supposed\n  // to be public URLs.\n  [GoogleDriveStorageProvider.internalName]: fetchNothing,\n  // The URL storage consider relative resources to be relative to the project\n  // URL. This allows to open local projects uploaded to GitHub for example.\n  [UrlStorageProvider.internalName]: fetchRelativeResourcesToFullUrls,\n};\n\nconst BrowserResourceFetcher: ResourceFetcher = {\n  fetchAllProjectResources: async (\n    options: FetchAllProjectResourcesOptions\n  ): Promise<FetchAllProjectResourcesResult> => {\n    const { storageProvider } = options;\n    const fetcher = fetchers[storageProvider.internalName];\n    if (!fetcher)\n      throw new Error(\n        `Can't find a ResourceFetcher for ${\n          storageProvider.internalName\n        } - have you registered the storage provider here?`\n      );\n\n    return fetcher(options);\n  },\n};\n\nexport default BrowserResourceFetcher;\n","// @flow\nimport * as React from 'react';\nimport MainFrame from './MainFrame';\nimport Window from './Utils/Window';\nimport ExportDialog from './Export/ExportDialog';\nimport Authentication from './Utils/GDevelopServices/Authentication';\nimport './UI/icomoon-font.css'; // Styles for Icomoon font.\n\n// Import for browser only IDE\nimport browserResourceSources from './ResourcesList/BrowserResourceSources';\nimport browserResourceExternalEditors from './ResourcesList/BrowserResourceExternalEditors';\nimport BrowserS3PreviewLauncher from './Export/BrowserExporters/BrowserS3PreviewLauncher';\nimport {\n  browserAutomatedExporters,\n  browserManualExporters,\n  browserOnlineWebExporter,\n} from './Export/BrowserExporters';\nimport makeExtensionsLoader from './JsExtensionsLoader/BrowserJsExtensionsLoader';\nimport ObjectsEditorService from './ObjectEditor/ObjectsEditorService';\nimport ObjectsRenderingService from './ObjectsRendering/ObjectsRenderingService';\nimport { makeBrowserS3EventsFunctionCodeWriter } from './EventsFunctionsExtensionsLoader/CodeWriters/BrowserS3EventsFunctionCodeWriter';\nimport Providers from './MainFrame/Providers';\nimport ProjectStorageProviders from './ProjectsStorage/ProjectStorageProviders';\nimport UrlStorageProvider from './ProjectsStorage/UrlStorageProvider';\nimport GoogleDriveStorageProvider from './ProjectsStorage/GoogleDriveStorageProvider';\nimport DownloadFileStorageProvider from './ProjectsStorage/DownloadFileStorageProvider';\nimport CloudStorageProvider from './ProjectsStorage/CloudStorageProvider';\nimport BrowserResourceMover from './ProjectsStorage/ResourceMover/BrowserResourceMover';\nimport BrowserResourceFetcher from './ProjectsStorage/ResourceFetcher/BrowserResourceFetcher';\n\nexport const create = (authentication: Authentication) => {\n  Window.setUpContextMenu();\n\n  let app = null;\n  const appArguments = Window.getArguments();\n\n  app = (\n    <Providers\n      authentication={authentication}\n      disableCheckForUpdates={!!appArguments['disable-update-check']}\n      makeEventsFunctionCodeWriter={makeBrowserS3EventsFunctionCodeWriter}\n      eventsFunctionsExtensionWriter={null}\n      eventsFunctionsExtensionOpener={null}\n    >\n      {({ i18n }) => (\n        <ProjectStorageProviders\n          appArguments={appArguments}\n          storageProviders={[\n            UrlStorageProvider,\n            CloudStorageProvider,\n            GoogleDriveStorageProvider,\n            DownloadFileStorageProvider,\n          ]}\n          defaultStorageProvider={UrlStorageProvider}\n        >\n          {({\n            getStorageProviderOperations,\n            getStorageProviderResourceOperations,\n            storageProviders,\n            initialFileMetadataToOpen,\n            getStorageProvider,\n          }) => (\n            <MainFrame\n              i18n={i18n}\n              renderPreviewLauncher={(props, ref) => (\n                <BrowserS3PreviewLauncher {...props} ref={ref} />\n              )}\n              renderExportDialog={props => (\n                <ExportDialog\n                  project={props.project}\n                  onSaveProject={props.onSaveProject}\n                  onChangeSubscription={props.onChangeSubscription}\n                  onClose={props.onClose}\n                  automatedExporters={browserAutomatedExporters}\n                  manualExporters={browserManualExporters}\n                  onlineWebExporter={browserOnlineWebExporter}\n                  allExportersRequireOnline\n                />\n              )}\n              storageProviders={storageProviders}\n              resourceMover={BrowserResourceMover}\n              resourceFetcher={BrowserResourceFetcher}\n              getStorageProviderOperations={getStorageProviderOperations}\n              getStorageProviderResourceOperations={\n                getStorageProviderResourceOperations\n              }\n              getStorageProvider={getStorageProvider}\n              resourceSources={browserResourceSources}\n              resourceExternalEditors={browserResourceExternalEditors}\n              extensionsLoader={makeExtensionsLoader({\n                objectsEditorService: ObjectsEditorService,\n                objectsRenderingService: ObjectsRenderingService,\n                filterExamples: !Window.isDev(),\n              })}\n              initialFileMetadataToOpen={initialFileMetadataToOpen}\n            />\n          )}\n        </ProjectStorageProviders>\n      )}\n    </Providers>\n  );\n\n  return app;\n};\n"],"names":["ResourceStoreChooser","options","onChooseResources","createNewResource","ResourceStore","onChoose","resource","chosenResourceUrl","url","newResource","setFile","resourceCleanedName","isPublicAssetResourceUrl","extractFilenameWithExtensionFromPublicAssetResourceUrl","path","setName","setOrigin","resourceKind","UrlChooser","React","inputValue","setInputValue","error","setError","urlsErroredBooleanArray","setUrlsErroredBooleanArray","hasErroredUrls","filter","Boolean","length","validateInputValue","useDebounce","urls","multiSelection","split","Promise","all","map","axios","timeout","validateStatus","status","responses","response","noMargin","expand","renderButton","style","RaisedButton","onClick","primary","label","Trans","disabled","renderTextField","SemiControlledTextField","floatingLabelText","value","onChange","multiline","rows","rowsMax","fullWidth","errorText","isErrored","index","join","AlertMessage","kind","allResourceKindsAndMetadata","name","displayName","displayTab","renderComponent","props","FileToCloudProjectResourceUploader","fileMetadata","getStorageProvider","automaticallyOpenInput","automaticallyOpenIfPossible","displayBlackLoadingScreen","externalWindow","document","write","nextExternalEditorWindowId","externalEditorIndexHtml","piskel","yarn","jfxr","openAndWaitForExternalEditorWindow","externalEditorWindow","editorName","externalEditorInput","resolve","reject","externalEditorLoaded","externalEditorClosed","externalEditorOutput","onMessageEvent","event","source","data","id","payload","console","info","addEventListener","onExternalEditorWindowClosed","postMessage","window","location","origin","close","warn","removeEventListener","setTimeout","downloadAndPrepareExternalEditorBase64Resources","project","resourceNames","urlsToDownload","resourcesManager","getResourcesManager","forEach","resourceName","hasResource","getResource","getFile","isURL","isBlobURL","push","downloadUrlsToBlobs","urlContainers","onProgress","count","total","downloadedBlobs","resourcesToDataUrl","Map","blob","item","convertBlobToDataURL","dataUrl","set","resourceData","get","localFilePath","editWithBrowserExternalEditor","externalEditorName","defaultName","metadataKey","resourceManagementProps","resources","singleFrame","extraOptions","externalEditorData","readMetadata","existingMetadata","fps","isLooping","sendExternalEditorOpened","saveBlobUrlsFromExternalEditorBase64Resources","baseNameForNewResources","modifiedResources","onFetchNewlyAddedResources","freeBlobsAndUpdateMetadata","metadata","patchExternalEditorMetadataWithResourcesNamesIfNecessary","getName","originalIndex","newName","newMetadata","cloudProjectWarning","immediatelyOpenLoadingWindowForExternalEditor","targetId","left","screenX","innerWidth","width","top","screenY","innerHeight","height","open","Error","editors","createDisplayName","editDisplayName","edit","internalName","i18n","showWarningBox","_","delayToNextTick","BrowserPreviewErrorDialog","this","onClose","I18n","Dialog","title","actions","FlatButton","onRequestClose","Text","code","message","Component","uploadObject","params","getSignedUrl","uploadType","key","Key","contentType","ContentType","then","signedUrl","Body","headers","getBaseUrl","GDevelopGamePreviews","baseUrl","gd","global","filename","startsWith","BrowserS3FileSystem","filesContent","prefix","bucketBaseUrl","_pendingUploadObjects","_allCopiedExternalUrls","Set","uploadPendingObjects","result","log","mkDir","dirExists","clearDir","getTempDir","fileNameFrom","fullpath","dirNameFrom","makeAbsolute","baseDirectory","isAbsolute","makeRelative","charAt","copyFile","dest","add","writeToFile","fullPath","contents","replace","fileExtension","readFile","file","_indexedFilesContent","text","readDir","ext","toUpperCase","output","VectorString","upperCaseUrl","indexOf","push_back","fileExists","textFileDescriptor","filePath","filesToDownload","preview","web","cordova","electron","findGDJS","fileSet","gdjsRoot","getIDEVersion","relativeFilePath","fetch","ok","debuggerServerState","callbacksList","nextDebuggerId","existingPreviewWindows","getExistingDebuggerIds","Object","keys","Number","getDebuggerIdForPreviewWindow","previewWindow","windowClosedPollingIntervalId","setupWindowClosedPolling","setInterval","closed","onConnectionClosed","debuggerIds","clearInterval","PREVIEWS_ORIGIN","browserPreviewDebuggerServer","startServer","parsedMessage","JSON","parse","onHandleParsedMessage","onServerStateChanged","sendMessage","getServerState","registerCallbacks","callbacks","callbacksIndex","splice","registerNewPreviewWindow","onConnectionOpened","nextPreviewWindowId","immediatelyOpenNewPreviewWindow","getGameResolutionWidth","getGameResolutionHeight","BrowserS3PreviewLauncher","canDoNetworkPreview","canDoHotReload","state","_prepareExporter","makeTimestampedId","outputDir","browserS3FileSystem","fileSystem","assignIn","AbstractFileSystemJS","exporter","Exporter","setCodeOutputDirectory","launchPreview","previewOptions","layout","externalLayout","setState","getPreviewDebuggerServer","lastDebuggerId","shouldHotReload","hotReload","existingPreviewWindow","previewExportOptions","PreviewExportOptions","setLayoutName","setIsDevelopmentEnvironment","Window","isDev","setExternalLayoutName","useWindowMessageDebuggerClient","setNonRuntimeScriptsCacheBurst","Date","now","setFullLoadingScreen","fullLoadingScreen","fallbackAuthor","setFallbackAuthor","username","gdevelopResourceToken","getGDevelopResourceJwtToken","setGDevelopResourceToken","exportProjectForPixiPreview","delete","uploadBlobFile","uploadOptions","maxContentLength","Infinity","onUploadProgress","progressEvent","loaded","pathPosix","BrowserFileSystem","textFiles","_textFiles","_filesToDownload","getAllTextFilesIn","pathPrefix","getAllUrlFilesIn","basename","dirname","filePathOrURL","baseDirectoryOrURL","normalize","substring","relative","content","upperCaseFilePath","normalizedFilePath","eachCallback","array","callback","done","callNextCallback","downloadUrlFilesToBlobFiles","urlFiles","erroredUrls","downloadedBlob","errorMessages","shortenString","archiveFiles","blobFiles","basePath","sizeLimit","initializeZipJs","zipJs","zippedFilesCount","totalFilesCount","createWriter","BlobWriter","zipWriter","BlobReader","TextReader","fileSize","size","roundFileSizeInMb","Math","round","browserOnlineCordovaExportPipeline","onlineBuildType","limitedBuilds","packageNameWarningType","getInitialExportState","targets","keystore","signingDialogOpen","canLaunchBuild","exportState","errored","exportStep","isNavigationDisabled","includes","renderHeader","renderLaunchButtonLabel","prepareExporter","context","abstractFileSystem","launchExport","exportOptions","ExportOptions","setTarget","exportWholePixiProject","launchResourcesDownload","updateStepProgress","launchCompression","launchUpload","blobFile","getBuildFileUploadOptions","launchOnlineBuild","authenticatedUser","uploadBucketKey","gameId","getAuthorizationHeader","firebaseUser","buildCordovaAndroid","uid","browserOnlineElectronExportPipeline","buildElectron","browserOnlineWebExportPipeline","renderCustomStepsProgress","build","onSaveProject","buildWeb","BlobDownloadUrlHolder","children","blobDownloadUrl","setBlobDownloadUrl","currentBlob","setCurrentBlob","URL","createObjectURL","revokeObjectURL","openBlobDownloadUrl","body","a","createElement","appendChild","display","href","download","click","removeChild","browserHTML5ExportPipeline","renderDoneFooter","compressionOutput","renderGameButton","browserCordovaExportPipeline","browserElectronExportPipeline","browserFacebookInstantGamesExportPipeline","browserOnlineWebExporter","onlineWebExporter","exportPipeline","browserAutomatedExporters","html5Exporter","onlineCordovaExporter","onlineElectronExporter","facebookInstantGamesExporter","browserManualExporters","cordovaExporter","electronExporter","jsExtensions","extensionModule","require","objectsRenderingServiceModules","makeExtensionsLoader","objectsEditorService","objectsRenderingService","filterExamples","loadAllExtensions","registerEditorConfigurations","requirePath","registerModule","registerInstanceRenderers","extensionModulePath","loadExtension","JsPlatform","makeBrowserS3EventsFunctionCodeWriter","onWriteFile","getPathFor","codeNamespace","slugs","getIncludeFileFor","writeFunctionCode","functionCodeNamespace","includeFile","writeBehaviorCode","behaviorCodeNamespace","writeObjectCode","objectCodeNamespace","SvgIcon","d","styles","container","position","alignItems","button","marginLeft","textField","flex","TextField","floatingLabelFixed","type","translatableHintText","onOpenPicker","selectedFileOrFolder","setSelectedFileOrFolder","newFileName","setNewFileName","saving","setSaving","saveError","setSaveError","pickerError","setPickerError","dialogHidden","hideDialog","canSave","save","onSave","catch","canCancel","onCancel","LeftLoader","isLoading","cannotBeDismissed","onApply","maxWidth","onShowFilePicker","selectFolderEnabled","showUploadView","DEVELOPER_KEY","DISCOVERY_DOCS","SCOPE","apisLoaded","apisLoadingPromise","initializeApis","loadScript","gapi","load","auth2LoadPromise","auth2","init","apiKey","clientId","discoveryDocs","scope","client","setApiKey","driveLoadPromise","onerror","isAuthenticated","authenticate","googleAuth","getAuthInstance","isSignedIn","currentUser","listen","authenticated","signIn","googleUser","getAuthResponse","patchJsonFile","fileId","method","Headers","Authorization","access_token","res","showFilePicker","google","picker","pickerBuilder","PickerBuilder","addView","DocsView","setIncludeFolders","setSelectFolderEnabled","setOAuthToken","setDeveloperKey","setAppId","setCallback","Response","ACTION","Action","PICKED","doc","DOCUMENTS","Document","ID","NAME","parentId","PARENT_ID","TYPE","Type","LOCATION","MIME_TYPE","dispose","CANCEL","DocsUploadView","setVisible","pickerElements","getElementsByClassName","i","zIndex","renderIcon","GoogleDrive","fontSize","getFileMetadataFromAppArguments","appArguments","googleDriveState","ids","fileIdentifier","e","createOperations","setDialog","closeDialog","doesInitialOpenRequireUserInteraction","onOpen","fileContent","ex","onOpenWithPicker","googleDriveFileOrFolder","newFileMetadata","lastModifiedDate","serializeToJSON","wasSaved","onChooseSaveProjectAsLocation","saveAsLocation","drive","files","create","parents","mimeType","fields","apiResponse","newFileId","onSaveProjectAs","onStartSaving","onMoveResources","getOpenErrorMessage","PROJECT_JSON_FILENAME","downloadResourcesAsBlobs","onAddBlobFile","erroredResources","getResourcesToFetch","getAllResourceNames","toJSArray","resourceFile","checkIfIsGDevelopCloudBucketUrl","extractFilenameFromProjectResourceUrl","resourcesToFetchAndUpload","downloadedBlobsAndResources","alreadyUsedFilenames","extension","extname","getKind","newBasename","newNameGenerator","tentativeBasename","has","newResourcePath","DownloadFileSaveAsDialog","onDone","zippedProjectBlob","setZippedProjectBlob","useGenericRetryableProcessWithProgress","onDoProcess","ensureProcessIsDone","renderProcessDialog","newProject","ProjectHelper","createNewGDJSProject","serializedProject","SerializerElement","serializeTo","unserializeFrom","blobFileDescriptor","stringify","serializeToJSObject","showErrorBox","rawError","errorId","openExternalURL","justifyContent","PlaceholderLoader","Download","hiddenInOpenDialog","ensureNoCloudProjectResources","moveNothing","movers","CloudStorageProvider","moveAllCloudProjectResourcesToCloudProject","UrlStorageProvider","GoogleDriveStorageProvider","DownloadFileStorageProvider","BrowserResourceMover","moveAllProjectResources","oldStorageProvider","newStorageProvider","mover","fetchNothing","fetchers","moveUrlResourcesToCloudFilesIfPrivate","fetchRelativeResourcesToFullUrls","BrowserResourceFetcher","fetchAllProjectResources","storageProvider","fetcher","authentication","setUpContextMenu","getArguments","Providers","disableCheckForUpdates","makeEventsFunctionCodeWriter","eventsFunctionsExtensionWriter","eventsFunctionsExtensionOpener","ProjectStorageProviders","storageProviders","defaultStorageProvider","getStorageProviderOperations","getStorageProviderResourceOperations","initialFileMetadataToOpen","MainFrame","renderPreviewLauncher","ref","renderExportDialog","ExportDialog","onChangeSubscription","automatedExporters","manualExporters","allExportersRequireOnline","resourceMover","resourceFetcher","resourceSources","browserResourceSources","resourceExternalEditors","browserResourceExternalEditors","extensionsLoader","ObjectsEditorService","ObjectsRenderingService"],"sourceRoot":""}